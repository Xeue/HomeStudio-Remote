!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("SLDP",[],t):"object"==typeof exports?exports.SLDP=t():e.SLDP=t()}(this,(function(){return function(e){function t(t){for(var i,n,o=t[0],a=t[1],s=0,c=[];s<o.length;s++)n=o[s],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&c.push(r[n][0]),r[n]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i]);for(u&&u(t);c.length;)c.shift()()}var i={},r={2:0};function n(t){if(i[t])return i[t].exports;var r=i[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.e=function(e){var t=[],i=r[e];if(0!==i)if(i)t.push(i[2]);else{var o=new Promise((function(t,n){i=r[e]=[t,n]}));t.push(i[2]=o);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.src=function(e){return n.p+"sldp-"+({0:"cea608-captions",1:"opus-decoder"}[e]||e)+".package.min.js"}(e);var u=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(c);var i=r[e];if(0!==i){if(i){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",u.name="ChunkLoadError",u.type=n,u.request=o,i[1](u)}r[e]=void 0}};var c=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},n.m=e,n.c=i,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n.oe=function(e){throw console.error(e),e};var o=this.webpackJsonpSLDP=this.webpackJsonpSLDP||[],a=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var u=a;return n(n.s=249)}([function(e,t,i){var r=i(1),n=i(20),o=i(29).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==o,sham:!n},{defineProperty:o})},function(e,t,i){var r=i(6),n=i(80).f,o=i(44),a=i(27),s=i(146),u=i(182),c=i(149);e.exports=function(e,t){var i,l,f,h,d,p=e.target,v=e.global,m=e.stat;if(i=v?r:m?r[p]||s(p,{}):(r[p]||{}).prototype)for(l in t){if(h=t[l],f=e.dontCallGetSet?(d=n(i,l))&&d.value:i[l],!c(v?l:p+(m?".":"#")+l,e.forced)&&void 0!==f){if(typeof h==typeof f)continue;u(h,f)}(e.sham||f&&f.sham)&&o(h,"sham",!0),a(i,l,h,e)}}},function(e,t,i){"use strict";var r=i(37),n=i(206),o=i(105),a=i(34),s=i(29).f,u=i(199),c=i(203),l=i(32),f=i(20),h=a.set,d=a.getterFor("Array Iterator");e.exports=u(Array,"Array",(function(e,t){h(this,{type:"Array Iterator",target:r(e),index:0,kind:t})}),(function(){var e=d(this),t=e.target,i=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,c(void 0,!0)):c("keys"==i?r:"values"==i?t[r]:[r,t[r]],!1)}),"values");var p=o.Arguments=o.Array;if(n("keys"),n("values"),n("entries"),!l&&f&&"values"!==p.name)try{s(p,"name",{value:"values"})}catch(e){}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,i){var r=i(153),n=i(27),o=i(278);r||n(Object.prototype,"toString",o,{unsafe:!0})},function(e,t,i){var r=i(95),n=Function.prototype,o=n.call,a=r&&n.bind.bind(o,o);e.exports=r?a:function(e){return function(){return o.apply(e,arguments)}}},function(e,t,i){(function(t){var i=function(e){return e&&e.Math==Math&&e};e.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof t&&t)||function(){return this}()||this||Function("return this")()}).call(this,i(246))},function(e,t,i){"use strict";var r=i(157).charAt,n=i(24),o=i(34),a=i(199),s=i(203),u=o.set,c=o.getterFor("String Iterator");a(String,"String",(function(e){u(this,{type:"String Iterator",string:n(e),index:0})}),(function(){var e,t=c(this),i=t.string,n=t.index;return n>=i.length?s(void 0,!0):(e=r(i,n),t.index+=e.length,s(e,!1))}))},function(e,t,i){var r=i(6),n=i(204),o=i(205),a=i(2),s=i(44),u=i(15),c=u("iterator"),l=u("toStringTag"),f=a.values,h=function(e,t){if(e){if(e[c]!==f)try{s(e,c,f)}catch(t){e[c]=f}if(e[l]||s(e,l,t),n[t])for(var i in a)if(e[i]!==a[i])try{s(e,i,a[i])}catch(t){e[i]=a[i]}}};for(var d in n)h(r[d]&&r[d].prototype,d);h(o,"DOMTokenList")},function(e,t,i){i(269),i(272),i(273),i(274),i(276)},function(e,t,i){"use strict";var r=i(1),n=i(20),o=i(6),a=i(5),s=i(21),u=i(16),c=i(43),l=i(24),f=i(39),h=i(182),d=o.Symbol,p=d&&d.prototype;if(n&&u(d)&&(!("description"in p)||void 0!==d().description)){var v={},m=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:l(arguments[0]),t=c(p,this)?new d(e):void 0===e?d():d(e);return""===e&&(v[t]=!0),t};h(m,d),m.prototype=p,p.constructor=m;var y="Symbol(test)"==String(d("test")),g=a(p.valueOf),b=a(p.toString),_=/^Symbol\((.*)\)[^)]+$/,w=a("".replace),A=a("".slice);f(p,"description",{configurable:!0,get:function(){var e=g(this);if(s(v,e))return"";var t=b(e),i=y?A(t,7,-1):w(t,_,"$1");return""===i?void 0:i}}),r({global:!0,constructor:!0,forced:!0},{Symbol:m})}},function(e,t,i){i(108)("iterator")},function(e,t,i){var r=i(108),n=i(197);r("toPrimitive"),n()},function(e,t,i){var r=i(21),n=i(27),o=i(302),a=i(15)("toPrimitive"),s=Date.prototype;r(s,a)||n(s,a,o)},function(e,t,i){"use strict";var r=i(1),n=i(32),o=i(20),a=i(6),s=i(196),u=i(5),c=i(149),l=i(21),f=i(213),h=i(43),d=i(86),p=i(144),v=i(3),m=i(91).f,y=i(80).f,g=i(29).f,b=i(223),_=i(135).trim,w=a.Number,A=s.Number,S=w.prototype,k=a.TypeError,C=u("".slice),T=u("".charCodeAt),P=function(e){var t,i,r,n,o,a,s,u,c=p(e,"number");if(d(c))throw k("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=_(c),43===(t=T(c,0))||45===t){if(88===(i=T(c,2))||120===i)return NaN}else if(48===t){switch(T(c,1)){case 66:case 98:r=2,n=49;break;case 79:case 111:r=8,n=55;break;default:return+c}for(a=(o=C(c,2)).length,s=0;s<a;s++)if((u=T(o,s))<48||u>n)return NaN;return parseInt(o,r)}return+c},x=c("Number",!w(" 0o1")||!w("0b1")||w("+0x1")),E=function(e){var t,i=arguments.length<1?0:w(function(e){var t=p(e,"number");return"bigint"==typeof t?t:P(t)}(e));return h(S,t=this)&&v((function(){b(t)}))?f(Object(i),this,E):i};E.prototype=S,x&&!n&&(S.constructor=E),r({global:!0,constructor:!0,wrap:!0,forced:x},{Number:E});var B=function(e,t){for(var i,r=o?m(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0;r.length>n;n++)l(t,i=r[n])&&!l(e,i)&&g(e,i,y(t,i))};n&&A&&B(s.Number,A),(x||n)&&B(s.Number,w)},function(e,t,i){var r=i(6),n=i(89),o=i(21),a=i(119),s=i(87),u=i(177),c=r.Symbol,l=n("wks"),f=u?c.for||c:c&&c.withoutSetter||a;e.exports=function(e){return o(l,e)||(l[e]=s&&o(c,e)?c[e]:f("Symbol."+e)),l[e]}},function(e,t,i){var r=i(176),n=r.all;e.exports=r.IS_HTMLDDA?function(e){return"function"==typeof e||e===n}:function(e){return"function"==typeof e}},function(e,t,i){"use strict";var r,n,o,a=i(166),s=i(20),u=i(6),c=i(16),l=i(23),f=i(21),h=i(46),d=i(82),p=i(44),v=i(27),m=i(39),y=i(43),g=i(109),b=i(83),_=i(15),w=i(119),A=i(34),S=A.enforce,k=A.get,C=u.Int8Array,T=C&&C.prototype,P=u.Uint8ClampedArray,x=P&&P.prototype,E=C&&g(C),B=T&&g(T),M=Object.prototype,R=u.TypeError,I=_("toStringTag"),F=w("TYPED_ARRAY_TAG"),L=a&&!!b&&"Opera"!==h(u.opera),O=!1,j={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},D={BigInt64Array:8,BigUint64Array:8},V=function(e){var t=g(e);if(l(t)){var i=k(t);return i&&f(i,"TypedArrayConstructor")?i.TypedArrayConstructor:V(t)}},U=function(e){if(!l(e))return!1;var t=h(e);return f(j,t)||f(D,t)};for(r in j)(o=(n=u[r])&&n.prototype)?S(o).TypedArrayConstructor=n:L=!1;for(r in D)(o=(n=u[r])&&n.prototype)&&(S(o).TypedArrayConstructor=n);if((!L||!c(E)||E===Function.prototype)&&(E=function(){throw R("Incorrect invocation")},L))for(r in j)u[r]&&b(u[r],E);if((!L||!B||B===M)&&(B=E.prototype,L))for(r in j)u[r]&&b(u[r].prototype,B);if(L&&g(x)!==B&&b(x,B),s&&!f(B,I))for(r in O=!0,m(B,I,{configurable:!0,get:function(){return l(this)?this[F]:void 0}}),j)u[r]&&p(u[r],F,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:L,TYPED_ARRAY_TAG:O&&F,aTypedArray:function(e){if(U(e))return e;throw R("Target is not a typed array")},aTypedArrayConstructor:function(e){if(c(e)&&(!b||y(E,e)))return e;throw R(d(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,i,r){if(s){if(i)for(var n in j){var o=u[n];if(o&&f(o.prototype,e))try{delete o.prototype[e]}catch(i){try{o.prototype[e]=t}catch(e){}}}B[e]&&!i||v(B,e,i?t:L&&T[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,i){var r,n;if(s){if(b){if(i)for(r in j)if((n=u[r])&&f(n,e))try{delete n[e]}catch(e){}if(E[e]&&!i)return;try{return v(E,e,i?t:L&&E[e]||t)}catch(e){}}for(r in j)!(n=u[r])||n[e]&&!i||v(n,e,t)}},getTypedArrayConstructor:V,isView:function(e){if(!l(e))return!1;var t=h(e);return"DataView"===t||f(j,t)||f(D,t)},isTypedArray:U,TypedArray:E,TypedArrayPrototype:B}},function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,"symbol"===r(o=function(e,t){if("object"!==r(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t);if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key,"string"))?o:String(o),n)}var o}i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(228),i(94),i(12),i(13),i(9),i(10),i(4),i(14);var o,a,s,u=(o="warn",a=[],s=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.div=!1,this.id=t,this.prefix=i,this.lf="log"}var t,i;return t=e,(i=[{key:"setDiv",value:function(e){"string"==typeof e&&(this.div=document.getElementById(e))}},{key:"setId",value:function(e){null==this.id?this.id=e:console.error("Attempt to reset Logger id",this.id,e)}},{key:"setPrefix",value:function(e){this.prefix=e}},{key:"error",value:function(){this.lf="error",this._log.apply(this,arguments)}},{key:"warn",value:function(){"warn"!=o&&"debug"!=o||(this.lf="warn",this._log.apply(this,arguments))}},{key:"debug",value:function(){"debug"==o&&(this.lf="log",this._log.apply(this,arguments))}},{key:"_log",value:function(){var e=Date.now(),t=e%1e3;t<10?t="00"+t:t<100&&(t="0"+t);var i=(e=e/1e3>>>0)%86400,r=i/3600>>>0;r<10&&(r="0"+r);var n=(i-=3600*r)/60>>>0;n<10&&(n="0"+n),(i-=60*n)<10&&(i="0"+i),arguments[0]="["+r+":"+n+":"+i+"."+t+"]["+this.id+"]["+this.prefix+"]: "+arguments[0],console[this.lf].apply(console,arguments);var o=this.div?this.div:a[this.id];if(o){for(var s="",u=0;u<arguments.length;u++)s.length>0&&(s+=" "),s+=arguments[u];var c=document.createElement("div");o.appendChild(c),c.appendChild(document.createTextNode(s)),3e4<o.children.length&&o.removeChild(o.children[0]),o.scrollTop=o.scrollHeight}}}])&&n(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),{create:function(e,t){return new s(e,t)},setLevel:function(e){o=e},setDiv:function(e,t){"string"==typeof t&&(a[e]=document.getElementById(t))}});t.default=u},function(e,t,i){var r=i(95),n=Function.prototype.call;e.exports=r?n.bind(n):function(){return n.apply(n,arguments)}},function(e,t,i){var r=i(3);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,i){var r=i(5),n=i(25),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(n(e),t)}},function(e,t,i){var r=i(23),n=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw o(n(e)+" is not an object")}},function(e,t,i){var r=i(16),n=i(176),o=n.all;e.exports=n.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===o}:function(e){return"object"==typeof e?null!==e:r(e)}},function(e,t,i){var r=i(46),n=String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return n(e)}},function(e,t,i){var r=i(73),n=Object;e.exports=function(e){return n(r(e))}},function(e,t,i){"use strict";var r=i(1),n=i(3),o=i(93),a=i(23),s=i(25),u=i(28),c=i(218),l=i(107),f=i(156),h=i(131),d=i(15),p=i(88),v=d("isConcatSpreadable"),m=function(e){if(!a(e))return!1;var t=e[v];return void 0!==t?!!t:o(e)};r({target:"Array",proto:!0,arity:1,forced:!(p>=51||!n((function(){var e=[];return e[v]=!1,e.concat()[0]!==e})))||!h("concat")},{concat:function(e){var t,i,r,n,o,a=s(this),h=f(a,0),d=0;for(t=-1,r=arguments.length;t<r;t++)if(m(o=-1===t?a:arguments[t]))for(n=u(o),c(d+n),i=0;i<n;i++,d++)i in o&&l(h,d,o[i]);else c(d+1),l(h,d++,o);return h.length=d,h}})},function(e,t,i){var r=i(16),n=i(29),o=i(181),a=i(146);e.exports=function(e,t,i,s){s||(s={});var u=s.enumerable,c=void 0!==s.name?s.name:t;if(r(i)&&o(i,c,s),s.global)u?e[t]=i:a(t,i);else{try{s.unsafe?e[t]&&(u=!0):delete e[t]}catch(e){}u?e[t]=i:n.f(e,t,{value:i,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e}},function(e,t,i){var r=i(45);e.exports=function(e){return r(e.length)}},function(e,t,i){var r=i(20),n=i(179),o=i(180),a=i(22),s=i(97),u=TypeError,c=Object.defineProperty,l=Object.getOwnPropertyDescriptor;t.f=r?o?function(e,t,i){if(a(e),t=s(t),a(i),"function"==typeof e&&"prototype"===t&&"value"in i&&"writable"in i&&!i.writable){var r=l(e,t);r&&r.writable&&(e[t]=i.value,i={configurable:"configurable"in i?i.configurable:r.configurable,enumerable:"enumerable"in i?i.enumerable:r.enumerable,writable:!1})}return c(e,t,i)}:c:function(e,t,i){if(a(e),t=s(t),a(i),n)try{return c(e,t,i)}catch(e){}if("get"in i||"set"in i)throw u("Accessors not supported");return"value"in i&&(e[t]=i.value),e}},function(e,t,i){var r=i(6),n=i(16);e.exports=function(e,t){return arguments.length<2?(i=r[e],n(i)?i:void 0):r[e]&&r[e][t];var i}},function(e,t,i){var r=i(16),n=i(82),o=TypeError;e.exports=function(e){if(r(e))return e;throw o(n(e)+" is not a function")}},function(e,t){e.exports=!1},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.instanceHolder=function(e){var t;return{getInstance:function(){return t||((t=new e).constructor=null),t}}},t.multiInstanceHolder=function(e){var t={};return{getInstance:function(i){return t[i]||(t[i]=new e(i),t[i].constructor=null),t[i]}}}},function(e,t,i){var r,n,o,a=i(250),s=i(6),u=i(23),c=i(44),l=i(21),f=i(145),h=i(121),d=i(122),p=s.TypeError,v=s.WeakMap;if(a||f.state){var m=f.state||(f.state=new v);m.get=m.get,m.has=m.has,m.set=m.set,r=function(e,t){if(m.has(e))throw p("Object already initialized");return t.facade=e,m.set(e,t),t},n=function(e){return m.get(e)||{}},o=function(e){return m.has(e)}}else{var y=h("state");d[y]=!0,r=function(e,t){if(l(e,y))throw p("Object already initialized");return t.facade=e,c(e,y,t),t},n=function(e){return l(e,y)?e[y]:{}},o=function(e){return l(e,y)}}e.exports={set:r,get:n,has:o,enforce:function(e){return o(e)?n(e):r(e,{})},getterFor:function(e){return function(t){var i;if(!u(t)||(i=n(t)).type!==e)throw p("Incompatible receiver, "+e+" required");return i}}}},function(e,t,i){var r=i(252);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},function(e,t,i){var r=i(77),n=i(5),o=i(96),a=i(25),s=i(28),u=i(156),c=n([].push),l=function(e){var t=1==e,i=2==e,n=3==e,l=4==e,f=6==e,h=7==e,d=5==e||f;return function(p,v,m,y){for(var g,b,_=a(p),w=o(_),A=r(v,m),S=s(w),k=0,C=y||u,T=t?C(p,S):i||h?C(p,0):void 0;S>k;k++)if((d||k in w)&&(b=A(g=w[k],k,_),e))if(t)T[k]=b;else if(b)switch(e){case 3:return!0;case 5:return g;case 6:return k;case 2:c(T,g)}else switch(e){case 4:return!1;case 7:c(T,g)}return f?-1:n||l?l:T}};e.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterReject:l(7)}},function(e,t,i){var r=i(96),n=i(73);e.exports=function(e){return r(n(e))}},function(e,t,i){var r=i(29).f,n=i(21),o=i(15)("toStringTag");e.exports=function(e,t,i){e&&!i&&(e=e.prototype),e&&!n(e,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,i){var r=i(181),n=i(29);e.exports=function(e,t,i){return i.get&&r(i.get,t,{getter:!0}),i.set&&r(i.set,t,{setter:!0}),n.f(e,t,i)}},function(e,t,i){i(296),i(298)},function(e,t,i){var r=i(20),n=i(90).EXISTS,o=i(5),a=i(39),s=Function.prototype,u=o(s.toString),c=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,l=o(c.exec);r&&!n&&a(s,"name",{configurable:!0,get:function(){try{return l(c,u(this))[1]}catch(e){return""}}})},function(e,t,i){var r=i(5),n=r({}.toString),o=r("".slice);e.exports=function(e){return o(n(e),8,-1)}},function(e,t,i){var r=i(5);e.exports=r({}.isPrototypeOf)},function(e,t,i){var r=i(20),n=i(29),o=i(81);e.exports=r?function(e,t,i){return n.f(e,t,o(1,i))}:function(e,t,i){return e[t]=i,e}},function(e,t,i){var r=i(35),n=Math.min;e.exports=function(e){return e>0?n(r(e),9007199254740991):0}},function(e,t,i){var r=i(153),n=i(16),o=i(42),a=i(15)("toStringTag"),s=Object,u="Arguments"==o(function(){return arguments}());e.exports=r?o:function(e){var t,i,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=s(e),a))?i:u?o(t):"Object"==(r=o(t))&&n(t.callee)?"Arguments":r}},function(e,t,i){var r,n=i(22),o=i(194),a=i(148),s=i(122),u=i(186),c=i(120),l=i(121)("IE_PROTO"),f=function(){},h=function(e){return"<script>"+e+"<\/script>"},d=function(e){e.write(h("")),e.close();var t=e.parentWindow.Object;return e=null,t},p=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t;p="undefined"!=typeof document?document.domain&&r?d(r):((t=c("iframe")).style.display="none",u.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(h("document.F=Object")),e.close(),e.F):d(r);for(var i=a.length;i--;)delete p.prototype[a[i]];return p()};s[l]=!0,e.exports=Object.create||function(e,t){var i;return null!==e?(f.prototype=n(e),i=new f,f.prototype=null,i[l]=e):i=p(),void 0===t?i:o.f(i,t)}},function(e,t,i){"use strict";var r=i(1),n=i(92),o=i(3),a=i(132),s=i(22),u=i(75),c=i(45),l=i(151),f=a.ArrayBuffer,h=a.DataView,d=h.prototype,p=n(f.prototype.slice),v=n(d.getUint8),m=n(d.setUint8);r({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:o((function(){return!new f(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(p&&void 0===t)return p(s(this),e);for(var i=s(this).byteLength,r=u(e,i),n=u(void 0===t?i:t,i),o=new(l(this,f))(c(n-r)),a=new h(this),d=new h(o),y=0;r<n;)m(d,y++,v(a,r++));return o}})},function(e,t,i){i(279)("Uint8",(function(e){return function(t,i,r){return e(this,t,i,r)}}))},function(e,t,i){"use strict";var r=i(5),n=i(17),o=r(i(285)),a=n.aTypedArray;(0,n.exportTypedArrayMethod)("copyWithin",(function(e,t){return o(a(this),e,t,arguments.length>2?arguments[2]:void 0)}))},function(e,t,i){"use strict";var r=i(17),n=i(36).every,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("every",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,i){"use strict";var r=i(17),n=i(210),o=i(212),a=i(46),s=i(19),u=i(5),c=i(3),l=r.aTypedArray,f=r.exportTypedArrayMethod,h=u("".slice);f("fill",(function(e){var t=arguments.length;l(this);var i="Big"===h(a(this),0,3)?o(e):+e;return s(n,this,i,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}),c((function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),1!==e})))},function(e,t,i){"use strict";var r=i(17),n=i(36).filter,o=i(286),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("filter",(function(e){var t=n(a(this),e,arguments.length>1?arguments[1]:void 0);return o(this,t)}))},function(e,t,i){"use strict";var r=i(17),n=i(36).find,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("find",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,i){"use strict";var r=i(17),n=i(36).findIndex,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("findIndex",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,i){"use strict";var r=i(17),n=i(36).forEach,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("forEach",(function(e){n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,i){"use strict";var r=i(17),n=i(99).includes,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("includes",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,i){"use strict";var r=i(17),n=i(99).indexOf,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("indexOf",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,i){"use strict";var r=i(6),n=i(3),o=i(5),a=i(17),s=i(2),u=i(15)("iterator"),c=r.Uint8Array,l=o(s.values),f=o(s.keys),h=o(s.entries),d=a.aTypedArray,p=a.exportTypedArrayMethod,v=c&&c.prototype,m=!n((function(){v[u].call([1])})),y=!!v&&v.values&&v[u]===v.values&&"values"===v.values.name,g=function(){return l(d(this))};p("entries",(function(){return h(d(this))}),m),p("keys",(function(){return f(d(this))}),m),p("values",g,m||!y,{name:"values"}),p(u,g,m||!y,{name:"values"})},function(e,t,i){"use strict";var r=i(17),n=i(5),o=r.aTypedArray,a=r.exportTypedArrayMethod,s=n([].join);a("join",(function(e){return s(o(this),e)}))},function(e,t,i){"use strict";var r=i(17),n=i(76),o=i(184),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return n(o,a(this),t>1?[e,arguments[1]]:[e])}))},function(e,t,i){"use strict";var r=i(17),n=i(36).map,o=i(133),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("map",(function(e){return n(a(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(o(e))(t)}))}))},function(e,t,i){"use strict";var r=i(17),n=i(214).left,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return n(o(this),e,t,t>1?arguments[1]:void 0)}))},function(e,t,i){"use strict";var r=i(17),n=i(214).right,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return n(o(this),e,t,t>1?arguments[1]:void 0)}))},function(e,t,i){"use strict";var r=i(17),n=r.aTypedArray,o=r.exportTypedArrayMethod,a=Math.floor;o("reverse",(function(){for(var e,t=n(this).length,i=a(t/2),r=0;r<i;)e=this[r],this[r++]=this[--t],this[t]=e;return this}))},function(e,t,i){"use strict";var r=i(6),n=i(19),o=i(17),a=i(28),s=i(211),u=i(25),c=i(3),l=r.RangeError,f=r.Int8Array,h=f&&f.prototype,d=h&&h.set,p=o.aTypedArray,v=o.exportTypedArrayMethod,m=!c((function(){var e=new Uint8ClampedArray(2);return n(d,e,{length:1,0:3},1),3!==e[1]})),y=m&&o.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var e=new f(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));v("set",(function(e){p(this);var t=s(arguments.length>1?arguments[1]:void 0,1),i=u(e);if(m)return n(d,this,i,t);var r=this.length,o=a(i),c=0;if(o+t>r)throw l("Wrong length");for(;c<o;)this[t+c]=i[c++]}),!m||y)},function(e,t,i){"use strict";var r=i(17),n=i(133),o=i(3),a=i(84),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("slice",(function(e,t){for(var i=a(s(this),e,t),r=n(this),o=0,u=i.length,c=new r(u);u>o;)c[o]=i[o++];return c}),o((function(){new Int8Array(1).slice()})))},function(e,t,i){"use strict";var r=i(17),n=i(36).some,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("some",(function(e){return n(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,i){"use strict";var r=i(6),n=i(92),o=i(3),a=i(31),s=i(168),u=i(17),c=i(215),l=i(216),f=i(88),h=i(217),d=u.aTypedArray,p=u.exportTypedArrayMethod,v=r.Uint16Array,m=v&&n(v.prototype.sort),y=!(!m||o((function(){m(new v(2),null)}))&&o((function(){m(new v(2),{})}))),g=!!m&&!o((function(){if(f)return f<74;if(c)return c<67;if(l)return!0;if(h)return h<602;var e,t,i=new v(516),r=Array(516);for(e=0;e<516;e++)t=e%4,i[e]=515-e,r[e]=e-2*t+3;for(m(i,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(i[e]!==r[e])return!0}));p("sort",(function(e){return void 0!==e&&a(e),g?m(this,e):s(d(this),function(e){return function(t,i){return void 0!==e?+e(t,i)||0:i!=i?-1:t!=t?1:0===t&&0===i?1/t>0&&1/i<0?1:-1:t>i}}(e))}),!g||y)},function(e,t,i){"use strict";var r=i(17),n=i(45),o=i(75),a=i(133),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("subarray",(function(e,t){var i=s(this),r=i.length,u=o(e,r);return new(a(i))(i.buffer,i.byteOffset+u*i.BYTES_PER_ELEMENT,n((void 0===t?r:o(t,r))-u))}))},function(e,t,i){"use strict";var r=i(6),n=i(76),o=i(17),a=i(3),s=i(84),u=r.Int8Array,c=o.aTypedArray,l=o.exportTypedArrayMethod,f=[].toLocaleString,h=!!u&&a((function(){f.call(new u(1))}));l("toLocaleString",(function(){return n(f,h?s(c(this)):c(this),s(arguments))}),a((function(){return[1,2].toLocaleString()!=new u([1,2]).toLocaleString()}))||!a((function(){u.prototype.toLocaleString.call([1,2])})))},function(e,t,i){"use strict";var r=i(17).exportTypedArrayMethod,n=i(3),o=i(6),a=i(5),s=o.Uint8Array,u=s&&s.prototype||{},c=[].toString,l=a([].join);n((function(){c.call({})}))&&(c=function(){return l(this)});var f=u.toString!=c;r("toString",c,f)},function(e,t,i){var r=i(85),n=TypeError;e.exports=function(e){if(r(e))throw n("Can't call method on "+e);return e}},function(e,t){e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},function(e,t,i){var r=i(35),n=Math.max,o=Math.min;e.exports=function(e,t){var i=r(e);return i<0?n(i+t,0):o(i,t)}},function(e,t,i){var r=i(95),n=Function.prototype,o=n.apply,a=n.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(o):function(){return a.apply(o,arguments)})},function(e,t,i){var r=i(92),n=i(31),o=i(95),a=r(r.bind);e.exports=function(e,t){return n(e),void 0===t?e:o?a(e,t):function(){return e.apply(t,arguments)}}},function(e,t,i){var r=i(1),n=i(224);r({target:"Function",proto:!0,forced:Function.bind!==n},{bind:n})},function(e,t,i){"use strict";var r=i(1),n=i(5),o=i(96),a=i(37),s=i(100),u=n([].join);r({target:"Array",proto:!0,forced:o!=Object||!s("join",",")},{join:function(e){return u(a(this),void 0===e?",":e)}})},function(e,t,i){var r=i(20),n=i(19),o=i(143),a=i(81),s=i(37),u=i(97),c=i(21),l=i(179),f=Object.getOwnPropertyDescriptor;t.f=r?f:function(e,t){if(e=s(e),t=u(t),l)try{return f(e,t)}catch(e){}if(c(e,t))return a(!n(o.f,e,t),e[t])}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var i=String;e.exports=function(e){try{return i(e)}catch(e){return"Object"}}},function(e,t,i){var r=i(256),n=i(22),o=i(257);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,i={};try{(e=r(Object.prototype,"__proto__","set"))(i,[]),t=i instanceof Array}catch(e){}return function(i,r){return n(i),o(r),t?e(i,r):i.__proto__=r,i}}():void 0)},function(e,t,i){var r=i(5);e.exports=r([].slice)},function(e,t){e.exports=function(e){return null==e}},function(e,t,i){var r=i(30),n=i(16),o=i(43),a=i(177),s=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return n(t)&&o(t.prototype,s(e))}},function(e,t,i){var r=i(88),n=i(3),o=i(6).String;e.exports=!!Object.getOwnPropertySymbols&&!n((function(){var e=Symbol();return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},function(e,t,i){var r,n,o=i(6),a=i(74),s=o.process,u=o.Deno,c=s&&s.versions||u&&u.version,l=c&&c.v8;l&&(n=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!n&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(n=+r[1]),e.exports=n},function(e,t,i){var r=i(32),n=i(145);(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.31.0",mode:r?"pure":"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.0/LICENSE",source:"https://github.com/zloirock/core-js"})},function(e,t,i){var r=i(20),n=i(21),o=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=n(o,"name"),u=s&&"something"===function(){}.name,c=s&&(!r||r&&a(o,"name").configurable);e.exports={EXISTS:s,PROPER:u,CONFIGURABLE:c}},function(e,t,i){var r=i(183),n=i(148).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,n)}},function(e,t,i){var r=i(42),n=i(5);e.exports=function(e){if("Function"===r(e))return n(e)}},function(e,t,i){var r=i(42);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,i){var r=i(5),n=i(27),o=Date.prototype,a=r(o.toString),s=r(o.getTime);"Invalid Date"!=String(new Date(NaN))&&n(o,"toString",(function(){var e=s(this);return e==e?a(this):"Invalid Date"}))},function(e,t,i){var r=i(3);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},function(e,t,i){var r=i(5),n=i(3),o=i(42),a=Object,s=r("".split);e.exports=n((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?s(e,""):a(e)}:a},function(e,t,i){var r=i(144),n=i(86);e.exports=function(e){var t=r(e,"string");return n(t)?t:t+""}},function(e,t,i){var r=i(31),n=i(85);e.exports=function(e,t){var i=e[t];return n(i)?void 0:r(i)}},function(e,t,i){var r=i(37),n=i(75),o=i(28),a=function(e){return function(t,i,a){var s,u=r(t),c=o(u),l=n(a,c);if(e&&i!=i){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===i)return e||l||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t,i){"use strict";var r=i(3);e.exports=function(e,t){var i=[][e];return!!i&&r((function(){i.call(null,t||function(){return 1},1)}))}},function(e,t,i){var r=i(43),n=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw n("Incorrect invocation")}},function(e,t,i){var r=i(6);e.exports=r.Promise},function(e,t,i){var r=i(6),n=i(102),o=i(16),a=i(149),s=i(147),u=i(15),c=i(262),l=i(189),f=i(32),h=i(88),d=n&&n.prototype,p=u("species"),v=!1,m=o(r.PromiseRejectionEvent),y=a("Promise",(function(){var e=s(n),t=e!==String(n);if(!t&&66===h)return!0;if(f&&(!d.catch||!d.finally))return!0;if(!h||h<51||!/native code/.test(e)){var i=new n((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};if((i.constructor={})[p]=r,!(v=i.then((function(){}))instanceof r))return!0}return!t&&(c||l)&&!m}));e.exports={CONSTRUCTOR:y,REJECTION_EVENT:m,SUBCLASSING:v}},function(e,t,i){"use strict";var r=i(31),n=TypeError;e.exports.f=function(e){return new function(e){var t,i;this.promise=new e((function(e,r){if(void 0!==t||void 0!==i)throw n("Bad Promise constructor");t=e,i=r})),this.resolve=r(t),this.reject=r(i)}(e)}},function(e,t){e.exports={}},function(e,t,i){var r=i(46),n=i(98),o=i(85),a=i(105),s=i(15)("iterator");e.exports=function(e){if(!o(e))return n(e,s)||n(e,"@@iterator")||a[r(e)]}},function(e,t,i){"use strict";var r=i(97),n=i(29),o=i(81);e.exports=function(e,t,i){var a=r(t);a in e?n.f(e,a,o(0,i)):e[a]=i}},function(e,t,i){var r=i(196),n=i(21),o=i(195),a=i(29).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});n(t,e)||a(t,e,{value:o.f(e)})}},function(e,t,i){var r=i(21),n=i(16),o=i(25),a=i(121),s=i(202),u=a("IE_PROTO"),c=Object,l=c.prototype;e.exports=s?c.getPrototypeOf:function(e){var t=o(e);if(r(t,u))return t[u];var i=t.constructor;return n(i)&&t instanceof i?i.prototype:t instanceof c?l:null}},function(e,t,i){i(1)({target:"Object",stat:!0,sham:!i(20)},{create:i(47)})},function(e,t,i){var r=i(1),n=i(3),o=i(25),a=i(109),s=i(202);r({target:"Object",stat:!0,forced:n((function(){a(1)})),sham:!s},{getPrototypeOf:function(e){return a(o(e))}})},function(e,t,i){i(1)({target:"Object",stat:!0},{setPrototypeOf:i(83)})},function(e,t,i){"use strict";var r=i(1),n=i(92),o=i(99).indexOf,a=i(100),s=n([].indexOf),u=!!s&&1/s([1],1,-0)<0;r({target:"Array",proto:!0,forced:u||!a("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return u?s(this,e,t)||0:o(this,e,t)}})},function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,"symbol"===r(o=function(e,t){if("object"!==r(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t);if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key,"string"))?o:String(o),n)}var o}i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(94),i(4),i(141),i(113),i(137),i(12),i(13),i(9),i(10),i(14);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i;return t=e,i=[{key:"truncateDecimals",value:function(e,t,i){void 0===t&&(t=3),i<0&&(e-=.001);var r=e.toString(),n=r.indexOf("."),o=-1===n?r.length:n+t+1,a=r.substr(0,o),s=isNaN(a)?0:a;return parseFloat(s)}},{key:"getElementCoordinates",value:function(e){if(!e)return{};var t=e.getBoundingClientRect();return{top:t.top+pageYOffset,left:t.left+pageXOffset,right:t.right+pageXOffset}}},{key:"getElementSize",value:function(e){var t=e.getBoundingClientRect();return[t.width,t.height]}}],null&&n(t.prototype,null),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=o},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(26),i(40),i(12),i(13),i(9),i(10),i(4),i(14);var r=s(i(18)),n=s(i(171)),o=i(33),a=s(i(114));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===u(n=function(e,t){if("object"!==u(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t,this._logger=r.default.create(t,"PlaybackService"),this._detector=n.default.getInstance()}var t,i;return t=e,(i=[{key:"init",value:function(e){this._mediaElement=e,this._isPlaying=!1,this._isPaused=!1,this._mobilePlaybackActivated=!1}},{key:"unset",value:function(){this._mediaElement=void 0}},{key:"resetPosition",value:function(){this._mediaElement&&0!==this._mediaElement.currentTime&&this.setCurrentTime(0),this._isPaused=!1,this._isPlaying=!1,this._pauseTime=void 0}},{key:"getCurrentTime",value:function(){return this._mediaElement?this._mediaElement.currentTime:0}},{key:"setCurrentTime",value:function(e){var t=this._mediaElement.currentTime;return this._logger.debug("setCurrentTime from ".concat(t," to ").concat(e)),this._mediaElement.currentTime=e,e}},{key:"getPauseTime",value:function(){if(this._isPaused)return this._pauseTime}},{key:"getPlaybackRate",value:function(){return this._mediaElement?this._mediaElement.playbackRate:0}},{key:"setPlaybackRate",value:function(e){if(this._mediaElement)if(this._logger.debug("setPlaybackRate",e,this._mediaElement.currentTime,this._mediaElement.readyState),this._mediaElement.readyState<=2){var t=this;this._rateBeforePlay=e,this._mediaElement.addEventListener("canplay",(function e(){t._logger.debug("onCanPlay"),t._mediaElement&&(t._mediaElement.removeEventListener("canplay",e),t._rateBeforePlay&&(t.setPlaybackRate(t._rateBeforePlay),t._rateBeforePlay=void 0))}))}else this._mediaElement.playbackRate!==e&&(this._mediaElement.playbackRate=e)}},{key:"onPlayFailed",set:function(e){this._onPlayFailedCallback=e}},{key:"handlePlay",value:function(e){var t;if(this._mediaElement&&!this._isPlaying&&(this._isPlaying=!0,this._isPaused=!1,this.playMedia({gesture:e}),this._pauseTime)){var i=performance.now(),r=i-this._pauseTime+.1;this._logger.debug("Play at: "+this._timeStr(i)),this._logger.debug("Going to seek by ".concat(r/1e3," seconds.")),t=a.default.truncateDecimals(this._mediaElement.currentTime+r/1e3)}return t}},{key:"handlePause",value:function(){if(this._mediaElement&&!this._isPaused&&this._isPlaying)return this._isPaused=!0,this._isPlaying=!1,this._pauseTime=performance.now(),this._mediaElement.src&&this._mediaElement.pause(),this._logger.debug("Paused at: "+this._timeStr(this._pauseTime)),!0}},{key:"resumeIfAutoPaused",value:function(){if(this._mediaElement&&this._mediaElement.paused&&this._isPlaying&&!this._isPaused){this._logger.debug("resume if auto paused");var e=this.getCurrentTime();this.playMedia({recover:!0});var t=this;setTimeout((function(){0===t.getCurrentTime()&&(t._logger.debug("resumeIfAutoPaused set media element currentTime to",e),t.setCurrentTime(e))}),10)}}},{key:"isPaused",value:function(){return!!this._mediaElement&&this._isPaused}},{key:"playMedia",value:function(e){if(this._logger.debug("play media",e,this._isPlaying),this._mediaElement.src){var t=this._mediaElement.play();if(void 0!==t){var i=!e.recover,r=this;t.then((function(){r._isPlaying=!0})).catch((function(e){i&&r._onPlayFailedCallback()}))}else this._detector.isMobile()&&!this._mobilePlaybackActivated&&(e.gesture?this._mobilePlaybackActivated=!0:e.recover||this._onPlayFailedCallback())}else this._isPlaying=!0}},{key:"checkSafariPaused",value:function(){}},{key:"_timeStr",value:function(e){return performance.timing.navigationStart+e}}])&&c(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),f=(0,o.multiInstanceHolder)(l);t.default=f},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(142),i(12),i(13),i(9),i(10),i(4),i(14);var r=i(33);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===n(o=function(e,t){if("object"!==n(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?o:String(o),r)}var o}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._instId=t}var t,r;return t=e,(r=[{key:"setScriptPath",value:function(e){this._scriptPath=e}},{key:"translateToScriptPath",value:function(e){return this._scriptPath?this._scriptPath+this._extractFilenameFrom(e):e}},{key:"runWebpackImportUnderScriptPath",value:function(e){var t=i.p;i.p=this._scriptPath,e(),i.p=t}},{key:"notAvailableError",value:function(e,t){var i=this._extractFilenameFrom(t);return"".concat(e," file is not found. It should be placed in the same path as SLDP Player itself. ")+"Please download it from the following path: https://softvelum.com/player/releases/".concat(i)}},{key:"_extractFilenameFrom",value:function(e){return e&&e.length>0?e.substr(e.lastIndexOf("/")+1):e}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),s=(0,r.multiInstanceHolder)(a);t.default=s},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(26),i(12),i(13),i(9),i(10),i(4),i(14);var r,n=(r=i(18))&&r.__esModule?r:{default:r},o=i(33);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===a(n=function(e,t){if("object"!==a(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t,this._logger=n.default.create(t,"AudioContextProvider")}var t,i;return t=e,(i=[{key:"init",value:function(){var e=window.AudioContext||window.webkitAudioContext;if(!e)return!1;if(this._audioCtx)this._suspended&&(this._logger.debug("Trying to resume suspended audio context"),this._audioCtx.resume());else if(this._audioCtx=new e({sampleRate:48e3}),"suspended"!==this._audioCtx.state)this._suspended=!1;else{this._callbacks=[];var t=this;this._audioCtx.onstatechange=function(){if(t._logger.debug("onstatechange",t._audioCtx.state,t._suspended),t._suspended&&"running"===t._audioCtx.state){t._logger.debug("Audio context switched to running"),t._audioCtx.onstatechange=void 0,t._suspended=!1;for(var e=0;e<t._callbacks.length;e++)t._callbacks[e](t._audioCtx);this._callbacks=void 0}},this._logger.debug("Audio context is created, but it's suspended"),this._suspended=!0,this._audioCtx.resume()}}},{key:"onContextRunning",value:function(e){this._callbacks?this._callbacks.push(e):this._logger.error("onContextRunning callbacks are not defined")}},{key:"isSuspended",value:function(){return this._suspended}},{key:"setChannelCount",value:function(e){this._audioCtx&&this._logger.warn("setChannelCount ".concat(e,", max channel count ").concat(this._audioCtx.destination.maxChannelCount))}},{key:"get",value:function(){return this._audioCtx}}])&&s(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),c=(0,o.multiInstanceHolder)(u);t.default=c},function(e,t,i){"use strict";var r=i(1),n=i(25),o=i(75),a=i(35),s=i(28),u=i(289),c=i(218),l=i(156),f=i(107),h=i(167),d=i(131)("splice"),p=Math.max,v=Math.min;r({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var i,r,d,m,y,g,b=n(this),_=s(b),w=o(e,_),A=arguments.length;for(0===A?i=r=0:1===A?(i=0,r=_-w):(i=A-2,r=v(p(a(t),0),_-w)),c(_+i-r),d=l(b,r),m=0;m<r;m++)(y=w+m)in b&&f(d,m,b[y]);if(d.length=r,i<r){for(m=w;m<_-r;m++)g=m+i,(y=m+r)in b?b[g]=b[y]:h(b,g);for(m=_;m>_-r+i;m--)h(b,m-1)}else if(i>r)for(m=_-r;m>w;m--)g=m+i-1,(y=m+r-1)in b?b[g]=b[y]:h(b,g);for(m=0;m<i;m++)b[m+w]=arguments[m+2];return u(b,_-r+i),d}})},function(e,t,i){var r=i(5),n=0,o=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++n+o,36)}},function(e,t,i){var r=i(6),n=i(23),o=r.document,a=n(o)&&n(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,i){var r=i(89),n=i(119),o=r("keys");e.exports=function(e){return o[e]||(o[e]=n(e))}},function(e,t){e.exports={}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,i){i(254),i(263),i(264),i(265),i(266),i(267)},function(e,t,i){(function(t){var r=i(42);e.exports=void 0!==t&&"process"==r(t)}).call(this,i(255))},function(e,t,i){var r=i(5),n=i(3),o=i(16),a=i(46),s=i(30),u=i(147),c=function(){},l=[],f=s("Reflect","construct"),h=/^\s*(?:class|function)\b/,d=r(h.exec),p=!h.exec(c),v=function(e){if(!o(e))return!1;try{return f(c,l,e),!0}catch(e){return!1}},m=function(e){if(!o(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!d(h,u(e))}catch(e){return!0}};m.sham=!0,e.exports=!f||n((function(){var e;return v(v.call)||!v(Object)||!v((function(){e=!0}))||e}))?m:v},function(e,t){var i=TypeError;e.exports=function(e,t){if(e<t)throw i("Not enough arguments");return e}},function(e,t,i){var r=i(19),n=i(31),o=i(22),a=i(82),s=i(106),u=TypeError;e.exports=function(e,t){var i=arguments.length<2?s(e):t;if(n(i))return o(r(i,e));throw u(a(e)+" is not iterable")}},function(e,t,i){var r=i(183),n=i(148);e.exports=Object.keys||function(e){return r(e,n)}},function(e,t,i){var r=i(75),n=i(28),o=i(107),a=Array,s=Math.max;e.exports=function(e,t,i){for(var u=n(e),c=r(t,u),l=r(void 0===i?u:i,u),f=a(s(l-c,0)),h=0;c<l;c++,h++)o(f,h,e[c]);return f.length=h,f}},function(e,t,i){var r=i(3),n=i(15),o=i(88),a=n("species");e.exports=function(e){return o>=51||!r((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,i){"use strict";var r=i(6),n=i(5),o=i(20),a=i(166),s=i(90),u=i(44),c=i(39),l=i(208),f=i(3),h=i(101),d=i(35),p=i(45),v=i(209),m=i(277),y=i(109),g=i(83),b=i(91).f,_=i(210),w=i(130),A=i(38),S=i(34),k=s.PROPER,C=s.CONFIGURABLE,T=S.getterFor("ArrayBuffer"),P=S.getterFor("DataView"),x=S.set,E=r.ArrayBuffer,B=E,M=B&&B.prototype,R=r.DataView,I=R&&R.prototype,F=Object.prototype,L=r.Array,O=r.RangeError,j=n(_),D=n([].reverse),V=m.pack,U=m.unpack,N=function(e){return[255&e]},W=function(e){return[255&e,e>>8&255]},H=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},z=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},q=function(e){return V(e,23,4)},G=function(e){return V(e,52,8)},Q=function(e,t,i){c(e.prototype,t,{configurable:!0,get:function(){return i(this)[t]}})},Y=function(e,t,i,r){var n=v(i),o=P(e);if(n+t>o.byteLength)throw O("Wrong index");var a=o.bytes,s=n+o.byteOffset,u=w(a,s,s+t);return r?u:D(u)},K=function(e,t,i,r,n,o){var a=v(i),s=P(e);if(a+t>s.byteLength)throw O("Wrong index");for(var u=s.bytes,c=a+s.byteOffset,l=r(+n),f=0;f<t;f++)u[c+f]=l[o?f:t-f-1]};if(a){var J=k&&"ArrayBuffer"!==E.name;if(f((function(){E(1)}))&&f((function(){new E(-1)}))&&!f((function(){return new E,new E(1.5),new E(NaN),1!=E.length||J&&!C})))J&&C&&u(E,"name","ArrayBuffer");else{(B=function(e){return h(this,M),new E(v(e))}).prototype=M;for(var X,Z=b(E),$=0;Z.length>$;)(X=Z[$++])in B||u(B,X,E[X]);M.constructor=B}g&&y(I)!==F&&g(I,F);var ee=new R(new B(2)),te=n(I.setInt8);ee.setInt8(0,2147483648),ee.setInt8(1,2147483649),!ee.getInt8(0)&&ee.getInt8(1)||l(I,{setInt8:function(e,t){te(this,e,t<<24>>24)},setUint8:function(e,t){te(this,e,t<<24>>24)}},{unsafe:!0})}else M=(B=function(e){h(this,M);var t=v(e);x(this,{type:"ArrayBuffer",bytes:j(L(t),0),byteLength:t}),o||(this.byteLength=t,this.detached=!1)}).prototype,I=(R=function(e,t,i){h(this,I),h(e,M);var r=T(e),n=r.byteLength,a=d(t);if(a<0||a>n)throw O("Wrong offset");if(a+(i=void 0===i?n-a:p(i))>n)throw O("Wrong length");x(this,{type:"DataView",buffer:e,byteLength:i,byteOffset:a,bytes:r.bytes}),o||(this.buffer=e,this.byteLength=i,this.byteOffset=a)}).prototype,o&&(Q(B,"byteLength",T),Q(R,"buffer",P),Q(R,"byteLength",P),Q(R,"byteOffset",P)),l(I,{getInt8:function(e){return Y(this,1,e)[0]<<24>>24},getUint8:function(e){return Y(this,1,e)[0]},getInt16:function(e){var t=Y(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Y(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return z(Y(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return z(Y(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return U(Y(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return U(Y(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){K(this,1,e,N,t)},setUint8:function(e,t){K(this,1,e,N,t)},setInt16:function(e,t){K(this,2,e,W,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){K(this,2,e,W,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){K(this,4,e,H,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){K(this,4,e,H,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){K(this,4,e,q,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){K(this,8,e,G,t,arguments.length>2?arguments[2]:void 0)}});A(B,"ArrayBuffer"),A(R,"DataView"),e.exports={ArrayBuffer:B,DataView:R}},function(e,t,i){var r=i(17),n=i(151),o=r.aTypedArrayConstructor,a=r.getTypedArrayConstructor;e.exports=function(e){return o(n(e,a(e)))}},function(e,t,i){var r=i(1),n=i(288);r({global:!0,forced:parseInt!=n},{parseInt:n})},function(e,t,i){var r=i(5),n=i(73),o=i(24),a=i(136),s=r("".replace),u=RegExp("^["+a+"]+"),c=RegExp("(^|[^"+a+"])["+a+"]+$"),l=function(e){return function(t){var i=o(n(t));return 1&e&&(i=s(i,u,"")),2&e&&(i=s(i,c,"$1")),i}};e.exports={start:l(1),end:l(2),trim:l(3)}},function(e,t){e.exports="\t\n\v\f\r Â áš€â€€â€â€‚â€ƒâ€„â€…â€†â€‡â€ˆâ€‰â€Šâ€¯âŸã€€\u2028\u2029\ufeff"},function(e,t,i){var r=i(1),n=i(295);r({global:!0,forced:parseFloat!=n},{parseFloat:n})},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(79);var r=new function(){var e={};this.init=function(t,i){if(i)for(var r in e[t]={},i){var n=document.getElementById(i[r]);n&&(e[t][r]=n)}},this.display=function(t,i,r){if(e[t]){var n=e[t][i];n&&(r instanceof Array&&(r=r.join(", ")),n.innerHTML=r)}}};t.default=r},function(e,t,i){i(321)},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){this.offset=void 0===e?0:e}},function(e,t,i){"use strict";var r=i(90).PROPER,n=i(27),o=i(22),a=i(24),s=i(3),u=i(299),c=RegExp.prototype.toString,l=s((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),f=r&&"toString"!=c.name;(l||f)&&n(RegExp.prototype,"toString",(function(){var e=o(this);return"/"+a(e.source)+"/"+a(u(e))}),{unsafe:!0})},function(e,t,i){var r=i(1),n=i(184);r({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},function(e,t,i){"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,o=n&&!r.call({1:2},1);t.f=o?function(e){var t=n(this,e);return!!t&&t.enumerable}:r},function(e,t,i){var r=i(19),n=i(23),o=i(86),a=i(98),s=i(178),u=i(15),c=TypeError,l=u("toPrimitive");e.exports=function(e,t){if(!n(e)||o(e))return e;var i,u=a(e,l);if(u){if(void 0===t&&(t="default"),i=r(u,e,t),!n(i)||o(i))return i;throw c("Can't convert object to primitive value")}return void 0===t&&(t="number"),s(e,t)}},function(e,t,i){var r=i(6),n=i(146),o=r["__core-js_shared__"]||n("__core-js_shared__",{});e.exports=o},function(e,t,i){var r=i(6),n=Object.defineProperty;e.exports=function(e,t){try{n(r,e,{value:t,configurable:!0,writable:!0})}catch(i){r[e]=t}return t}},function(e,t,i){var r=i(5),n=i(16),o=i(145),a=r(Function.toString);n(o.inspectSource)||(o.inspectSource=function(e){return a(e)}),e.exports=o.inspectSource},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,i){var r=i(3),n=i(16),o=/#|\.prototype\./,a=function(e,t){var i=u[s(e)];return i==l||i!=c&&(n(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},u=a.data={},c=a.NATIVE="N",l=a.POLYFILL="P";e.exports=a},function(e,t,i){"use strict";var r=i(30),n=i(39),o=i(15),a=i(20),s=o("species");e.exports=function(e){var t=r(e);a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,i){var r=i(22),n=i(152),o=i(85),a=i(15)("species");e.exports=function(e,t){var i,s=r(e).constructor;return void 0===s||o(i=r(s)[a])?t:n(i)}},function(e,t,i){var r=i(126),n=i(82),o=TypeError;e.exports=function(e){if(r(e))return e;throw o(n(e)+" is not a constructor")}},function(e,t,i){var r={};r[i(15)("toStringTag")]="z",e.exports="[object z]"===String(r)},function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},function(e,t,i){var r=i(15),n=i(105),o=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||a[o]===e)}},function(e,t,i){var r=i(271);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},function(e,t,i){var r=i(5),n=i(35),o=i(24),a=i(73),s=r("".charAt),u=r("".charCodeAt),c=r("".slice),l=function(e){return function(t,i){var r,l,f=o(a(t)),h=n(i),d=f.length;return h<0||h>=d?e?"":void 0:(r=u(f,h))<55296||r>56319||h+1===d||(l=u(f,h+1))<56320||l>57343?e?s(f,h):r:e?c(f,h,h+2):l-56320+(r-55296<<10)+65536}};e.exports={codeAt:l(!1),charAt:l(!0)}},function(e,t,i){i(108)("asyncIterator")},function(e,t,i){var r=i(30),n=i(108),o=i(38);n("toStringTag"),o(r("Symbol"),"Symbol")},function(e,t,i){var r=i(6);i(38)(r.JSON,"JSON",!0)},function(e,t,i){i(38)(Math,"Math",!0)},function(e,t,i){"use strict";var r=i(1),n=i(207);r({target:"Array",proto:!0,forced:[].forEach!=n},{forEach:n})},function(e,t,i){var r=i(6),n=i(204),o=i(205),a=i(207),s=i(44),u=function(e){if(e&&e.forEach!==a)try{s(e,"forEach",a)}catch(t){e.forEach=a}};for(var c in n)n[c]&&u(r[c]&&r[c].prototype);u(o)},function(e,t,i){"use strict";var r=i(1),n=i(5),o=i(93),a=n([].reverse),s=[1,2];r({target:"Array",proto:!0,forced:String(s)===String(s.reverse())},{reverse:function(){return o(this)&&(this.length=this.length),a(this)}})},function(e,t,i){"use strict";var r=i(1),n=i(93),o=i(126),a=i(23),s=i(75),u=i(28),c=i(37),l=i(107),f=i(15),h=i(131),d=i(84),p=h("slice"),v=f("species"),m=Array,y=Math.max;r({target:"Array",proto:!0,forced:!p},{slice:function(e,t){var i,r,f,h=c(this),p=u(h),g=s(e,p),b=s(void 0===t?p:t,p);if(n(h)&&(i=h.constructor,(o(i)&&(i===m||n(i.prototype))||a(i)&&null===(i=i[v]))&&(i=void 0),i===m||void 0===i))return d(h,g,b);for(r=new(void 0===i?m:i)(y(b-g,0)),f=0;g<b;g++,f++)g in h&&l(r,f,h[g]);return r.length=f,r}})},function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},function(e,t,i){"use strict";var r=i(82),n=TypeError;e.exports=function(e,t){if(!delete e[t])throw n("Cannot delete property "+r(t)+" of "+r(e))}},function(e,t,i){var r=i(130),n=Math.floor,o=function(e,t){var i=e.length,u=n(i/2);return i<8?a(e,t):s(e,o(r(e,0,u),t),o(r(e,u),t),t)},a=function(e,t){for(var i,r,n=e.length,o=1;o<n;){for(r=o,i=e[o];r&&t(e[r-1],i)>0;)e[r]=e[--r];r!==o++&&(e[r]=i)}return e},s=function(e,t,i,r){for(var n=t.length,o=i.length,a=0,s=0;a<n||s<o;)e[a+s]=a<n&&s<o?r(t[a],i[s])<=0?t[a++]:i[s++]:a<n?t[a++]:i[s++];return e};e.exports=o},function(e,t,i){"use strict";var r=i(22);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(78),i(12),i(13),i(9),i(10),i(4),i(14);var r=u(i(303)),n=u(i(317)),o=u(i(115)),a=i(33),s=u(i(18));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function f(e,t,i){return(t=h(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===c(t)?t:String(t)}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"_onMediaReady",function(e){this._onMediaReadyCallback()}.bind(this)),f(this,"_onProgress",function(e,t,i){this._onProgressCallback(t,i)}.bind(this)),f(this,"_onCrash",function(e,t){this._onCrashCallback(t)}.bind(this)),f(this,"_onWaitUpdate",function(e,t,i){this._onWaitUpdateCallback(t,i)}.bind(this)),f(this,"_onPlayStarted",function(e){this._onPlayStartedCallback()}.bind(this)),f(this,"_onLatencyCalc",function(e,t){return this._onLatencyCalcCallback(t)}.bind(this)),f(this,"_onLatencySeek",function(e,t,i){this._onLatencySeekCallback(t,i)}.bind(this)),f(this,"_onLowBuffer",function(e){this._onLowBufferCallback()}.bind(this)),f(this,"_getAvgVBufLvl",function(e){return this._getAvgVBufLvlCallback()}.bind(this)),this._id=t,this._apiNames=["_mse","_wapi"],this._codec2Api={},this._lowBufferValues={},this._stored={},this._logger=s.default.create(t,"MediaService"),this._playbackService=o.default.getInstance(t)}var t,i;return t=e,(i=[{key:"isMediaSourceSupported",value:function(){return void 0!==window.MediaSource}},{key:"isWebAudioSupported",value:function(){return void 0!==window.AudioContext||void 0!==window.webkitAudioContext}},{key:"isWebAudioAvailable",value:function(){return window.isSecureContext&&void 0!==window.AudioWorkletNode}},{key:"isCodecSupportedByMediaSource",value:function(e,t){return!!this.isMediaSourceSupported()&&r.default.isCodecSupported(e,t)}},{key:"isCodecSupported",value:function(e,t){var i=this.isCodecSupportedByMediaSource(e,t);return!i&&"audio"===e&&this._opusDecoderEnabled&&!this._mse&&this.isWebAudioSupported()&&this.isWebAudioAvailable()&&(i=n.default.isCodecSupported(e,t)),i}},{key:"setOpusDecoderEnabled",value:function(e){this._opusDecoderEnabled=!!e}},{key:"setupMediaApi",value:function(e,t){if(this.isMediaSourceSupported()&&r.default.isCodecSupported(e,t))return this._mse||(this._mse=r.default.create(this._id)),this._setMseCallbacks(),void(this._codec2Api[e+t]=this._mse);this.isWebAudioSupported()&&this.isWebAudioAvailable()&&n.default.isCodecSupported(e,t)&&(this._wapi||(this._wapi=n.default.create(this._id)),this._setWapiCallbacks(),this._codec2Api[e+t]=this._wapi)}},{key:"init",value:function(e,t){for(var i=this._forAllApis((function(i){return i.init(e,t)})),r=0;r<this._apiNames.length;r++)if(this[this._apiNames[r]]&&!i[r])return!1;return this._initialized||(this._setStoredParams(),this._initialized=!0),!0}},{key:"isInitialized",value:function(){return this._initialized}},{key:"createSourceBuffer",value:function(e,t,i,r){return this._forApi(e,t,(function(n){return n.createSourceBuffer(e,t,i,r)}))}},{key:"clear",value:function(){this._forAllApis((function(e){return e.clear()})),this._playbackService.unset(),this._codec2Api={},this._mse=void 0,this._wapi=void 0,this._initialized=!1}},{key:"setLatencyTolerance",value:function(e,t,i){this._initialized?this._forAllApis((function(r){return r.setLatencyTolerance(e,t,i)})):(this._stored.tolerance=e,this._stored.buffering=t,this._stored.zapping=i)}},{key:"toggleBufferLineUp",value:function(e){this._initialized?this._mse&&this._mse.toggleBufferLineUp(e):this._stored.bufferLineUp=e}},{key:"setSyncParams",value:function(e,t){this._forAllApis((function(i){return i.setSyncParams(e,t)}))}},{key:"startLogging",value:function(e,t,i){this._forApi(e,t,(function(e){return e.startLogging(i)}))}},{key:"setCurrentBufferLevel",value:function(e,t,i){this._forApi(e,t,(function(t){return t.setCurrentBufferLevel(e,i)}))}},{key:"setLowBufferBorder",value:function(e,t){this._lowBufferValues[t]=e+.06;var i=0;for(var r in this._lowBufferValues)this._lowBufferValues[r]>i&&(i=this._lowBufferValues[r]);this._forAllApis((function(e){return e.setLowBufferBorder(i)}))}},{key:"setPositionControl",value:function(){this._mse&&this._mse.setPositionControl()}},{key:"setTransitOn",value:function(){this._mse&&this._mse.setTransitOn()}},{key:"setTransitOff",value:function(){this._mse&&this._mse.setTransitOff()}},{key:"handlePlay",value:function(e){var t=this._playbackService.handlePlay(e);t&&this._forAllApis((function(e){return e.resumeTo(t)}))}},{key:"handlePause",value:function(){this._playbackService.handlePause()&&this._forAllApis((function(e){return e.handlePause()}))}},{key:"handlePlayEvent",value:function(){this._forAllApis((function(e){return e.handlePlayEvent()}))}},{key:"handlePauseEvent",value:function(){this._forAllApis((function(e){return e.handlePauseEvent()}))}},{key:"handleEnterPip",value:function(){}},{key:"handleLeavePip",value:function(){this._playbackService.resumeIfAutoPaused()}},{key:"startPlayback",value:function(e){this._forAllApis((function(t){return t.startPlayback(e)}))}},{key:"continue",value:function(){this._forAllApis((function(e){return e.continue()}))}},{key:"wait",value:function(){this._forAllApis((function(e){return e.wait()}))}},{key:"isSeeking",value:function(){return this._mse&&this._mse.isSeeking()||this._wapi&&this._wapi.isSeeking()}},{key:"resetPosition",value:function(){this._forAllApis((function(e){return e.resetPosition()}))}},{key:"callbacks",set:function(e){for(var t in e)this["_"+t+"Callback"]=e[t]}},{key:"setVolume",value:function(e){this._initialized?this._forAllApis((function(t){return t.setVolume(e)})):this._stored.volume=e}},{key:"getVolume",value:function(){if(this._initialized){if(this._mse)return this._mse.getVolume();if(this._wapi)return this._wapi.getVolume()}return void 0===this._stored.volume?1:this._stored.volume}},{key:"setMuted",value:function(e){this._initialized?this._forAllApis((function(t){return t.setMuted(e)})):this._stored.muted=e}},{key:"isMuted",value:function(){return this._initialized?this._mse&&this._mse.isMuted()||this._wapi&&this._wapi.isMuted():!!this._stored.muted}},{key:"_setMseCallbacks",value:function(){this._mse&&this._mse.callbacks({onProgress:this._onProgress,onMediaReady:this._onMediaReady,onCrash:this._onCrash,onWaitUpdate:this._onWaitUpdate,onPlayStarted:this._onPlayStarted,onLatencyCalc:this._onLatencyCalc,onLatencySeek:this._onLatencySeek,onLowBuffer:this._onLowBuffer,getAvgVBufLvl:this._getAvgVBufLvl})}},{key:"_setWapiCallbacks",value:function(){this._wapi&&(this._wapi.callbacks={onProgress:this._onProgress,onMediaReady:this._onMediaReady,onCrash:this._onCrash,onWaitUpdate:this._onWaitUpdate,onPlayStarted:this._onPlayStarted,onLatencyCalc:this._onLatencyCalc,onLatencySeek:this._onLatencySeek,onLowBuffer:this._onLowBuffer})}},{key:"_setStoredParams",value:function(){var e=this;this._forAllApis((function(t){t.setLatencyTolerance(e._stored.tolerance,e._stored.buffering,e._stored.zapping),t.toggleBufferLineUp(e._stored.bufferLineUp),void 0!==e._stored.volume&&t.setVolume(e._stored.volume),void 0!==e._stored.muted&&t.setMuted(e._stored.muted)})),this._stored.volume=void 0,this._stored.muted=void 0}},{key:"_forAllApis",value:function(e){for(var t=[],i=0;i<this._apiNames.length;i++){var r=this[this._apiNames[i]];r&&(t[i]=e(r))}return t}},{key:"_forApi",value:function(e,t,i){var r=this._codec2Api[e+t];if(r)return i(r);this._logger.error("media API is not found for",e,t,this._codec2Api)}}])&&l(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),p=(0,a.multiInstanceHolder)(d);t.default=p},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(172),i(316),i(94),i(4),i(141),i(113),i(26),i(12),i(13),i(9),i(10),i(14);var r,n=(r=i(18))&&r.__esModule?r:{default:r},o=i(33);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===a(n=function(e,t){if("object"!==a(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var u=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._logger=n.default.create("","PlatformDetector"),void 0!==window)if(window.navigator||navigator){this.nav=window.navigator||navigator,this.userAgent=(this.nav.userAgent||"").toLowerCase(),this._isFirefox="undefined"!=typeof InstallTrigger,this._isOpera=null!==this.userAgent.match(/(?:^opera.+?version|opr)\/(\d+)/);var t=(this.nav&&this.nav.vendor||"").toLowerCase(),i=/google inc/.test(t)?this.userAgent.match(/(?:chrome|crios)\/(\d+)/):null;this._isChrome=null!==i&&!this._isOpera,this._isSafari=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString(),this._isSafari||this._isChrome||(this._isSafari=navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")<=-1),this._isIE=!!document.documentMode,this._isEdge=!this._isIE&&!!window.StyleMedia,this._iPadOS13=this._isIOS13("iPad"),this._isMobile=/android|webos|iphone|ipad|ipod|opera mini/i.test(this.userAgent)||this._iPadOS13,this._isIOS=/ipad|iphone|ipod/.test(this.userAgent)&&!window.MSStream||this._iPadOS13}else this._logger.error("navigator is not defined");else this._logger.error("window is undefined")}var t,i;return t=e,(i=[{key:"isMobile",value:function(){return this._isMobile}},{key:"isIOS",value:function(){return this._isIOS}},{key:"isBrowser",value:function(e){switch(e){case"Firefox":return this._isFirefox;case"Chrome":return this._isChrome;case"Safari":return this._isSafari;case"Edge":return this._isEdge;case"IE":return this._isIE;case"Microsoft":return this._isIE||this._isEdge;default:return this._logger.debug("Unknown browser name",e),null}}},{key:"logData",value:function(){this._logger.debug("Firefox - ".concat(this._isFirefox,", Chrome - ").concat(this._isChrome,", Safari - ").concat(this._isSafari,", IE - ").concat(this._isIE,", Edge - ").concat(this._isEdge,", Mobile - ").concat(this._isMobile,", iOS - ").concat(this._isIOS,", iPadOS - ").concat(this._iPadOS13))}},{key:"_isIOS13",value:function(e){return this.nav&&this.nav.platform&&(-1!==this.nav.platform.indexOf(e)||"MacIntel"===this.nav.platform&&this.nav.maxTouchPoints>1&&!window.MSStream)}}])&&s(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),c=(0,o.instanceHolder)(u);t.default=c},function(e,t,i){"use strict";var r=i(1),n=i(173);r({target:"RegExp",proto:!0,forced:/./.exec!==n},{exec:n})},function(e,t,i){"use strict";var r,n,o=i(19),a=i(5),s=i(24),u=i(169),c=i(313),l=i(89),f=i(47),h=i(34).get,d=i(314),p=i(315),v=l("native-string-replace",String.prototype.replace),m=RegExp.prototype.exec,y=m,g=a("".charAt),b=a("".indexOf),_=a("".replace),w=a("".slice),A=(n=/b*/g,o(m,r=/a/,"a"),o(m,n,"a"),0!==r.lastIndex||0!==n.lastIndex),S=c.BROKEN_CARET,k=void 0!==/()??/.exec("")[1];(A||k||S||d||p)&&(y=function(e){var t,i,r,n,a,c,l,d=this,p=h(d),C=s(e),T=p.raw;if(T)return T.lastIndex=d.lastIndex,t=o(y,T,C),d.lastIndex=T.lastIndex,t;var P=p.groups,x=S&&d.sticky,E=o(u,d),B=d.source,M=0,R=C;if(x&&(E=_(E,"y",""),-1===b(E,"g")&&(E+="g"),R=w(C,d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==g(C,d.lastIndex-1))&&(B="(?: "+B+")",R=" "+R,M++),i=new RegExp("^(?:"+B+")",E)),k&&(i=new RegExp("^"+B+"$(?!\\s)",E)),A&&(r=d.lastIndex),n=o(m,x?i:d,R),x?n?(n.input=w(n.input,M),n[0]=w(n[0],M),n.index=d.lastIndex,d.lastIndex+=n[0].length):d.lastIndex=0:A&&n&&(d.lastIndex=d.global?n.index+n[0].length:r),k&&n&&n.length>1&&o(v,n[0],i,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(n[a]=void 0)})),n&&P)for(n.groups=c=f(null),a=0;a<P.length;a++)c[(l=P[a])[0]]=n[l[1]];return n}),e.exports=y},function(e,t,i){var r=i(6),n=i(20),o=i(39),a=i(169),s=i(3),u=r.RegExp,c=u.prototype;n&&s((function(){var e=!0;try{u(".","d")}catch(t){e=!1}var t={},i="",r=e?"dgimsy":"gimsy",n=function(e,r){Object.defineProperty(t,e,{get:function(){return i+=r,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in e&&(o.hasIndices="d"),o)n(a,o[a]);return Object.getOwnPropertyDescriptor(c,"flags").get.call(t)!==r||i!==r}))&&o(c,"flags",{configurable:!0,get:a})},function(e,t,i){"use strict";var r=i(1),n=i(135).trim;r({target:"String",proto:!0,forced:i(330)("trim")},{trim:function(){return n(this)}})},function(e,t){var i="object"==typeof document&&document.all,r=void 0===i&&void 0!==i;e.exports={all:i,IS_HTMLDDA:r}},function(e,t,i){var r=i(87);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,i){var r=i(19),n=i(16),o=i(23),a=TypeError;e.exports=function(e,t){var i,s;if("string"===t&&n(i=e.toString)&&!o(s=r(i,e)))return s;if(n(i=e.valueOf)&&!o(s=r(i,e)))return s;if("string"!==t&&n(i=e.toString)&&!o(s=r(i,e)))return s;throw a("Can't convert object to primitive value")}},function(e,t,i){var r=i(20),n=i(3),o=i(120);e.exports=!r&&!n((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,i){var r=i(20),n=i(3);e.exports=r&&n((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(e,t,i){var r=i(5),n=i(3),o=i(16),a=i(21),s=i(20),u=i(90).CONFIGURABLE,c=i(147),l=i(34),f=l.enforce,h=l.get,d=String,p=Object.defineProperty,v=r("".slice),m=r("".replace),y=r([].join),g=s&&!n((function(){return 8!==p((function(){}),"length",{value:8}).length})),b=String(String).split("String"),_=e.exports=function(e,t,i){"Symbol("===v(d(t),0,7)&&(t="["+m(d(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),i&&i.getter&&(t="get "+t),i&&i.setter&&(t="set "+t),(!a(e,"name")||u&&e.name!==t)&&(s?p(e,"name",{value:t,configurable:!0}):e.name=t),g&&i&&a(i,"arity")&&e.length!==i.arity&&p(e,"length",{value:i.arity});try{i&&a(i,"constructor")&&i.constructor?s&&p(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=f(e);return a(r,"source")||(r.source=y(b,"string"==typeof t?t:"")),e};Function.prototype.toString=_((function(){return o(this)&&h(this).source||c(this)}),"toString")},function(e,t,i){var r=i(21),n=i(251),o=i(80),a=i(29);e.exports=function(e,t,i){for(var s=n(t),u=a.f,c=o.f,l=0;l<s.length;l++){var f=s[l];r(e,f)||i&&r(i,f)||u(e,f,c(t,f))}}},function(e,t,i){var r=i(5),n=i(21),o=i(37),a=i(99).indexOf,s=i(122),u=r([].push);e.exports=function(e,t){var i,r=o(e),c=0,l=[];for(i in r)!n(s,i)&&n(r,i)&&u(l,i);for(;t.length>c;)n(r,i=t[c++])&&(~a(l,i)||u(l,i));return l}},function(e,t,i){"use strict";var r=i(76),n=i(37),o=i(35),a=i(28),s=i(100),u=Math.min,c=[].lastIndexOf,l=!!c&&1/[1].lastIndexOf(1,-0)<0,f=s("lastIndexOf"),h=l||!f;e.exports=h?function(e){if(l)return r(c,this,arguments)||0;var t=n(this),i=a(t),s=i-1;for(arguments.length>1&&(s=u(s,o(arguments[1]))),s<0&&(s=i+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:c},function(e,t,i){var r,n,o,a,s=i(6),u=i(76),c=i(77),l=i(16),f=i(21),h=i(3),d=i(186),p=i(84),v=i(120),m=i(127),y=i(187),g=i(125),b=s.setImmediate,_=s.clearImmediate,w=s.process,A=s.Dispatch,S=s.Function,k=s.MessageChannel,C=s.String,T=0,P={};h((function(){r=s.location}));var x=function(e){if(f(P,e)){var t=P[e];delete P[e],t()}},E=function(e){return function(){x(e)}},B=function(e){x(e.data)},M=function(e){s.postMessage(C(e),r.protocol+"//"+r.host)};b&&_||(b=function(e){m(arguments.length,1);var t=l(e)?e:S(e),i=p(arguments,1);return P[++T]=function(){u(t,void 0,i)},n(T),T},_=function(e){delete P[e]},g?n=function(e){w.nextTick(E(e))}:A&&A.now?n=function(e){A.now(E(e))}:k&&!y?(a=(o=new k).port2,o.port1.onmessage=B,n=c(a.postMessage,a)):s.addEventListener&&l(s.postMessage)&&!s.importScripts&&r&&"file:"!==r.protocol&&!h(M)?(n=M,s.addEventListener("message",B,!1)):n="onreadystatechange"in v("script")?function(e){d.appendChild(v("script")).onreadystatechange=function(){d.removeChild(this),x(e)}}:function(e){setTimeout(E(e),0)}),e.exports={set:b,clear:_}},function(e,t,i){var r=i(30);e.exports=r("document","documentElement")},function(e,t,i){var r=i(74);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},function(e,t){var i=function(){this.head=null,this.tail=null};i.prototype={add:function(e){var t={item:e,next:null},i=this.tail;i?i.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}},e.exports=i},function(e,t){e.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},function(e,t,i){var r=i(77),n=i(19),o=i(22),a=i(82),s=i(155),u=i(28),c=i(43),l=i(128),f=i(106),h=i(191),d=TypeError,p=function(e,t){this.stopped=e,this.result=t},v=p.prototype;e.exports=function(e,t,i){var m,y,g,b,_,w,A,S=i&&i.that,k=!(!i||!i.AS_ENTRIES),C=!(!i||!i.IS_RECORD),T=!(!i||!i.IS_ITERATOR),P=!(!i||!i.INTERRUPTED),x=r(t,S),E=function(e){return m&&h(m,"normal",e),new p(!0,e)},B=function(e){return k?(o(e),P?x(e[0],e[1],E):x(e[0],e[1])):P?x(e,E):x(e)};if(C)m=e.iterator;else if(T)m=e;else{if(!(y=f(e)))throw d(a(e)+" is not iterable");if(s(y)){for(g=0,b=u(e);b>g;g++)if((_=B(e[g]))&&c(v,_))return _;return new p(!1)}m=l(e,y)}for(w=C?e.next:m.next;!(A=n(w,m)).done;){try{_=B(A.value)}catch(e){h(m,"throw",e)}if("object"==typeof _&&_&&c(v,_))return _}return new p(!1)}},function(e,t,i){var r=i(19),n=i(22),o=i(98);e.exports=function(e,t,i){var a,s;n(e);try{if(!(a=o(e,"return"))){if("throw"===t)throw i;return i}a=r(a,e)}catch(e){s=!0,a=e}if("throw"===t)throw i;if(s)throw a;return n(a),i}},function(e,t,i){var r=i(102),n=i(193),o=i(103).CONSTRUCTOR;e.exports=o||!n((function(e){r.all(e).then(void 0,(function(){}))}))},function(e,t,i){var r=i(15)("iterator"),n=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){n=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!n)return!1;var i=!1;try{var o={};o[r]=function(){return{next:function(){return{done:i=!0}}}},e(o)}catch(e){}return i}},function(e,t,i){var r=i(20),n=i(180),o=i(29),a=i(22),s=i(37),u=i(129);t.f=r&&!n?Object.defineProperties:function(e,t){a(e);for(var i,r=s(t),n=u(t),c=n.length,l=0;c>l;)o.f(e,i=n[l++],r[i]);return e}},function(e,t,i){var r=i(15);t.f=r},function(e,t,i){var r=i(6);e.exports=r},function(e,t,i){var r=i(19),n=i(30),o=i(15),a=i(27);e.exports=function(){var e=n("Symbol"),t=e&&e.prototype,i=t&&t.valueOf,s=o("toPrimitive");t&&!t[s]&&a(t,s,(function(e){return r(i,this)}),{arity:1})}},function(e,t,i){var r=i(87);e.exports=r&&!!Symbol.for&&!!Symbol.keyFor},function(e,t,i){"use strict";var r=i(1),n=i(19),o=i(32),a=i(90),s=i(16),u=i(200),c=i(109),l=i(83),f=i(38),h=i(44),d=i(27),p=i(15),v=i(105),m=i(201),y=a.PROPER,g=a.CONFIGURABLE,b=m.IteratorPrototype,_=m.BUGGY_SAFARI_ITERATORS,w=p("iterator"),A=function(){return this};e.exports=function(e,t,i,a,p,m,S){u(i,t,a);var k,C,T,P=function(e){if(e===p&&R)return R;if(!_&&e in B)return B[e];switch(e){case"keys":case"values":case"entries":return function(){return new i(this,e)}}return function(){return new i(this)}},x=t+" Iterator",E=!1,B=e.prototype,M=B[w]||B["@@iterator"]||p&&B[p],R=!_&&M||P(p),I="Array"==t&&B.entries||M;if(I&&(k=c(I.call(new e)))!==Object.prototype&&k.next&&(o||c(k)===b||(l?l(k,b):s(k[w])||d(k,w,A)),f(k,x,!0,!0),o&&(v[x]=A)),y&&"values"==p&&M&&"values"!==M.name&&(!o&&g?h(B,"name","values"):(E=!0,R=function(){return n(M,this)})),p)if(C={values:P("values"),keys:m?R:P("keys"),entries:P("entries")},S)for(T in C)!_&&!E&&T in B||d(B,T,C[T]);else r({target:t,proto:!0,forced:_||E},C);return o&&!S||B[w]===R||d(B,w,R,{name:p}),v[t]=R,C}},function(e,t,i){"use strict";var r=i(201).IteratorPrototype,n=i(47),o=i(81),a=i(38),s=i(105),u=function(){return this};e.exports=function(e,t,i,c){var l=t+" Iterator";return e.prototype=n(r,{next:o(+!c,i)}),a(e,l,!1,!0),s[l]=u,e}},function(e,t,i){"use strict";var r,n,o,a=i(3),s=i(16),u=i(23),c=i(47),l=i(109),f=i(27),h=i(15),d=i(32),p=h("iterator"),v=!1;[].keys&&("next"in(o=[].keys())?(n=l(l(o)))!==Object.prototype&&(r=n):v=!0),!u(r)||a((function(){var e={};return r[p].call(e)!==e}))?r={}:d&&(r=c(r)),s(r[p])||f(r,p,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:v}},function(e,t,i){var r=i(3);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t){e.exports=function(e,t){return{value:e,done:t}}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,i){var r=i(120)("span").classList,n=r&&r.constructor&&r.constructor.prototype;e.exports=n===Object.prototype?void 0:n},function(e,t,i){var r=i(15),n=i(47),o=i(29).f,a=r("unscopables"),s=Array.prototype;null==s[a]&&o(s,a,{configurable:!0,value:n(null)}),e.exports=function(e){s[a][e]=!0}},function(e,t,i){"use strict";var r=i(36).forEach,n=i(100)("forEach");e.exports=n?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},function(e,t,i){var r=i(27);e.exports=function(e,t,i){for(var n in t)r(e,n,t[n],i);return e}},function(e,t,i){var r=i(35),n=i(45),o=RangeError;e.exports=function(e){if(void 0===e)return 0;var t=r(e),i=n(t);if(t!==i)throw o("Wrong length or index");return i}},function(e,t,i){"use strict";var r=i(25),n=i(75),o=i(28);e.exports=function(e){for(var t=r(this),i=o(t),a=arguments.length,s=n(a>1?arguments[1]:void 0,i),u=a>2?arguments[2]:void 0,c=void 0===u?i:n(u,i);c>s;)t[s++]=e;return t}},function(e,t,i){var r=i(282),n=RangeError;e.exports=function(e,t){var i=r(e);if(i%t)throw n("Wrong offset");return i}},function(e,t,i){var r=i(144),n=TypeError;e.exports=function(e){var t=r(e,"number");if("number"==typeof t)throw n("Can't convert number to bigint");return BigInt(t)}},function(e,t,i){var r=i(16),n=i(23),o=i(83);e.exports=function(e,t,i){var a,s;return o&&r(a=t.constructor)&&a!==i&&n(s=a.prototype)&&s!==i.prototype&&o(e,s),e}},function(e,t,i){var r=i(31),n=i(25),o=i(96),a=i(28),s=TypeError,u=function(e){return function(t,i,u,c){r(i);var l=n(t),f=o(l),h=a(l),d=e?h-1:0,p=e?-1:1;if(u<2)for(;;){if(d in f){c=f[d],d+=p;break}if(d+=p,e?d<0:h<=d)throw s("Reduce of empty array with no initial value")}for(;e?d>=0:h>d;d+=p)d in f&&(c=i(c,f[d],d,l));return c}};e.exports={left:u(!1),right:u(!0)}},function(e,t,i){var r=i(74).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},function(e,t,i){var r=i(74);e.exports=/MSIE|Trident/.test(r)},function(e,t,i){var r=i(74).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},function(e,t){var i=TypeError;e.exports=function(e){if(e>9007199254740991)throw i("Maximum allowed index exceeded");return e}},function(e,t,i){"use strict";var r=i(20),n=i(5),o=i(19),a=i(3),s=i(129),u=i(123),c=i(143),l=i(25),f=i(96),h=Object.assign,d=Object.defineProperty,p=n([].concat);e.exports=!h||a((function(){if(r&&1!==h({b:1},h(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},i=Symbol();return e[i]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=h({},e)[i]||"abcdefghijklmnopqrst"!=s(h({},t)).join("")}))?function(e,t){for(var i=l(e),n=arguments.length,a=1,h=u.f,d=c.f;n>a;)for(var v,m=f(arguments[a++]),y=h?p(s(m),h(m)):s(m),g=y.length,b=0;g>b;)v=y[b++],r&&!o(d,m,v)||(i[v]=m[v]);return i}:h},function(e,t,i){"use strict";var r,n=i(6),o=i(76),a=i(16),s=i(297),u=i(74),c=i(84),l=i(127),f=n.Function,h=/MSIE .\./.test(u)||s&&((r=n.Bun.version.split(".")).length<3||0==r[0]&&(r[1]<3||3==r[1]&&0==r[2]));e.exports=function(e,t){var i=t?2:1;return h?function(r,n){var s=l(arguments.length,1)>i,u=a(r)?r:f(r),h=s?c(arguments,i):[],d=s?function(){o(u,this,h)}:u;return t?e(d,n):e(d)}:e}},function(e,t,i){"use strict";var r=i(1),n=i(99).includes,o=i(3),a=i(206);r({target:"Array",proto:!0,forced:o((function(){return!Array(1).includes()}))},{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},function(e,t,i){"use strict";var r=i(1),n=i(5),o=i(35),a=i(223),s=i(301),u=i(3),c=RangeError,l=String,f=Math.floor,h=n(s),d=n("".slice),p=n(1..toFixed),v=function(e,t,i){return 0===t?i:t%2==1?v(e,t-1,i*e):v(e*e,t/2,i)},m=function(e,t,i){for(var r=-1,n=i;++r<6;)n+=t*e[r],e[r]=n%1e7,n=f(n/1e7)},y=function(e,t){for(var i=6,r=0;--i>=0;)r+=e[i],e[i]=f(r/t),r=r%t*1e7},g=function(e){for(var t=6,i="";--t>=0;)if(""!==i||0===t||0!==e[t]){var r=l(e[t]);i=""===i?r:i+h("0",7-r.length)+r}return i};r({target:"Number",proto:!0,forced:u((function(){return"0.000"!==p(8e-5,3)||"1"!==p(.9,0)||"1.25"!==p(1.255,2)||"1000000000000000128"!==p(0xde0b6b3a7640080,0)}))||!u((function(){p({})}))},{toFixed:function(e){var t,i,r,n,s=a(this),u=o(e),f=[0,0,0,0,0,0],p="",b="0";if(u<0||u>20)throw c("Incorrect fraction digits");if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return l(s);if(s<0&&(p="-",s=-s),s>1e-21)if(i=(t=function(e){for(var t=0,i=e;i>=4096;)t+=12,i/=4096;for(;i>=2;)t+=1,i/=2;return t}(s*v(2,69,1))-69)<0?s*v(2,-t,1):s/v(2,t,1),i*=4503599627370496,(t=52-t)>0){for(m(f,0,i),r=u;r>=7;)m(f,1e7,0),r-=7;for(m(f,v(10,r,1),0),r=t-1;r>=23;)y(f,1<<23),r-=23;y(f,1<<r),m(f,1,1),y(f,2),b=g(f)}else m(f,0,i),m(f,1<<-t,0),b=g(f)+h("0",u);return u>0?p+((n=b.length)<=u?"0."+h("0",u-n)+b:d(b,0,n-u)+"."+d(b,n-u)):p+b}})},function(e,t,i){var r=i(5);e.exports=r(1..valueOf)},function(e,t,i){"use strict";var r=i(5),n=i(31),o=i(23),a=i(21),s=i(84),u=i(95),c=Function,l=r([].concat),f=r([].join),h={};e.exports=u?c.bind:function(e){var t=n(this),i=t.prototype,r=s(arguments,1),u=function(){var i=l(r,s(arguments));return this instanceof u?function(e,t,i){if(!a(h,t)){for(var r=[],n=0;n<t;n++)r[n]="a["+n+"]";h[t]=c("C,a","return new C("+f(r,",")+")")}return h[t](e,i)}(t,i.length,i):t.apply(e,i)};return o(i)&&(u.prototype=i),u}},function(e,t,i){var r=i(3),n=i(15),o=i(20),a=i(32),s=n("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,i=new URLSearchParams("a=1&a=2"),r="";return e.pathname="c%20d",t.forEach((function(e,i){t.delete("b"),r+=i+e})),i.delete("a",2),a&&(!e.toJSON||!i.has("a",1)||i.has("a",2))||!t.size&&(a||!o)||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[s]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://Ñ‚ÐµÑÑ‚").host||"#%D0%B1"!==new URL("http://a#Ð±").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host}))},function(e,t,i){"use strict";i(2);var r=i(1),n=i(6),o=i(19),a=i(5),s=i(20),u=i(225),c=i(27),l=i(39),f=i(208),h=i(38),d=i(200),p=i(34),v=i(101),m=i(16),y=i(21),g=i(77),b=i(46),_=i(22),w=i(23),A=i(24),S=i(47),k=i(81),C=i(128),T=i(106),P=i(127),x=i(15),E=i(168),B=x("iterator"),M=p.set,R=p.getterFor("URLSearchParams"),I=p.getterFor("URLSearchParamsIterator"),F=Object.getOwnPropertyDescriptor,L=function(e){if(!s)return n[e];var t=F(n,e);return t&&t.value},O=L("fetch"),j=L("Request"),D=L("Headers"),V=j&&j.prototype,U=D&&D.prototype,N=n.RegExp,W=n.TypeError,H=n.decodeURIComponent,z=n.encodeURIComponent,q=a("".charAt),G=a([].join),Q=a([].push),Y=a("".replace),K=a([].shift),J=a([].splice),X=a("".split),Z=a("".slice),$=/\+/g,ee=Array(4),te=function(e){return ee[e-1]||(ee[e-1]=N("((?:%[\\da-f]{2}){"+e+"})","gi"))},ie=function(e){try{return H(e)}catch(t){return e}},re=function(e){var t=Y(e,$," "),i=4;try{return H(t)}catch(e){for(;i;)t=Y(t,te(i--),ie);return t}},ne=/[!'()~]|%20/g,oe={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ae=function(e){return oe[e]},se=function(e){return Y(z(e),ne,ae)},ue=d((function(e,t){M(this,{type:"URLSearchParamsIterator",iterator:C(R(e).entries),kind:t})}),"Iterator",(function(){var e=I(this),t=e.kind,i=e.iterator.next(),r=i.value;return i.done||(i.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),i}),!0),ce=function(e){this.entries=[],this.url=null,void 0!==e&&(w(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===q(e,0)?Z(e,1):e:A(e)))};ce.prototype={type:"URLSearchParams",bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,i,r,n,a,s,u,c=T(e);if(c)for(i=(t=C(e,c)).next;!(r=o(i,t)).done;){if(a=(n=C(_(r.value))).next,(s=o(a,n)).done||(u=o(a,n)).done||!o(a,n).done)throw W("Expected sequence with length 2");Q(this.entries,{key:A(s.value),value:A(u.value)})}else for(var l in e)y(e,l)&&Q(this.entries,{key:l,value:A(e[l])})},parseQuery:function(e){if(e)for(var t,i,r=X(e,"&"),n=0;n<r.length;)(t=r[n++]).length&&(i=X(t,"="),Q(this.entries,{key:re(K(i)),value:re(G(i,"="))}))},serialize:function(){for(var e,t=this.entries,i=[],r=0;r<t.length;)e=t[r++],Q(i,se(e.key)+"="+se(e.value));return G(i,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var le=function(){v(this,fe);var e=arguments.length>0?arguments[0]:void 0,t=M(this,new ce(e));s||(this.size=t.entries.length)},fe=le.prototype;if(f(fe,{append:function(e,t){var i=R(this);P(arguments.length,2),Q(i.entries,{key:A(e),value:A(t)}),s||this.length++,i.updateURL()},delete:function(e){for(var t=R(this),i=P(arguments.length,1),r=t.entries,n=A(e),o=i<2?void 0:arguments[1],a=void 0===o?o:A(o),u=0;u<r.length;){var c=r[u];if(c.key!==n||void 0!==a&&c.value!==a)u++;else if(J(r,u,1),void 0!==a)break}s||(this.size=r.length),t.updateURL()},get:function(e){var t=R(this).entries;P(arguments.length,1);for(var i=A(e),r=0;r<t.length;r++)if(t[r].key===i)return t[r].value;return null},getAll:function(e){var t=R(this).entries;P(arguments.length,1);for(var i=A(e),r=[],n=0;n<t.length;n++)t[n].key===i&&Q(r,t[n].value);return r},has:function(e){for(var t=R(this).entries,i=P(arguments.length,1),r=A(e),n=i<2?void 0:arguments[1],o=void 0===n?n:A(n),a=0;a<t.length;){var s=t[a++];if(s.key===r&&(void 0===o||s.value===o))return!0}return!1},set:function(e,t){var i=R(this);P(arguments.length,1);for(var r,n=i.entries,o=!1,a=A(e),u=A(t),c=0;c<n.length;c++)(r=n[c]).key===a&&(o?J(n,c--,1):(o=!0,r.value=u));o||Q(n,{key:a,value:u}),s||(this.size=n.length),i.updateURL()},sort:function(){var e=R(this);E(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,i=R(this).entries,r=g(e,arguments.length>1?arguments[1]:void 0),n=0;n<i.length;)r((t=i[n++]).value,t.key,this)},keys:function(){return new ue(this,"keys")},values:function(){return new ue(this,"values")},entries:function(){return new ue(this,"entries")}},{enumerable:!0}),c(fe,B,fe.entries,{name:"entries"}),c(fe,"toString",(function(){return R(this).serialize()}),{enumerable:!0}),s&&l(fe,"size",{get:function(){return R(this).entries.length},configurable:!0,enumerable:!0}),h(le,"URLSearchParams"),r({global:!0,constructor:!0,forced:!u},{URLSearchParams:le}),!u&&m(D)){var he=a(U.has),de=a(U.set),pe=function(e){if(w(e)){var t,i=e.body;if("URLSearchParams"===b(i))return t=e.headers?new D(e.headers):new D,he(t,"content-type")||de(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),S(e,{body:k(0,A(i)),headers:k(0,t)})}return e};if(m(O)&&r({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return O(e,arguments.length>1?pe(arguments[1]):{})}}),m(j)){var ve=function(e){return v(this,V),new j(e,arguments.length>1?pe(arguments[1]):{})};V.constructor=ve,ve.prototype=V,r({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:ve})}}e.exports={URLSearchParams:le,getState:R}},function(e,t,i){"use strict";var r=i(1),n=i(5),o=i(31),a=i(25),s=i(28),u=i(167),c=i(24),l=i(3),f=i(168),h=i(100),d=i(215),p=i(216),v=i(88),m=i(217),y=[],g=n(y.sort),b=n(y.push),_=l((function(){y.sort(void 0)})),w=l((function(){y.sort(null)})),A=h("sort"),S=!l((function(){if(v)return v<70;if(!(d&&d>3)){if(p)return!0;if(m)return m<603;var e,t,i,r,n="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(r=0;r<47;r++)y.push({k:t+r,v:i})}for(y.sort((function(e,t){return t.v-e.v})),r=0;r<y.length;r++)t=y[r].k.charAt(0),n.charAt(n.length-1)!==t&&(n+=t);return"DGBEFHACIJK"!==n}}));r({target:"Array",proto:!0,forced:_||!w||!A||!S},{sort:function(e){void 0!==e&&o(e);var t=a(this);if(S)return void 0===e?g(t):g(t,e);var i,r,n=[],l=s(t);for(r=0;r<l;r++)r in t&&b(n,t[r]);for(f(n,function(e){return function(t,i){return void 0===i?-1:void 0===t?1:void 0!==e?+e(t,i)||0:c(t)>c(i)?1:-1}}(e)),i=s(n),r=0;r<i;)t[r]=n[r++];for(;r<l;)u(t,r++);return t}})},function(e,t,i){var r=i(1),n=i(5),o=Date,a=n(o.prototype.getTime);r({target:"Date",stat:!0},{now:function(){return a(new o)}})},function(e,t,i){"use strict";i(172);var r=i(92),n=i(27),o=i(173),a=i(3),s=i(15),u=i(44),c=s("species"),l=RegExp.prototype;e.exports=function(e,t,i,f){var h=s(e),d=!a((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),p=d&&!a((function(){var t=!1,i=/a/;return"split"===e&&((i={}).constructor={},i.constructor[c]=function(){return i},i.flags="",i[h]=/./[h]),i.exec=function(){return t=!0,null},i[h](""),!t}));if(!d||!p||i){var v=r(/./[h]),m=t(h,""[e],(function(e,t,i,n,a){var s=r(e),u=t.exec;return u===o||u===l.exec?d&&!a?{done:!0,value:v(t,i,n)}:{done:!0,value:s(i,t,n)}:{done:!1}}));n(String.prototype,e,m[0]),n(l,h,m[1])}f&&u(l[h],"sham",!0)}},function(e,t,i){"use strict";var r=i(157).charAt;e.exports=function(e,t,i){return t+(i?r(e,t).length:1)}},function(e,t,i){var r=i(19),n=i(22),o=i(16),a=i(42),s=i(173),u=TypeError;e.exports=function(e,t){var i=e.exec;if(o(i)){var c=r(i,e,t);return null!==c&&n(c),c}if("RegExp"===a(e))return r(s,e,t);throw u("RegExp#exec called on incompatible receiver")}},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(12),i(13),i(9),i(10),i(4),i(14);var r,n=(r=i(18))&&r.__esModule?r:{default:r};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===o(n=function(e,t){if("object"!==o(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}t.default=function(e){var t=n.default.create(e,"RingBuffer"),i=function(){function e(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i<=0&&t.error("invalid size in constructor "+i),this.buffer=[],this.size=i,this.start=0}var i,r;return i=e,(r=[{key:"push",value:function(e){this.buffer.length==this.size?(this.buffer[this.start++]=e,this.start==this.size&&(this.start=0)):this.buffer.push(e)}},{key:"get",value:function(e){var i;if(e>=0&&e<this.buffer.length){var r=this.start+e;r>=this.buffer.length&&(r-=this.buffer.length),i=this.buffer[r]}else if(e<0&&-1*e<=this.buffer.length){var n=this.start+e;n<0&&(n+=this.buffer.length),i=this.buffer[n]}else t.error("attempt to read from invalid index "+e);return i}},{key:"join",value:function(e){var t="";this.buffer.length>0&&(t+=this.buffer[this.start]);for(var i=1;i<this.buffer.length;i++){var r=this.start+i;r>=this.buffer.length&&(r-=this.buffer.length),t+=e+this.buffer[r]}return t}},{key:"mean",value:function(){for(var e=0,t=0;t<this.buffer.length;t++)e+=this.buffer[t];return 0===e?e:e/this.buffer.length}},{key:"clear",value:function(){this.buffer=[],this.start=0}},{key:"drop",value:function(){this.buffer=[],this.size=0,this.start=0}},{key:"length",value:function(){return this.buffer.length}}])&&a(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),e}();return{create:function(e){return new i(e)}}}},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(12),i(13),i(9),i(10),i(4),i(14);var r=i(33),n=a(i(18)),o=a(i(117));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===s(n=function(e,t){if("object"!==s(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t,this._logger=n.default.create(t,"AudioGraphController")}var t,i;return t=e,(i=[{key:"init",value:function(e,t){this._audioCtx||(this._audioCtx=o.default.getInstance(this._id).get(),this._source=this._audioCtx.createMediaElementSource(e),this._logger.debug("init media element, channels = ".concat(t)),this._source.channelCount=t,this._source.connect(this._audioCtx.destination))}},{key:"addMediaSourceChain",value:function(e,t){if(!this._mediaSourceChain){var i,r,n=[this._audioCtx.destination];for(this._vumeterChain&&(n=this._vumeterChain[0]),i=0;i<n.length;i++)this._source.disconnect("dest"===n[i]?this._audioCtx.destination:n[i]);for(i=0;i<e.length;i++)this._source.connect(e[i]);for(i=0;i<t.length;i++)for(r=0;r<n.length;r++)t[i].connect("dest"===n[r]?this._audioCtx.destination:n[r]);this._mediaSourceChain=[e,t]}}},{key:"removeMediaSourceChain",value:function(){if(this._mediaSourceChain){var e,t,i=[this._audioCtx.destination];this._vumeterChain&&(i=this._vumeterChain[0]);var r=this._mediaSourceChain[0];for(e=0;e<r.length;e++)this._source.disconnect(r[e]);var n=this._mediaSourceChain[1];for(e=0;e<n.length;e++)for(t=0;t<i.length;t++)n[e].disconnect("dest"===i[t]?this._audioCtx.destination:i[t]);for(e=0;e<i.length;e++)this._source.connect("dest"===i[e]?this._audioCtx.destination:i[e]);this._mediaSourceChain=void 0}}},{key:"addVumeterChain",value:function(e,t){if(!this._vumeterChain){var i,r,n=[this._source];if(this._mediaSourceChain){var o=this._mediaSourceChain[1];for(i=0;i<o.length;i++)o[i].disconnect(this._audioCtx.destination);n=o}else this._source.disconnect(this._audioCtx.destination);for(i=0;i<n.length;i++)for(r=0;r<e.length;r++)n[i].connect("dest"===e[r]?this._audioCtx.destination:e[r]);for(i=0;i<t.length;i++)t[i].connect(this._audioCtx.destination);this._vumeterChain=[e,t]}}},{key:"removeVumeterChain",value:function(){if(this._vumeterChain){var e,t,i=[this._source];this._mediaSourceChain&&(i=this._mediaSourceChain[1]);var r=this._vumeterChain[0];for(e=0;e<i.length;e++){for(t=0;t<r.length;t++)i[e].disconnect(r[t]);i[e].connect(this._audioCtx.destination)}var n=this._vumeterChain[1];for(e=0;e<n.length;e++)n[e].disconnect(this._audioCtx.destination);this._vumeterChain=void 0}}}])&&u(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),l=(0,r.multiInstanceHolder)(c);t.default=l},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(26),i(2),i(48),i(4),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(68),i(69),i(70),i(71),i(72),i(174),i(41),i(8);var r=o(i(319)),n=o(i(18));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=n.default.create(e,"BoxComposer");function i(e){var i=[],n=1,o=[],a=!!e.fragmentFullGop;function s(e,i){switch(e.codecData=i.codecData,e.type){case"video":!function(e,i){var r=i.codec.substring(0,4);switch(r){case"AVC1":case"AVC2":case"HVC1":case"HEV1":case"AV01":e.codec=r;break;default:t.error("Unknown video codec "+i.codec+". Trying to substitute with AVC1"),e.codec="AVC1"}}(e,i);break;case"audio":!function(e,i){switch(i.codec){case"MP4A.40.34":e.codec="MP3",function(e){if(e.codecData){var i=e.codecData;if(255==(255&i[0])&&224==(224&i[1])){var r=i[1]>>3&3;1==r&&(r=0);var n=i[1]>>1&3;if(0!=n){e.samplesPerFrame=[[0,576,1152,384],[0,0,0,0],[0,576,1152,384],[0,1152,1152,384]][r][n];var o=i[2]>>4&21;e.bitrate=[[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,8192,8192,32768],[0,0,0,0],[0,8192,8192,32768],[0,32768,32768,32768]],[[0,16384,16384,49152],[0,0,0,0],[0,16384,16384,49152],[0,40960,49152,65536]],[[0,24576,24576,57344],[0,0,0,0],[0,24576,24576,57344],[0,49152,57344,98304]],[[0,32768,32768,65536],[0,0,0,0],[0,32768,32768,65536],[0,57344,65536,131072]],[[0,40960,40960,81920],[0,0,0,0],[0,40960,40960,81920],[0,65536,81920,163840]],[[0,49152,49152,98304],[0,0,0,0],[0,49152,49152,98304],[0,81920,98304,196608]],[[0,57344,57344,114688],[0,0,0,0],[0,57344,57344,114688],[0,98304,114688,229376]],[[0,65536,65536,131072],[0,0,0,0],[0,65536,65536,131072],[0,114688,131072,262144]],[[0,81920,81920,147456],[0,0,0,0],[0,81920,81920,147456],[0,131072,163840,294912]],[[0,98304,98304,163840],[0,0,0,0],[0,98304,98304,163840],[0,163840,196608,327680]],[[0,114688,114688,180224],[0,0,0,0],[0,114688,114688,180224],[0,196608,229376,360448]],[[0,131072,131072,196608],[0,0,0,0],[0,131072,131072,196608],[0,229376,262144,393216]],[[0,147456,147456,229376],[0,0,0,0],[0,147456,147456,229376],[0,262144,327680,425984]],[[0,163840,163840,262144],[0,0,0,0],[0,163840,163840,262144],[0,327680,393216,458752]],[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]][o][r][n];var a=i[2]>>2&3;e.samplingRate=[[11025,0,22050,44100],[12e3,0,24e3,48e3],[8e3,0,16e3,32e3],[0,0,0,0]][a][r];var s,u,c=i[3]>>6&3;switch(e.audioChannels=3==c?1:2,e.silence=void 0,e.audioChannels){case 2:switch(u=(s=[255,251,null,100,null,143,240,0,0,105,0,0,0,8,0,0,13,32,0,0,1,0,0,1,164,0,0,0,32,0,0,52,128,0,0,4]).length,e.samplingRate){case 48e3:s[2]=148,s[4]=81,u+=348;break;case 44100:s[2]=146,s[4]=64,u+=382;break;case 32e3:s[2]=120,s[4]=57,u+=396;break;default:return void t.error("sampling rate "+e.samplingRate+" is not supported")}break;case 1:switch(u=(s=[255,251,null,196,null,null,192,0,1,164,0,0,0,32,0,0,52,128,0,0,4]).length,e.samplingRate){case 48e3:s[2]=84,s[4]=170,s[5]=3,u+=171;break;case 44100:s[2]=82,s[4]=161,s[5]=131,u+=188;break;case 32e3:s[2]=56,s[4]=158,s[5]=3,u+=195;break;default:return void t.error("sampling rate "+e.samplingRate+" is not supported")}}if(u){e.silence=new Uint8Array(u);var l=0;for(l=0;l<s.length;l++)e.silence[l]=s[l];for(l=s.length;l<u;l++)e.silence[l]=85;t.debug("MP3 track codec data",e.samplingRate,e.samplesPerFrame,e.audioChannels)}}}}}(e);break;default:e.codec="AAC",function(e){if(e.codecData){var i,r=[1024,960],n=e.codecData,o=n[0]>>3;switch(i=31==o?n[1]>>1&15:(7&n[0])<<1|n[1]>>7,e.bitrate=0,15==i?31==o?(e.samplingRate=((1&n[1])<<7|n[2]>>1)<<16|((1&n[2])<<7|n[3]>>1)<<8|(1&n[3])<<7|n[4]>>1,e.audioChannels=(1&n[4])<<3|n[5]>>5,e.samplesPerFrame=r[(16&n[5])>>4]):(e.samplingRate=((127&n[1])<<1|n[2]>>7)<<16|((127&n[2])<<1|n[3]>>7)<<8|(127&n[3])<<1|n[4]>>7,e.audioChannels=(120&n[4])>>3,e.samplesPerFrame=r[(4&n[4])>>2]):(e.samplingRate=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][i],31==o?(e.audioChannels=(1&n[1])<<3|n[2]>>5,e.samplesPerFrame=r[(16&n[2])>>4]):(e.audioChannels=(120&n[1])>>3,e.samplesPerFrame=r[(4&n[1])>>2])),e.audioChannels){case 8:e.silence=new Uint8Array([1,24,32,1,8,128,35,4,96,35,16,4,96,140,4,162,0,140,17,129,132,96,0,28]);break;case 6:e.silence=new Uint8Array([1,24,32,1,8,128,35,4,96,35,16,4,96,140,12,35,0,0,224]);break;case 5:e.silence=new Uint8Array([1,24,32,1,8,128,35,4,96,35,16,4,96,140,28]);break;case 4:e.silence=new Uint8Array([1,24,32,1,8,128,35,4,96,3,24,32,7]);break;case 3:e.silence=new Uint8Array([1,24,32,1,8,128,35,4,96,224]);break;case 2:e.silence=new Uint8Array([33,16,4,96,140,28]);break;default:e.silence=new Uint8Array([1,24,32,7])}t.debug("AAC track codec data, AOT: "+o+" sRate: "+e.samplingRate+" sPerFrame: "+e.samplesPerFrame+" chCount: "+e.audioChannels)}}(e)}e.tsPerFrame=e.samplesPerFrame/e.samplingRate*e.timescale}(e,i)}}function u(e,i,r){var n=r.prevSamplCntTs+i.samplesPerFrame,o=r.nextSamplCntTs-n;if(o>=i.samplesPerFrame&&o<=10*i.samplingRate){t.debug("recover audio gap effShift = ".concat(o,", prevTs = ").concat(r.prevTs,", prevSamplCntTs = ").concat(r.prevSamplCntTs,", nextSamplCntTs = ").concat(r.nextSamplCntTs));for(var a=Math.floor(o/i.samplesPerFrame),s=r.prevTs,u=0;u<a;u++){s+=i.tsPerFrame;var c={data:r.data,sap:!0,ts:s,offset:0,samplCntTs:n,samplCntDur:i.samplesPerFrame};e.push(c),n+=i.samplesPerFrame}t.warn("adding dummy frames",e.length-1,n,r.nextSamplCntTs)}return n}function c(e,t){return t<0||t>10*e.timescale}function l(e,i,r){var n=!1;if(e.isAudio&&e.lastSilenceSampleTs>0&&null!==r){var o=e.lastSilenceSampleTs-i;o>=0?o<5*e.timescale&&(t.debug("Ignore real frames after mute",i,e.lastSilenceSampleTs),n=!0):e.lastSilenceSampleTs=0}return n}function f(e,i,r,n,s){if(l(e,n,r))return[];var f=[],h=!1,d=e.lastSample,p=n-d.rawts;c(e,p)?(t.debug("Incorrect DTS difference (".concat(p,") between previous (ts: ").concat(d.rawts,", offset: ").concat(d.offset,", sap: ").concat(d.sap,") and current frame (ts: ").concat(n,", offset: ").concat(s,", sap: ").concat(i,")")),p=e.lastSampleDuration):0!==p||e.isAudio||d.offset!==s?a&&!i&&(h=!0):(t.debug("Keep zero duration video sample"),h=!0);var v=n;if(n=d.ts+p,p>0&&(e.lastSampleDuration=p),d.duration=p,l(e,n,r))return[];e.isAudio&&e.alignBase&&(e.prevSample&&(u(f,e,{prevTs:e.prevSample.ts,prevSamplCntTs:e.prevSample.samplCntTs,nextSamplCntTs:d.samplCntTs,data:e.silence?e.silence:d.data}),e.prevSample=void 0),e.alignBase=void 0),f.push(d);var m=0;e.isAudio&&(m=u(f,e,{prevTs:d.ts,prevSamplCntTs:d.samplCntTs,nextSamplCntTs:e.sampleCountFromTs(n),data:e.silence?e.silence:d.data}),d.samplCntDur=e.samplesPerFrame);var y=r;if(null===y&&e.isAudio&&(y=e.silence,e.lastSilenceSampleTs=n),e.lastSample={data:y,sap:i,ts:n,rawts:v,offset:s,samplCntTs:m},h||o.length>0){for(var g=0;g<f.length;g++)o.push(f[g]);h?f=[]:(f=o,o=[])}return f}function h(e){for(var r,n=0;n<i.length;n++)if(i[n].id==e){r=i[n];break}return void 0===r&&t.error("track ID "+e+" is not found!"),r}function d(e,t){var i=r.default.createFullBox("tkhd",t);switch(i.flags=7,i.creation_time=0,i.modification_time=0,i.track_ID=e.id,i.reserved1=0,i.duration=0,i.reserved2=[0,0],i.layer=0,i.alternate_group=0,i.reserved3=0,i.matrix=[1,0,0,0,1,0,0,0,16384],e.type){case"video":i.volume=0,i.width=e.width,i.height=e.height,i.flags|=8;break;case"audio":i.volume=1,i.width=0,i.height=0}return i}function p(e){return e.isAudio?e.samplingRate:e.timescale}function v(e,t){var i=r.default.createFullBox("mdhd",t);return i.creation_time=0,i.modification_time=0,i.duration=0,i.language="und",i.pre_defined=0,i.timescale=p(e),i}function m(e,t){var i=r.default.createFullBox("hdlr",t);switch(i.pre_defined=0,e.type){case"video":i.handler_type="vide",i.name="VideoHandler";break;case"audio":i.handler_type="soun",i.name="AudioHandler"}return i.reserved=[0,0,0],i}function y(e){var t=r.default.createFullBox("vmhd",e);return t.flags=1,t.graphicsmode=0,t.opcolor=[0,0,0],t}function g(e){var t=r.default.createFullBox("smhd",e);return t.balance=0,t.reserved=0,t}function b(e){var t=r.default.createFullBox("dref",e);t.entry_count=1,t.entries=[];var i=r.default.createFullBox("url ",t,-1);return i.location="",i.flags=1,t.entries.push(i),t}function _(e,t){var i=r.default.createFullBox("trex",t);return i.track_ID=e.id,i.default_sample_description_index=1,i.default_sample_duration=0,i.default_sample_size=0,i.default_sample_flags=e.isAudio?0:65536,i}function w(e,i){var n=r.default.createFullBox("stsd",i);return n.entry_count=1,n.entries=[],n.entries.push(function(e,i){switch(e.codec){case"AVC1":case"AVC2":return e.seBox=e.codec.toLowerCase(),e.configName="avcC",e.compressorname="AVC Coding",A(e,i);case"HVC1":case"HEV1":return e.seBox=e.codec.toLowerCase(),e.configName="hvcC",e.compressorname="SHVC Coding",A(e,i);case"AV01":return e.seBox=e.codec.toLowerCase(),e.configName="av1C",e.compressorname="VideoHandler",A(e,i);case"AAC":return function(e,t){var i=r.default.createBox("mp4a",t,-1);return i.reserved1=[0,0,0,0,0,0],i.data_reference_index=1,i.reserved2=[0,0],i.channelcount=e.audioChannels,i.samplesize=16,i.pre_defined=0,i.reserved_3=0,i.samplerate=e.samplingRate<<16,i.esds="AAC"==e.codec?function(e){var t=37+e.codecData.byteLength,i=new Uint8Array(t),r=0;return i[r++]=(4278190080&t)>>24,i[r++]=(16711680&t)>>16,i[r++]=(65280&t)>>8,i[r++]=255&t,i.set([101,115,100,115],r),r+=4,i.set([0,0,0,0],r),r+=4,i[r++]=3,i[r++]=23+e.codecData.byteLength,i[r++]=(65280&e.id)>>8,i[r++]=255&e.id,i[r++]=0,i[r++]=4,i[r++]=15+e.codecData.byteLength,i[r++]=64,i[r]=20,i[r]|=0,i[r++]|=1,i[r++]=255,i[r++]=255,i[r++]=255,i.set([0,0,0,0,0,0,0,0],r),r+=8,i[r++]=5,i[r++]=e.codecData.byteLength,i.set(e.codecData,r),r+=e.codecData.byteLength,i[r++]=6,i[r++]=1,i[r]=2,i}(e):function(e){var t=new Uint8Array(35),i=0;return t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=35,t.set([101,115,100,115],i),i+=4,t.set([0,0,0,0],i),i+=4,t[i++]=3,t[i++]=21,t[i++]=(65280&e.id)>>8,t[i++]=255&e.id,t[i++]=0,t[i++]=4,t[i++]=13,t[i++]=107,t[i]=20,t[i]|=0,t[i++]|=1,t[i++]=255,t[i++]=255,t[i++]=255,t[i++]=(4278190080&e.bitrate)>>24,t[i++]=(16711680&e.bitrate)>>16,t[i++]=(65280&e.bitrate)>>8,t[i++]=255&e.bitrate,t[i++]=(4278190080&e.bitrate)>>24,t[i++]=(16711680&e.bitrate)>>16,t[i++]=(65280&e.bitrate)>>8,t[i++]=255&e.bitrate,t[i++]=6,t[i++]=1,t[i]=2,t}(e),i}(e,i);case"MP3":return function(e,t){var i=r.default.createBox(".mp3",t,-1);i.reserved1=[0,0,0,0,0,0],i.data_reference_index=1,i.reserved2=[0,0],i.channelcount=e.audioChannels,i.samplesize=16,i.pre_defined=0,i.reserved_3=0,i.samplerate=e.samplingRate<<16,i.entry_count=1,i.entries=[];var n=r.default.createBox("btrt",i,-1);return n.bufferSizeDB=4294967295,n.maxBitrate=e.bitrate,n.avgBitrate=e.bitrate,i.entries.push(n),i}(e,i);default:t.error("Unsupported codec: ",e.codec)}}(e,n)),n}function A(e,i){var n=r.default.createBox(e.seBox,i,-1);n.reserved1=[0,0,0,0,0,0],n.data_reference_index=1,n.pre_defined1=0,n.reserved2=0,n.pre_defined2=[0,0,0],n.width=e.width,n.height=e.height,n.horizresolution=72,n.vertresolution=72,n.reserved3=0,n.frame_count=1,n.compressorname=[e.compressorname.length];for(var o=0;o<31;o++)n.compressorname[o+1]=o<e.compressorname.length?127&e.compressorname.charCodeAt(o):0;return n.depth=24,n.pre_defined3=65535,n.config=function(e){if(e.codecData){var i=e.codecData.byteLength+8,r=new Uint8Array(i),n=0;r[n++]=(4278190080&i)>>24,r[n++]=(16711680&i)>>16,r[n++]=(65280&i)>>8,r[n++]=255&i;for(var o=0;o<e.configName.length;o++)r[n++]=127&e.configName.charCodeAt(o);return r.set(e.codecData,n),r}t.error("No codec data specified!")}(e),n}this.reset=function(){i=[],n=1,o=[]},this.free=function(){},this.isReady=function(){return!0},this.addTrack=function(e,r){var o={id:n,type:e,isAudio:"audio"==e,curSeqNumber:0,lastSampleDuration:0,lastSilenceSampleTs:0,sampleCountFromTs:function(e){return Math.floor(this.samplingRate/this.timescale*e+.5)}};return t.setPrefix("BoxComposer "+e),r&&("video"==e&&(o.width="width"in r?r.width:0,o.height="height"in r?r.height:0),o.timescale="timescale"in r?r.timescale:1e3,"codec"in r&&(r.codec=r.codec.toUpperCase()),"codecData"in r&&s(o,r)),i.push(o),n++,o},this.setTrackParams=function(e,i){var r=h(e);return r&&("codec"in i&&(i.codec=i.codec.toUpperCase()),"width"in i&&(r.width=i.width),"height"in i&&(r.height=i.height),"timescale"in i&&(r.timescale=i.timescale),"codecData"in i&&(o=[],r.lastSample=void 0,s(r,i)),"sequenceNumber"in i&&(r.curSeqNumber=i.sequenceNumber),"alignBase"in i&&(r.alignBase=i.alignBase),"syncBase"in i&&(r.syncBase=i.syncBase),t.debug("setTrackParams: ",e,i)),r},this.getTrackSampleDuration=function(e,t){var i,r=h(e);return r&&(i=r.tsPerFrame),i},this.getTrackAudioInfo=function(e){var t,i=h(e);return i&&(t={samplingRate:i.samplingRate,channels:i.audioChannels}),t},this.isTrackSilent=function(e){var t,i=h(e);return i&&i.isAudio&&(t=i.lastSilenceSampleTs>0),t},this.setBaseSample=function(e,i,r,n){var o=h(e);if(o){var a=r;if(o.syncBase){if(o.syncSample){var s=r-o.syncSample.rawts;c(s)&&(t.debug("setBaseSample discontinuity: "+s,r,o.syncSample.ts,o.syncSample.rawts,o.lastSampleDuration),s=o.lastSampleDuration),r=o.syncSample.ts+s,o.syncSample=void 0}o.syncBase=void 0}var u=i,l=0;o.isAudio&&(o.lastSilenceSampleTs=0,null===u&&(u=o.silence,o.lastSilenceSampleTs=r),l=o.sampleCountFromTs(r)),o.lastSample={data:u,sap:!0,ts:r,rawts:a,offset:n,samplCntTs:l,samplCntDur:o.samplesPerFrame},t.debug("setBaseSample: ",r,n,o.lastSample.samplCntTs,o.lastSample.samplCntDur)}else t.error("setBaseSample: track "+e+" not found!!!")},this.getRealTs=function(e,i){var r=i,n=h(e);if(n){if(n.lastSample){var o=n.lastSample.ts-n.lastSample.rawts;0!==o&&(o>0&&i<n.lastSample.ts||i>=n.lastSample.rawts)&&(r=i+o)}}else t.error("getRealTs: track ".concat(e," not found"));return r},this.initSegment=function(){var e=r.default.createFile();return function(e){var t=r.default.createBox("ftyp",e);t.major_brand="isom",t.minor_version=0,t.compatible_brands=[],t.compatible_brands[0]="isom",t.compatible_brands[1]="avc1",t.compatible_brands[2]="dash"}(e),function(e){var t=r.default.createBox("moov",e);!function(e){var t=r.default.createFullBox("mvhd",e);t.creation_time=0,t.modification_time=0,t.timescale=1e3,t.duration=0,t.rate=1,t.volume=1,t.reserved1=0,t.reserved2=[0,0],t.matrix=[1,0,0,0,1,0,0,0,16384],t.pre_defined=[0,0,0,0,0,0],t.next_track_ID=n}(t);var o=r.default.createBox("mvex",t);!function(e){r.default.createFullBox("mehd",e).fragment_duration=0}(o);for(var a=0;a<i.length;a++){var s=i[a],u=r.default.createBox("trak",t);d(s,u);var c=r.default.createBox("mdia",u);v(s,c),m(s,c);var l=r.default.createBox("minf",c);switch(s.type){case"video":y(l);break;case"audio":g(l)}b(r.default.createBox("dinf",l));var f=r.default.createBox("stbl",l);r.default.createFullBox("stts",f)._data=[0,0,0,0,0,0,0,0],r.default.createFullBox("stsc",f)._data=[0,0,0,0,0,0,0,0],r.default.createFullBox("stco",f)._data=[0,0,0,0,0,0,0,0],r.default.createFullBox("stsz",f)._data=[0,0,0,0,0,0,0,0,0,0,0,0],w(s,f),_(s,o)}}(e),e.write()},this.mediaSegment=function(e,i,n){var a,s=h(e),u=[],c=[];if(s){for(var l=[],d=0;d<i.length;d++)if(s.lastSample)for(var v=f(s,i[d].sap,i[d].data,i[d].ts,i[d].offset),m=0;m<v.length;m++)l.push(v[m]),u.push(v[m].ts),c.push(v[m].sap);else t.error("mediaSegment is executed while no base sample is set. Compelled setting of base sample: ",i[d].sap,i[d].ts,i[d].offset),i[d].sap&&this.setBaseSample(e,i[d].data,i[d].ts,i[d].offset);if(n&&void 0!==s.lastSample){for(var y=0;y<o.length;y++)l.push(o[y]),u.push(o[y].ts),c.push(o[y].sap);o=[],s.lastSample.duration=s.lastSampleDuration,t.debug("Push last sample, ts = ".concat(s.lastSample.ts,", duration = ").concat(s.lastSample.duration)),l.push(s.lastSample),u.push(s.lastSample.ts),c.push(s.lastSample.sap),s.alignBase&&(s.prevSample={ts:s.lastSample.ts,samplCntTs:s.lastSample.samplCntTs}),s.syncBase&&(s.syncSample={ts:s.lastSample.ts,rawts:s.lastSample.rawts}),s.lastSample=void 0}if(l.length>0){var g=r.default.createFile(),b=function(e,t,i){var n=r.default.createBox("sidx",e);n.flags=0,n.version=1,n.reference_ID=t.id,n.timescale=p(t),n.first_offset=0,n.reserved=0,n.earliest_presentation_time=t.isAudio?i[0].samplCntTs:i[0].ts+i[0].offset,n.reference_count=1;for(var o=!1,a=0,s=0,u=0,c=0,l=0;l<i.length;l++)a+=i[l].data.byteLength,!o&&i[l].sap&&(o=!0,c=s),s+=i[l].duration,u+=i[l].samplCntDur;return n.references=[{reference_type:0,referenced_size:a,subsegment_duration:t.isAudio?u:s,starts_with_SAP:i[0].sap?1:0,SAP_type:o?1:0,SAP_delta_time:c}],n}(g,s,l),_=function(e,t,i){var n=r.default.createBox("moof",e);r.default.createFullBox("mfhd",n).sequence_number=t.curSeqNumber++;var o=r.default.createBox("traf",n),a=r.default.createFullBox("tfhd",o);a.track_ID=t.id,a.flags=0;var s=r.default.createFullBox("tfdt",o,a);s.version=1,s.flags=0;var u=r.default.createFullBox("trun",o,s);if(u.sample_count=i.length,u.samples=[],t.isAudio){s.baseMediaDecodeTime=i[0].samplCntTs,u.flags=769;for(var c=0;c<i.length;c++)u.samples.push({sample_duration:i[c].samplCntDur,sample_size:i[c].data.byteLength})}else{s.baseMediaDecodeTime=i[0].ts,"av1C"===t.configName?u.flags=773:u.flags=2821,u.first_sample_flags=0;for(var l=0;l<i.length;l++)u.samples.push({sample_duration:i[l].duration,sample_size:i[l].data.byteLength,sample_composition_time_offset:i[l].offset})}return u.data_offset=n.getLength()+8,n}(g,s,l);r.default.createBox("mdat",g).data=function(e,t){var i;if(e.length>1){i=new Uint8Array(t);for(var r=0,n=0;n<e.length;n++)i.set(e[n].data,r),r+=e[n].data.length}else i=e[0].data;return i}(l,b.references[0].referenced_size),b.references[0].referenced_size+=8+_.getLength(),a={ts:u,sap:c,sn:s?s.curSeqNumber-1:void 0,data:g.write()}}}return a}}return{create:function(e){return new i(e)}}}},function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(118),i(9),i(10),i(4),i(11),i(2),i(7),i(8);var n={appendBox:function(e,t,i){if(t._root=e._root?e._root:e,t._parent=e,-1!==i)if(null!=i){var n,o=-1;if("number"==typeof i)o=i;else{if("string"==typeof i)n=i;else{if("object"!==r(i)||!i.type)return void e.boxes.push(t);n=i.type}for(var a=0;a<e.boxes.length;a++)if(n===e.boxes[a].type){o=a+1;break}}e.boxes.splice(o,0,t)}else e.boxes.push(t)}};t.default=n},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(26),i(175),i(41),i(40),i(12),i(13),i(9),i(10),i(4),i(14);var r=i(33),n=u(i(237)),o=u(i(239)),a=u(i(115)),s=u(i(18));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===c(n=function(e,t){if("object"!==c(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._captions={},this._renderer=n.default.getInstance(t),this._captionManager=o.default.getInstance(t),this._playbackService=a.default.getInstance(t),this._logger=s.default.create(t,"Caption Presenter")}var t,i;return t=e,(i=[{key:"start",value:function(){this._enabled||(this._enabled=!0,this._renderable&&(this._captions[this._activeCaptionId]=[],this._createDispatchTimer()))}},{key:"stop",value:function(){this._enabled=!1,this._dispatchTimer&&(clearTimeout(this._dispatchTimer),this._dispatchTimer=void 0)}},{key:"deinit",value:function(){this.stop(),this._captions={}}},{key:"setRenderable",value:function(e){this._renderable=e}},{key:"setCallback",value:function(e,t){"onCaptionsArrived"===e&&(this._onCaptionsArrived=t)}},{key:"setCaptionReportInterface",value:function(e){this._captionReport=e}},{key:"setActiveCaptionId",value:function(e){this._activeCaptionId!==e&&(this._activeCaptionId&&(this._captions[this._activeCaptionId]=[]),this._activeCaptionId=e,this._activeCaptionId?this._enabled||this.start():this.stop())}},{key:"activateCaptionTrack",value:function(e){this._captionReport.captionArrived(e)}},{key:"addCaptions",value:function(e,t,i){if(this._enabled&&e===this._activeCaptionId){var r=this._renderer.createCaptionRegionsFromScreen(i);if(this._onCaptionsArrived&&this._onCaptionsArrived(this._buildSdkCaptionsArrayFrom(r,t)),this._renderable){this._captions[e]||(this._captions[e]=[]);var n=this._renderer.createHTMLCaptionsFromRegions(r,t,-1);this._captions[e]=this._captions[e].concat(n),this._dispatchCaptions()}}}},{key:"updateCaptions",value:function(e,t,i,r,n){if(this._enabled&&this._renderable&&e===this._activeCaptionId){var o=this._captions[this._activeCaptionId];if(o&&0!==o.length){n&&this._onCaptionsArrived&&this._onCaptionsArrived(this._buildEmptySdkCaptionsArray(i));for(var a=0;a<o.length;a++)-1===o[a].end&&(o[a].start!==t&&this._logger.debug("Orphan caption detected",r.getDisplayText()),o[a].end=i)}}}},{key:"_buildSdkCaptionsArrayFrom",value:function(e,t){for(var i=[],r=0;r<e.length;r++){for(var n={time:t,x:e[r].x,y1:e[r].y1,y2:e[r].y2,regions:[]},o=0;o<e[r].p.length;o++){for(var a={spans:[]},s=e[r].p[o].spans,u=0;u<s.length;u++)a.spans.push({row:s[u].row,content:s[u].line.trim(),style:this._renderer.getRegionSpanStyle(s[u].name)});n.regions.push(a)}i.push(n)}return i}},{key:"_buildEmptySdkCaptionsArray",value:function(e){return[{time:e,x:0,y1:0,y2:0,regions:[]}]}},{key:"_createDispatchTimer",value:function(){var e=this;this._dispatchTimer=setTimeout((function(){this._dispatchTimer=void 0,e._enabled&&(e._dispatchCaptions(),e._createDispatchTimer())}),50)}},{key:"_dispatchCaptions",value:function(){var e=this._captions[this._activeCaptionId];if(e&&0!==e.length){for(var t=this._playbackService.getCurrentTime(),i=[],r=0;r<e.length;r++){if(t>=e[r].start&&!e[r].added)this._captionManager.addActiveCaption(e[r].capHTMLElement),e[r].added=!0;else if(-1!==e[r].end&&e[r].end<=t){e[r].added&&this._captionManager.removeActiveCaption(e[r].capHTMLElement);continue}i.push(e[r])}this._captions[this._activeCaptionId]=i}}}])&&l(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),h=(0,r.multiInstanceHolder)(f);t.default=h},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(79),i(26),i(175),i(238),i(41),i(172),i(331),i(12),i(13),i(9),i(10),i(4),i(14);var r=i(33),n=i(245);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===o(n=function(e,t){if("object"!==o(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._instanceId=t,this._captionId=0,this._nrRows=n.NR_ROWS,this._nrCols=n.NR_COLS}var t,i;return t=e,(i=[{key:"getDimensions",value:function(){return[this._nrRows,this._nrCols]}},{key:"createCaptionsWrapper",value:function(){var e=document.createElement("div");return e.className="sldp_text_tracks_wrp_"+this._instanceId,e.style.cssText=["position: absolute; display: flex;","pointer-events: none; overflow: hidden;","top: 10%; bottom: 10%; left: 0px;","width: 100%; line-height: 1.3em; z-index: 5;"].join(""),e}},{key:"createCaptionTrackWrapper",value:function(e){var t=document.createElement("div");return t.className="sldp_text_captions_wrp_".concat(this._instanceId,"_").concat(e),t.style.cssText=["position: absolute; overflow: hidden; pointer-events: none; visibility: visible;",'font-family: "Deja Vu Sans Mono", "Lucida Console", Monaco, Consolas, "PT Mono", monospace;',"width: 80%; height: 100%; left: 10%;"].join(""),t}},{key:"createCaptionRegionsFromScreen",value:function(e){var t,i=!1,r=-1,n={spans:[]},o="style_cea608_white_black";for(this._styleStates={},this._curRegion=null,this._regions=[],t=0;t<this._nrRows;t++){var a=e.rows[t];if(a.isEmpty())i=!1,r=-1,this._curRegion&&(this._appendCurrRegion(t-1,n),n={spans:[]},this._curRegion=null);else{var s=this._getIndent(a.chars);null===this._curRegion&&(this._curRegion={x:s,y1:t,y2:t,p:[]}),s!==r&&i&&(this._appendCurrRegion(t-1,n),n={spans:[]},this._curRegion={x:s,y1:t,y2:t,p:[]});for(var u="",c=void 0,l=0;l<a.chars.length;++l){var f=a.chars[l],h=f.penState;if(!c||!h.equals(c)){u.trim().length>0&&(n.spans.push({name:o,line:u,row:t}),u="");var d="style_cea608_"+h.foreground+"_"+h.background;h.underline&&(d+="_underline"),h.italics&&(d+="_italics"),this._styleStates[d]||(this._styleStates[d]=JSON.parse(JSON.stringify(h))),c=h,o=d}u+=f.uchar}u.trim().length>0&&n.spans.push({name:o,line:u,row:t}),i=!0,r=s}}return this._curRegion&&(this._appendCurrRegion(t-1,n),this._curRegion=null),this._regions}},{key:"createHTMLCaptionsFromRegions",value:function(e,t,i){for(var r=[],n=0;n<e.length;++n){var o=document.createElement("div");o.id="sub_cea608_"+this._captionId++;var a=this._getRegionProperties(e[n]);o.style.cssText=["position: absolute;","margin: 0;","display: flex;","box-sizing: border-box;","pointer-events: none;",a].join("");var s=document.createElement("div");s.className="caption-paragraph",s.style.cssText=this._getStyle();var u=document.createElement("div");u.className="cueUniWrapper",u.style.cssText="unicode-bidi: normal; direction: ltr;";for(var c=0;c<e[n].p.length;c++)for(var l=e[n].p[c],f=0,h=0;h<l.spans.length;h++){var d=l.spans[h];if(d.line.length>0){if(0!==h&&f!=d.row){var p=document.createElement("br");p.className="lineBreak",u.appendChild(p)}var v=!1;f===d.row&&(v=!0),f=d.row;var m=this._styleStates[d.name],y=document.createElement("span");y.className="caption-span "+d.name+" customSpanColor",y.style.cssText=this._getStyle(m),0!==h&&v?h===l.spans.length-1?y.textContent=this._rtrim(d.line):y.textContent=d.line:l.spans.length>1&&h<l.spans.length-1&&d.row===l.spans[h+1].row?y.textContent=this._ltrim(d.line):y.textContent=d.line.trim(),u.appendChild(y)}}s.appendChild(u),o.appendChild(s),r.push({start:t,end:i,capHTMLElement:o})}return r}},{key:"getRegionSpanStyle",value:function(e){return this._styleStates[e]||{}}},{key:"_appendCurrRegion",value:function(e,t){this._curRegion.p.push(t),this._curRegion.y2=e,this._curRegion.name="region_"+this._curRegion.x+"_"+this._curRegion.y1+"_"+this._curRegion.y2,this._regions.push(this._curRegion)}},{key:"_getIndent",value:function(e){for(var t=0,i=0;i<e.length&&/\s/.test(e[i].uchar);i++)t++;return t}},{key:"_getRegionProperties",value:function(e){return["left: ".concat(3.125*e.x,"%;"),"top: ".concat(6.66*e.y1,"%;"),"width: ".concat(100-3.125*e.x,"%;"),"height: ".concat(6.66*(e.y2-e.y1+1),"%;"),"align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;","letter-spacing: calc(1em - 1ch)"].join("")}},{key:"_createRGB",value:function(e){switch(e){case"red":e="rgb(255, 0, 0)";break;case"green":e="rgb(0, 255, 0)";break;case"blue":e="rgb(0, 0, 255)";break;case"cyan":e="rgb(0, 255, 255)";break;case"magenta":e="rgb(255, 0, 255)";break;case"yellow":e="rgb(255, 255, 0)";break;case"white":e="rgb(255, 255, 255)";break;case"black":e="rgb(0, 0, 0)"}return e}},{key:"_getStyle",value:function(e){var t;return e?(t=["color: ".concat(e.foreground?this._createRGB(e.foreground):"rgb(255, 255, 255)",";"),"font-style: ".concat(e.italics?"italic":"normal",";"),"text-decoration: ".concat(e.underline?"underline":"none",";"),"background-color: ".concat(e.background?this._createRGB(e.background):"transparent",";")],e.flash&&(t=t.concat(["animation-name: flasher;","animation-duration: 1s;","animation-timing-function: linear;","animation-iteration-count: infinite;"]))):t=["color: rgb(255, 255, 255); justify-content: flex-start; text-align: left;","font-style: normal; line-height: normal; font-weight: normal;","text-decoration: none; width: 100%; display: flex;"],t.join("")}},{key:"_ltrim",value:function(e){return e.replace(/^\s+/g,"")}},{key:"_rtrim",value:function(e){return e.replace(/\s+$/g,"")}}])&&a(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),u=(0,r.multiInstanceHolder)(s);t.default=u},function(e,t,i){var r=i(1),n=i(25),o=i(129);r({target:"Object",stat:!0,forced:i(3)((function(){o(1)}))},{keys:function(e){return o(n(e))}})},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(12),i(13),i(9),i(10),i(4),i(14);var r,n=i(33),o=(r=i(237))&&r.__esModule?r:{default:r};function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===a(n=function(e,t){if("object"!==a(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._instanceId=t,this._captions={},this._captionRenderer=o.default.getInstance(t)}var t,i;return t=e,(i=[{key:"init",value:function(e){var t=this;e&&!this._captionsWrp&&(this._captionsWrp=this._captionRenderer.createCaptionsWrapper(),e.appendChild(this._captionsWrp),this._container=e,this._resizeObserver=new ResizeObserver((function(){t._setCaptionsFontSize()})),this._resizeObserver.observe(this._captionsWrp))}},{key:"setCaptionTrack",value:function(e){this._clearActiveCaptions(!0),this._container&&e&&(this._captions[e]?this._captions[e].style.visibility="visible":(this._captions[e]=this._captionRenderer.createCaptionTrackWrapper(e),this._captionsWrp.appendChild(this._captions[e]))),this._activeCaptionId=e,this._setCaptionsFontSize()}},{key:"clear",value:function(){this._clearActiveCaptions()}},{key:"deinit",value:function(){this._container&&(this._resizeObserver.unobserve(this._captionsWrp),this._container.removeChild(this._captionsWrp),this._captionsWrp=void 0,this._container=void 0,this._clearActiveCaptions(!0),this._captions={})}},{key:"addActiveCaption",value:function(e){this._captions[this._activeCaptionId].appendChild(e)}},{key:"removeActiveCaption",value:function(e){this._captions[this._activeCaptionId].removeChild(e)}},{key:"_setCaptionsFontSize",value:function(){if(this._activeCaptionId){var e=this._captions[this._activeCaptionId];if(e){var t=this._captionRenderer.getDimensions();if(t[0]>0&&t[1]>0){var i=e.getBoundingClientRect(),r=Math.min(i.height/t[0],i.width/t[1]);e.style.fontSize="".concat(r,"px")}}}}},{key:"_clearActiveCaptions",value:function(e){if(this._activeCaptionId){var t=this._captions[this._activeCaptionId];if(t)for(e&&(t.style.visibility="hidden");t.firstChild;)t.removeChild(t.firstChild)}}}])&&s(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),c=(0,n.multiInstanceHolder)(u);t.default=c},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.TRANSITION_MODE=t.TRACK_STATE=void 0,t.TRACK_STATE={OPEN:0,BUFFER:1,ACTIVE:2,BACKUP:3,CLOSED:4},t.TRANSITION_MODE={ABRUPT:0,SMOOTH:1}},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(12),i(13),i(9),i(10),i(4),i(14);var r,n=(r=i(18))&&r.__esModule?r:{default:r};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===o(n=function(e,t){if("object"!==o(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var s={liveFrameTypes:{WEB_AAC_SEQUENCE_HEADER:0,WEB_AAC_FRAME:1,WEB_AVC_SEQUENCE_HEADER:2,WEB_AVC_KEY_FRAME:3,WEB_AVC_FRAME:4,WEB_HEVC_SEQUENCE_HEADER:5,WEB_HEVC_KEY_FRAME:6,WEB_HEVC_FRAME:7,WEB_VP6_KEY_FRAME:8,WEB_VP6_FRAME:9,WEB_VP8_KEY_FRAME:10,WEB_VP8_FRAME:11,WEB_VP9_KEY_FRAME:12,WEB_VP9_FRAME:13,WEB_MP3:14,WEB_OPUS_FRAME:15,WEB_AV1_SEQUENCE_HEADER:16,WEB_AV1_KEY_FRAME:17,WEB_AV1_FRAME:18},closeCodes:{1e3:"CLOSE_NORMAL",1001:"CLOSE_GOING_AWAY",1002:"CLOSE_PROTOCOL_ERROR",1003:"CLOSE_UNSUPPORTED",1005:"CLOSE_NO_STATUS",1006:"CLOSE_ABNORMAL",1007:"Unsupported Data",1008:"Policy Violation",1009:"CLOSE_TOO_LARGE",1010:"Missing Extension",1011:"Internal Error",1012:"Service Restart",1013:"Try Again Later",1015:"TLS Handshake"}};t.default=function(e){var t=n.default.create(e,"WSUtils"),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.closeCodes=s.closeCodes,this.liveFrameTypes=s.liveFrameTypes,this.int32pow=Math.pow(2,32)}var i,r;return i=e,(r=[{key:"readValue",value:function(e,i,r){var n=r/4,o=n>>>0,a=[0,0],s=n===o?o-1:o;if(s>2)return t.error("[WS]: Attempt to read more than 64 bits!"),null;for(var u=s;u>=0;u--)for(var c=0;c<4;c++)a[u]|=e[i+4*(s-u)+c]<<8*(3-c);return a[1]&=2097151,a[1]*this.int32pow+(a[0]>>>0)}}])&&a(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),e}();return{create:function(){return new i}}}},function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t);if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===r(t)?t:String(t)}i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(78),i(41),i(12),i(13),i(9),i(10),i(4),i(14);var a=function(){function e(t,i,r){var n,a,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,a="_captBtnClick",s=function(e){this._captListDlg?(this._captListDlg.remove(),delete this._captListDlg,this._uiControl.showControlsForPeriod(2)):(this._uiControl.closeCtrlDialogs(),this._captListDlg=document.createElement("ul"),this._captListDlg.className="sldp_capt_dialog sldp_ctrl_dialog",this._updateCaptionListDialog(),this._playerWrp.insertBefore(this._captListDlg,this._btnHolder),this._uiControl.showControlsForPeriod("infinite")),e.stopPropagation()}.bind(this),(a=o(a))in n?Object.defineProperty(n,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[a]=s,i&&r&&!this._btnHolder&&(this._captBtn=document.createElement("div"),this._captBtn.className="sldp_captions_btn sldp_btn sldp-icon-cc",this._captBtn.style.display="none",this._captBtn.onclick=this._captBtnClick,this._btnHolder=i,this._btnHolder.insertBefore(this._captBtn,r),this._playerWrp=t),this._captions=[]}var t,i;return t=e,(i=[{key:"setUIControlInterface",value:function(e){this._uiControl=e}},{key:"setUserActionReportInterface",value:function(e){this._userActionReport=e}},{key:"setCaptions",value:function(e){this._captions=e}},{key:"setActiveIdx",value:function(e){this._activeIdx=e,this.refresh()}},{key:"getCaptionTitle",value:function(e){var t=this._captions[e].name||"CC".concat(e+1);return this._captions[e].lang&&(t+=" (".concat(this._captions[e].lang,")")),t}},{key:"isVisible",value:function(){return!!this._captListDlg}},{key:"refresh",value:function(){this._captBtn&&(this._captBtn.style.display=this._captions.length>0?"block":"none"),this._captListDlg&&this._updateCaptionListDialog()}},{key:"closeDialog",value:function(){this._captListDlg&&(this._captListDlg.remove(),delete this._captListDlg)}},{key:"destroy",value:function(){this._captBtn=void 0,this._btnHolder=void 0,this._captListDlg=void 0,this._playerWrp=void 0,this._uiControl=void 0,this._captions=void 0}},{key:"_updateCaptionListDialog",value:function(){for(var e=this;this._captListDlg.firstChild;)this._captListDlg.removeChild(this._captListDlg.firstChild);for(var t=function(t){if(!e._captions[t])return"continue";var i=e.getCaptionTitle(t),r=document.createElement("li");e._activeIdx===t&&(i="&#10003 "+i),r.innerHTML=i,r.onclick=function(e){if(this._userActionReport){var i=t===this._activeIdx?-1:t;this._userActionReport.selectCaption(i)}e.stopPropagation()}.bind(e),e._captListDlg.appendChild(r)},i=0;i<this._captions.length;i++)t(i)}}])&&n(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=a},function(e,t,i){var r=i(1),n=i(30),o=i(76),a=i(224),s=i(152),u=i(22),c=i(23),l=i(47),f=i(3),h=n("Reflect","construct"),d=Object.prototype,p=[].push,v=f((function(){function e(){}return!(h((function(){}),[],e)instanceof e)})),m=!f((function(){h((function(){}))})),y=v||m;r({target:"Reflect",stat:!0,forced:y,sham:y},{construct:function(e,t){s(e),u(t);var i=arguments.length<3?e:s(arguments[2]);if(m&&!v)return h(e,t,i);if(e==i){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return o(p,r,t),new(o(a,e,r))}var n=i.prototype,f=l(c(n)?n:d),y=o(e,f,t);return c(y)?y:f}})},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(26),i(351),i(12),i(13),i(9),i(10),i(4),i(14);var r=s(i(353)),n=s(i(117)),o=s(i(233)),a=s(i(18));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===u(n=function(e,t){if("object"!==u(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var l=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dbRange=t||100,this.dbMult=20,this.bufSize=2048,this.rate=i||6,this.logger=a.default.create(r,"VU meter"),this.instId=r}var t,i;return t=e,(i=[{key:"start",value:function(e,t){this.samplingRate=t?t.samplingRate:void 0,this.channels=t&&t.channels||2,this.logger.debug("Start VU meter, channel count: ".concat(this.channels,", sampling rate: ").concat(this.samplingRate)),this.mediaElement=e,this.context&&"suspended"===this.context.state&&(this.suspended=!0),this._setupMeter()}},{key:"stop",value:function(e){this.logger.debug("Stop VU meter",e),this._removeMeter(),this._initValues(),this.ui&&this.ui.destroy(e)}},{key:"setup",value:function(){return this._setupMeter()}},{key:"refreshUI",value:function(e){this.ui&&(this.logger.debug("refreshUI channels count = ".concat(e&&e.channels||2),e),this.ui.refresh(e&&e.channels||2))}},{key:"onPlay",value:function(){this.context&&(this.logger.debug("onPlay event, resume context"),this.context.resume())}},{key:"setCallback",value:function(e){this.callback=e}},{key:"setFatalErrorCallback",value:function(e){this.fatalErrorCallback=e}},{key:"setUI",value:function(e){var t=document.getElementById(e);t&&(this.ui=new r.default(t,this.dbRange))}},{key:"isActivated",value:function(){return void 0!==this.context&&"running"===this.context.state}},{key:"_setupMeter",value:function(){var e=this._enableSource();return e&&(this._createMeter(),this.logger.debug("meter created",this.context.state),this.rate&&this.samplingRate&&this._setupRateControl(),this.ui&&(this.logger.debug("_setupMeter channels = ".concat(this.channels)),this.ui.create(this.channels))),e}},{key:"_initValues",value:function(){this.suspended=!1,this.rateControl=!1,this.channelValues=[],this.channelDecibels=[]}},{key:"_enableSource",value:function(){if(void 0===this.context){var e=n.default.getInstance(this.instId);if(this.context=e.get(),this.context)if(this.audGraphCtrl=o.default.getInstance(this.instId),"suspended"!==this.context.state)this.logger.debug("_enableSource channels = ".concat(this.channels)),this.audGraphCtrl.init(this.mediaElement,this.channels),this.suspended=!1;else{var t=this;e.onContextRunning((function(e){t.logger.debug("Audio context switched its state to running, setup VU meter, channels =",t.channels),t.audGraphCtrl.init(t.mediaElement,t.channels),t.suspended=!1,t._setupMeter(),t.onActivated&&(t.onActivated(),t.onActivated=void 0)})),this.logger.debug("Audio context is created, but it's suspended"),this.suspended=!0,this.context.resume()}}else this.suspended&&(this.logger.debug("Trying to resume suspended audio context"),this.context.resume());return this.isActivated()}},{key:"_dbFromVal",value:function(e){var t=-this.dbRange;return e>0&&(t=this.dbMult*Math.log10(e))<-this.dbRange&&(t=-this.dbRange),t}}])&&c(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=l},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.specialCea608CharsCodes=t.NR_ROWS=t.NR_COLS=void 0,t.NR_ROWS=15,t.NR_COLS=32,t.specialCea608CharsCodes={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499}},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},,,function(e,t,i){"use strict";i(142);var r,n=a(i(253)),o=a(i(116));function a(e){return e&&e.__esModule?e:{default:e}}i(356),a(i(357)),document.currentScript&&(r=document.currentScript.src.substr(0,document.currentScript.src.lastIndexOf("/")+1)),e.exports={init:function(e){var t;t=e&&e.instance_name?e.instance_name:"SLDP_"+(Math.floor(1e3*Math.random())+1),o.default.getInstance(t).setScriptPath(r);var i=new n.default(t);return i.initialize(e),i},VERSION:"v2.25.0",COMMITHASH:"438f73c0e5dcfb843350e32094f9f152c0da5e7a"}},function(e,t,i){var r=i(6),n=i(16),o=r.WeakMap;e.exports=n(o)&&/native code/.test(String(o))},function(e,t,i){var r=i(30),n=i(5),o=i(91),a=i(123),s=i(22),u=n([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(s(e)),i=a.f;return i?u(t,i(e)):t}},function(e,t){var i=Math.ceil,r=Math.floor;e.exports=Math.trunc||function(e){var t=+e;return(t>0?r:i)(t)}},function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(124),i(0),i(9),i(10),i(11),i(7),i(8),i(158),i(159),i(160),i(161),i(110),i(111),i(162),i(163),i(112),i(164),i(165),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(2),i(48),i(4),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(68),i(69),i(70),i(71),i(72),i(134),i(26),i(118),i(142),i(113),i(290),i(291),i(137),i(40),i(94),i(141),i(41);var n=g(i(300)),o=g(i(333)),a=g(i(170)),s=g(i(115)),u=g(i(335)),c=g(i(340)),l=g(i(343)),f=g(i(345)),h=g(i(18)),d=g(i(138)),p=g(i(171)),v=g(i(117)),m=g(i(346)),y=g(i(349));function g(e){return e&&e.__esModule?e:{default:e}}function b(){b=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,n=Object.defineProperty||function(e,t,i){e[t]=i.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,i){return e[t]=i}}function l(e,t,i,r){var o=t&&t.prototype instanceof d?t:d,a=Object.create(o.prototype),s=new T(r||[]);return n(a,"_invoke",{value:function(e,t,i){var r="suspendedStart";return function(n,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===n)throw o;return{value:void 0,done:!0}}for(i.method=n,i.arg=o;;){var a=i.delegate;if(a){var s=S(a,i);if(s){if(s===h)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===r)throw r="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r="executing";var u=f(e,t,i);if("normal"===u.type){if(r=i.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r="completed",i.method="throw",i.arg=u.arg)}}}(e,i,s)}),a}function f(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var h={};function d(){}function p(){}function v(){}var m={};c(m,a,(function(){return this}));var y=Object.getPrototypeOf,g=y&&y(y(P([])));g&&g!==t&&i.call(g,a)&&(m=g);var _=v.prototype=d.prototype=Object.create(m);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){var o;n(this,"_invoke",{value:function(n,a){function s(){return new t((function(o,s){!function n(o,a,s,u){var c=f(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==r(h)&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(h).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}(n,a,o,s)}))}return o=o?o.then(s,s):s()}})}function S(e,t){var i=t.method,r=e.iterator[i];if(void 0===r)return t.delegate=null,"throw"===i&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==i&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),h;var n=f(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function P(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=v,n(_,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:p,configurable:!0}),p.displayName=c(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,u,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},w(A.prototype),c(A.prototype,s,(function(){return this})),e.AsyncIterator=A,e.async=function(t,i,r,n,o){void 0===o&&(o=Promise);var a=new A(l(t,i,r,n),o);return e.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(_),c(_,u,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),i=[];for(var r in t)i.push(r);return i.reverse(),function e(){for(;i.length;){var r=i.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=P,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(i,r){return a.type="throw",a.arg=e,t.next=i,r&&(t.method="next",t.arg=void 0),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),C(i),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;C(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:P(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),h}},e}function _(e,t,i,r,n,o,a){try{var s=e[o](a),u=s.value}catch(e){return void i(e)}s.done?t(u):Promise.resolve(u).then(r,n)}var w=0,A=1,S=2,k=3,C=4,T=5,P=6,x=7,E=8,B=9,M=new Uint8Array([17,144]);t.default=function(e){var t=h.default.create(e,"Director"),i=new c.default(e),r=new n.default(e),g=new l.default(e).create(),R=[],I=w,F=new o.default(e).create(g),L=a.default.getInstance(e),O=[],j={},D={},V=0,U=!1,N=0,W=!1,H={},z=0,q=!1,G=[],Q=p.default.getInstance(),Y=new f.default(e),K=s.default.getInstance(e);K.onPlayFailed=function(){J&&(J.triggerPause(!0),J.onPlaybackStarted()),se=setTimeout(Ue,2e3)};var J,X,Z,$,ee,te,ie,re,ne,oe,ae,se,ue,ce,le,fe,he,de,pe,ve,me=m.default.getInstance(e);function ye(){(J=new u.default($,e)).onPlay=Be,J.onPause=De,J.onPlayEvent=Me,J.onPauseEvent=Ve,J.onVolumeSet=Fe,J.onUserAction=Ie,J.onQualityChange=We,J.onResize=Le,J.onEnterPip=Oe,J.onLeavePip=je,J.qualities=[]}function ge(){t.error("VU meter fatal error"),"AudioWorklet"===$.vu_meter.api&&($.vu_meter.api="ScriptProcessor",be(),J.destroy(),ye(),t.debug("_onVUMeterFatalError source buffer crash"),st(!0))}function be(){$.vu_meter&&$.vu_meter.mode&&$.vu_meter.type&&void 0!==(X=new y.default(e).create($.vu_meter))&&($.vu_meter.container&&X.setUI($.vu_meter.container),$.vu_meter.initialized=!0,X.setFatalErrorCallback(ge))}function _e(){te=void 0,ie=void 0,re=void 0,oe=void 0,ne=void 0,ae=void 0}function we(){F.callbacks={onStatusReceived:ct,onInitSegmentReceived:gt,onDataReceived:wt,onConnectionClosed:ut}}function Ae(e){t.debug("reset playback",e),le&&le.stop(e),F.close(),we();for(var i=0;i<R.length;i++)R[i].close();R=[],Te(),ke(),_e()}function Se(){J.removePip((function(){t.debug("reset media service"),me.stop(),Ce(),L.clear(),K.init(J.mediaElement),g.setMediaElement(J.mediaElement),setTimeout(Ee,0)}))}function ke(){ue&&(clearTimeout(ue),ue=void 0),N=0}function Ce(e){X&&X.stop(e)}function Te(){void 0!==se&&(clearTimeout(se),se=void 0)}function Pe(){xe()&&(I=k)}function xe(){var e=!1,i=$.stream_url;return i&&i.length>0?(e=F.open(i),setTimeout((function(){e.streamURL}),0)):t.error("_requestCurrentStream attempt to open empty url",ee,$.stream_url),e}function Ee(){switch(t.debug("Media service initialized",I),I){case S:J.canPlay=!0,I=A;break;case A:$.stream_url&&($.autoplay||U)?(Pe(),U=!1):J.canPlay=!0;break;case x:xe(),N=1;break;case E:for(var e=0;e<R.length;e++)R[e].isActual()&&R[e].setupMediaService();var i=!1;L.init(J.mediaElement,(function(){if(!i){for(var e=!1,t=0;t<R.length;t++)R[t].isActual()&&(R[t].attachToMediaService(),R[t].recover(),R[t].inTransition()&&(e=!0));ie&&ie.suspendMuteable(),I=e?C:T,J.clearMediaElement(),L.startPlayback({recover:!0}),Je(),i=!0}}))}}function Be(e){switch(e&&ve&&ve.init(),I){case A:Pe();break;case B:Se(),I=A,U=!0;break;case w:break;default:Te(),ke(),q&&te&&(le.start(),L.toggleBufferLineUp(q)),L.handlePlay(e),X&&X.onPlay()}}function Me(){L.handlePlayEvent()}function Re(){J&&J.onPlaybackStarted()}function Ie(){return k!==I&&C!==I}function Fe(e){}function Le(){I>=C&&(Je(),$.adaptive_bitrate&&Y.onSizeUpdate(J.getSize()))}function Oe(){t.debug("enter PIP"),L.handleEnterPip()}function je(){t.debug("leave PIP"),L.handleLeavePip()}function De(){C<I&&(ke(),le&&le.stop(),L.handlePause(),$.pause_timeout>=0&&(se=setTimeout(Ue,1e3*$.pause_timeout)))}function Ve(){L.handlePauseEvent()}function Ue(){Ne()}function Ne(){t.debug("enter reset state"),Ae(),L.resetPosition(),me.stop(),Ce(),I=B}function We(e,i){var r=!1;if(ze()||K.isPaused())return t.warn("Quality change is not available at the moment"),r;if(C<I){var n,o,a="Auto"==e;(a||void 0!==D[e])&&(a||(null==i&&(i=0),o=D[e][i],n=O[o].stream),t.debug("Switch quality to ",e,n),a?(q=!0,Xe(),le.start(),L.toggleBufferLineUp(q)):void 0!==o&&(q=!1,le&&le.stop(),L.toggleBufferLineUp(q),He(o)),r=!0)}return r}function He(e,i){if(e!=re){if(te&&!K.isPaused()&&x!=I){var r=O[e];if(P===I)for(var n=0;n<R.length;n++)R[n].activate();te.inTransition(!0);var o=r.stream_info,a={width:o.width,height:o.height,bandwidth:o.bandwidth};if(te.setTransitionParams({id:V,codec:o.vcodec,timescale:o.vtimescale,name:r.stream,streamOptions:a}),te.isTransitionSupported()){Te(),ke(),t.debug("[Director] Change quality, send Play for "+r.stream+", sn #"+V);var s={stream:r.stream,sn:V,type:"video",offset:"0"};de>0&&(s.steady=!0),dt([s]),V++,oe=e,te.startTransition(i),I=C}else t.error("Transition isn't supported to ",r)}}else Xe()}function ze(){return void 0!==oe||void 0!==ae}function qe(){return L.isSeeking()}function Ge(){var e={};if(void 0!==re){e={vid:te.id(),idx:re,bandwidth:O[re].stream_info.bandwidth,rendition:O[re].stream_info.height};for(var t=0,i=0;i<G.length;i++)if(G[i].idx==re){t=i;break}e.orderedIdx=t,void 0!==ne&&(e.aid=ie.id())}return e}function Qe(e){var i;t.debug("Send cancel ",e.id()),i=[e.id().toString()],F.send({command:"Cancel",streams:i})}function Ye(e,i){t.debug("probe stream "+e.streamName()+", sn: "+e.id()+", offset: "+te.sapOffset()+", duration: "+i),dt([{stream:e.streamName(),sn:e.id(),type:"video",offset:te.sapOffset().toString(),duration:i}])}function Ke(e){if(e.isVideo()&&void 0!==oe){re=oe,oe=void 0;var t=Xe();Je(),q&&le.restart(!0),ie&&ie.suspendMuteable(),t.rendition,t.name,J.refresh()}else e.isAudio()&&void 0!==ae&&(ne=ae,ae=void 0)}function Je(){J.adjustHeight()}function Xe(){var e;if(void 0!==re&&O[re]){var t=O[re].stream_info.height+"p";$.initial_resolution=t;var i=O[re].stream_info.renditionIdx;if($.initial_idx=i,G.length>1)if(le)if(q){var r="Auto "+t;J.quality_ar[0].name=r,J.currentQuality={name:r}}else J.quality_ar[0].name="Auto",J.currentQuality={name:t,idx:i};else J.currentQuality={name:t,idx:i};e={name:O[re].stream,rendition:t}}return e}function Ze(){ce&&(clearTimeout(ce),ce=void 0)}function $e(e,i){if(T==I){for(var r=0;r<R.length;r++)if(R[r].isActual()){var n=R[r].bufferStatus(e);if(n.low){Ze(),ce=setTimeout((function(){L.wait(),ce=void 0}),1e3*n.lvl+50),R[r].buffer(),I=P;break}Ze()}i>200&&(t.debug("onProgress source buffer crash"),st(!0))}}function et(e){var t=(R.length>1?te:R[0]).latency(e);return t>0?t:0}function tt(e,t){}function it(){}function rt(e,t){}function nt(e,t){for(var i=0;i<R.length;i++)R[i].isActual()&&R[i].updateBufferedState(e,t)}function ot(){var e=0;if(te){var t=g.getMetrics(te.id());t&&(e=t.avgBufLevel())}return e}function at(){E!==I&&A!==I&&(t.debug("_forcePlaybackCrash"),st(!0))}function st(e){t.debug("onSourceBufferCrash",e),I=E,Z=void 0,Ae(),U=!0,I=A,Se()}function ut(){switch(t.debug("onConnectionClosed, state ",I),le&&le.stop(),K.isPaused()&&Ne(),I){case P:Ze(),L.continue();case C:if(e=!1,C===I&&te&&G.length>1&&re>=0&&(e=G[0].idx!==re&&te.isStarving()),e)return W=!0,t.debug("onConnectionClosed buffer crash",!0),void st(!0);!function(){for(var e=0;e<R.length;e++)R[e].flush()}();case T:Q.isBrowser("Firefox")?(Ae({hard:!0}),Se()):(xe(),N=1),I=x;break;case x:N>=$.reconnects||0==N?(Ne(),J.showNotPlaying()):null==ue&&(ue=setTimeout((function(){t.debug("do reconnect"),N++,ue=void 0,xe()}),N<5?1e3:5e3));break;case B:case S:break;case k:L.isMediaSourceSupported()?J.showNotPlaying():(t.error("MediaSource is not supported"),J.showNotSupported(Q.isIOS()));default:I=A}var e}function ct(e,i,r){t.debug("onStatusReceived state=".concat(I),i,r),O=e;var n=function(){var e=void 0,i=[],r=[];j={},D={},G=[],le&&le.stop();for(var n=0;n<O.length;n++){j[O[n].stream]=n;var o=O[n].stream_info;o.vtimescale&&(o.vtimescale=parseInt(o.vtimescale)),o.atimescale&&(o.atimescale=parseInt(o.atimescale));var a={name:O[n].stream,bandwidth:o.bandwidth?o.bandwidth:0};if(o.resolution&&o.vcodec){var s=o.resolution.split("x");if(o.width=parseInt(s[0]),o.height=parseInt(s[1]),a.width=o.width,a.height=o.height,a.vcodec=o.vcodec,L.isCodecSupported("video",o.vcodec)){a.video="supported";var u=s[1]+"p";D[u]||(D[u]=[]),D[u].push(n),o.renditionIdx=D[u].length-1,u!=$.initial_resolution||null!=$.initial_idx&&$.initial_idx!=o.renditionIdx||(e=n),o.bwStr=o.bandwidth,o.bandwidth&&(o.bandwidth=parseInt(o.bandwidth)/1024);var c=0;for(c=0;c<G.length;c++){var l=O[G[c].idx].stream_info;if(l.height>s[1]||l.height==s[1]&&l.bandwidth>o.bandwidth)break}i.splice(c,0,{name:u,idx:o.renditionIdx}),G.splice(c,0,{idx:n,bandwidth:o.bandwidth,rendition:s[1]})}else a.video="not supported"}o.acodec&&(a.acodec=o.acodec,a.audio=L.isCodecSupported("audio",o.acodec)?"supported":"not supported"),r.push(a)}return le&&i.length>1&&i.splice(0,0,{name:"Auto"}),t.debug("Player renditions:",i),t.debug("Ordered streams:",G),J.qualities=i,$.adaptive_bitrate&&Y.init(O,G,$.adaptive_bitrate,J.getSize()),{renditionProperties:r,initialIdx:e}}(),o=(n.renditionProperties,n.initialIdx);x==I&&L.resetPosition();var a=!!$.audio_only,s=!!$.video_only;if(W)G.length>0&&(o=G[0].idx,W=!1);else for(var u=0;u<R.length;u++){var c;c=R[u].inTransition()?j[R[u].getTransitionStreamName()]:j[R[u].getStreamName()],R[u].isVideo()?(re=c,oe=void 0,void 0!==c&&O[c].stream_info.vcodec?(x==I&&R[u].reset(),a=!0):O.length>0&&R[u].inTransition(!0)):R[u].isAudio()?(ne=c,ae=void 0,void 0!==c&&O[c].stream_info.acodec?(x==I&&R[u].reset(),s=!0):O.length>0&&R[u].inTransition(!0)):t.error("Got track of type other than video or audio!")}if(void 0!==o&&(a||(a=mt(O[o],o)),s||(s=yt(O[o],o))),!a)for(var l=0;l<O.length&&!(a=mt(O[l],l));l++);if(!s)for(var f=0;f<O.length&&!(s=yt(O[f],f));f++);for(var h=0;h<R.length;h++)if(R[h].inTransition()&&!R[h].isTransitionSupported())return t.debug("onStatusReceived: Media source already contains given source buffer, it can not be filled, reload player..."),void st(!0);if(Xe(),function(e,i){pe=[];for(var r=!1,n=("offset"in $?$.offset.toString():"0"),o=0;o<R.length;o++){var a={type:R[o].type(),offset:n};$.sync_buffer>0&&(e&&i?a.steady=!0:r||(r=!0,t.error('Playback synchronization is set up but target Nimble Streamer doesn\'t have "sldp_add_steady_timestamps" config parameter set up. Add sldp_add_steady_timestamps = true to /etc/nimble/nimble.conf file and restart Nimble Streamer.'))),R[o].inTransition()?(a.stream=R[o].getTransitionStreamName(),a.sn=R[o].transitionStreamId()):R[o].isOpen()&&(a.stream=R[o].getStreamName(),a.sn=R[o].id()),pe.push(a)}}(r,i),a&&!$.audio_only||s&&!$.video_only){if(pe.length>0){if(Z=void 0,s||J.setMuted(),$.sync_buffer>0&&r&&i?(he=performance.now(),de=parseInt(i),F.acceptSteadyTimestamps(!0)):(he=de=void 0,L.setSyncParams(void 0,void 0),F.acceptSteadyTimestamps(!1)),I=C,L.isInitialized())return void lt();L.init(J.mediaElement)||J&&(t.debug("stop playback"),J.triggerPause(!0),Ae(),Se(),J.onPlaybackFinished(),I=S)}}else Ae({hard:!0}),me.stop(),Ce()}function lt(){return ft.apply(this,arguments)}function ft(){var e;return e=b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.debug("_onMediaReady"),te&&!te.isAttachedToMedia()&&te.attachToMediaService(),ie&&!ie.isAttachedToMedia()&&ie.attachToMediaService(),z=0,dt(pe),F.setDtsEqPtsMode(!!$.dts_eq_pts),ht(pe),!ie){e.next=10;break}return e.next=10,ie.postInit();case 10:case"end":return e.stop()}}),e)})),(ft=function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function a(e){_(o,r,n,a,s,"next",e)}function s(e){_(o,r,n,a,s,"throw",e)}a(void 0)}))}).apply(this,arguments)}function ht(e){t.debug("[Director] Request streams:");for(var i=0;i<e.length;i++){var r="Stream #"+i+": "+e[i].stream+", sn: "+e[i].sn+", offset: "+e[i].offset;e[i].steady&&(r+=", steady: true"),t.debug(r)}}function dt(e){F.send({command:"Play",streams:e})}function pt(e){for(var t,i=0;i<R.length;i++)if(e==R[i].id()){t=R[i];break}return t}function vt(e){for(var t,i=0;i<R.length;i++)if(R[i].inTransition()&&e==R[i].transitionStreamId()){t=R[i];break}return t}function mt(e,i){var n=!1,o=e.stream,a=e.stream_info;if(a.vcodec&&a.width&&a.height){var s={width:a.width,height:a.height,bandwidth:a.bandwidth,buffering:$.buffering,captions:$.captions};"key_frame_alignment"in $&&(s.sapAlignment=$.key_frame_alignment),"fmp4_full_gop"in $&&(s.fragmentFullGop=$.fmp4_full_gop),"av01"===a.vcodec.split(".")[0]&&Q.isBrowser("Firefox")&&(t.debug("Setting fmp4_full_gop to true for AV1 codec in FireFox"),s.fragmentFullGop=!0),te?te.inTransition()&&(te.setTransitionParams({id:V,codec:a.vcodec,timescale:a.vtimescale,name:o,streamOptions:s}),te.isTransitionSupported()&&(V++,oe=i,re=void 0,te.startTransition(),n=!0)):L.isCodecSupported("video",a.vcodec)?((te=r.create(V,"video",a.vcodec,a.vtimescale,"video_stream_id",o,s,g)).setupMediaService(),R.push(te),V++,re=i,oe=void 0,n=!0):t.error("Video codec is not supported: ",a.vcodec)}else{var u=a.vcodec?"resolution":"video codec";t.warn("Error: no valid "+u+" specified")}return n}function yt(e,i){var n=!1,o=e.stream,a=e.stream_info;if(a.acodec){var s={buffering:$.buffering};ie?ie.inTransition()&&(ie.setTransitionParams({id:V,codec:a.acodec,timescale:a.atimescale,name:o,streamOptions:s}),ie.isTransitionSupported()&&(V++,ae=i,ne=void 0,ie.startTransition(),n=!0)):L.isCodecSupported("audio",a.acodec)?((ie=r.create(V,"audio",a.acodec,a.atimescale,"audio_stream_id",o,s,g)).setupMediaService(),R.push(ie),V++,ne=i,ae=void 0,n=!0):t.error("Audio codec is not supported: ",a.acodec)}return n}function gt(e,i){if(t.debug("onInitSegmentReceived",e,I),C==I){var r=pt(e);r&&r.isActual()?r.isInited()?r.isInitSegmentNew(i)&&(r.processInitSegment(i),r.setBufferDelay()):(r.initPresentation(i),r.onBaseDecodeTimeReady(bt),r.onSourceReady(_t)):(r=vt(e))&&r.isActual()&&(r.isTransitionInited()?r.isTransitionInitNew(i)&&r.processTransitionInitSegment(i):(r.initTransition(i),r.onCancelStream(Qe),r.onTransitionCompleted(Ke)))}else if(le&&le.isProbing(e))le.onProbeInitReceived();else if(T==I||P==I||E==I){var n=pt(e);n&&n.isActual()&&(E==I?n.populateInitDataBuffer(i):n.isInitSegmentNew(i)&&(n.processInitSegment(i),n.setBufferDelay()))}}function bt(e,t){(!Z||t>Z)&&(Z=t);var i=!0;if(E!=I)for(var r=0;r<R.length;r++)if(R[r].isOpen()||R[r].inTransition()){i=!1;break}if(i)for(var n=0;n<R.length;n++)(R[n].isBuffering()||R[n].isBackingUp())&&R[n].setBaseDecodeTime(Z)}function _t(){for(var e=!0,t=0;t<R.length;t++)if(R[t].isBuffering()||R[t].inTransition()){e=!1;break}e&&(C==I?(I=T,J.clearMediaElement(),L.startPlayback(),Je(),q&&te&&(le.start(),L.toggleBufferLineUp(q))):P==I?(I=T,Ze(),L.continue()):fe&&(q=!0,fe=!1,le.start(),le.setBuffering($.buffering),L.toggleBufferLineUp(q)),function(){if(X){var e=ie?ie.getAudioInfo():void 0;X.start(J.mediaElement,e),J.setVUMeterHandler(X)}}(),te&&$.screenshots&&(me.setMediaElement(J.mediaElement),me.setRate($.screenshots.rate),H.onScreenshotReady&&me.onScreenshotReady(rt),me.start()))}function wt(e,i,r,n,o,a){if(C==I||T==I||P==I){var s=pt(e);if(s&&s.isActual()){de&&0===z&&i&&(void 0===te||s.isVideo())&&(z=(a-de)/1e3-(n+o)/s.timescale()*1e3,L.setSyncParams(z+he,$.sync_buffer));var u=s.processFrame(i,r,n,o);if(u.done){if($.muteable&&s.isVideo()&&ie&&ie.isMuteable()){var c=g.getMetrics(ie.id());c&&!c.hasLatest500msecBytesArrived()&&(ie.isInited()||(t.debug("Audio is muted on start, push synthetic init segment"),ie.initPresentation(M,!0),ie.onBaseDecodeTimeReady(bt),ie.onSourceReady(_t)),ie.processMute(n,s))}}else u.errors>=10&&at()}else le&&le.isProbing(e)?le.onProbeDataReceived(i,r.byteLength,n):(s=vt(e))&&s.isActual()&&(s.processTransitionFrame(i,r,n,o).done||at())}else if(E==I){var l=pt(e);l&&l.populateStartupBuffer(i,r,n,o)}}this.initialize=function(r){var n;!function(i){var r,n="error",o=!1;i&&(void 0!==i.log_level&&(n=i.log_level),void 0!==i.log_div&&(o=i.log_div),void 0!==i.inform_ids&&(r=i.inform_ids)),h.default.setLevel(n),h.default.setDiv(e,o),d.default.init(e,r),t.debug("SLDP Player v2.25.0")}(r),function(e){var i={autoplay:!0,controls:!0,buffering:1e3,reconnects:10,adaptive_bitrate:{},muteable:!1,fullscreen:!1,muted:!1,opus_decoder:!1,captions:!1,screenshots:!1,ios_failback_scheme:"sldp",ios_failback_secure_scheme:"sldps",ios_failback_app_url:"https://itunes.apple.com/us/app/sldp-player/id1238237026"};t.debug("Parameters: ",JSON.stringify(e)),($=Object.assign({},i,e)).mobile=Q.isMobile(),function(){if(void 0!==$.width)if("parent"==$.width)$.width="100%";else{var e=parseInt($.width);isNaN(e)||($.width=e)}if(void 0!==$.height)if("parent"==$.height)$.height="100%";else{var t=parseInt($.height);isNaN(t)||($.height=t)}}(),$.adaptive_bitrate instanceof Object?($.adaptive_bitrate.initial_rendition&&($.adaptive_bitrate.initial_rendition.endsWith("p")?($.initial_resolution=$.adaptive_bitrate.initial_rendition,$.adaptive_bitrate.initial_height=parseInt($.adaptive_bitrate.initial_rendition)||void 0):t.error("Parameter adaptive_bitrate.initial_rendition is ignored. It must be a name of a rendition, i. e. '240p', '480p' or '720p'")),$.adaptive_bitrate.max_rendition&&($.adaptive_bitrate.max_rendition.endsWith("p")?($.adaptive_bitrate.max_height=parseInt($.adaptive_bitrate.max_rendition)||void 0,$.adaptive_bitrate.initial_height>$.adaptive_bitrate.max_height&&(t.error("Parameter adaptive_bitrate.max_rendition is ignored. It must be greater or equal to adaptive_bitrate.initial_rendition"),$.adaptive_bitrate.max_height=void 0,$.adaptive_bitrate.max_rendition=void 0)):t.error("Parameter adaptive_bitrate.max_rendition is ignored. It must be a name of a rendition, i. e. '240p', '480p' or '720p'")),$.adaptive_bitrate.size_constrained=!!$.adaptive_bitrate.size_constrained):!0===$.adaptive_bitrate&&($.adaptive_bitrate={}),void 0!==$.pause_timeout&&($.pause_timeout=parseInt($.pause_timeout),isNaN($.pause_timeout)&&($.pause_timeout=void 0)),$.latency_tolerance>0&&$.latency_tolerance<=$.buffering&&($.latency_tolerance=$.buffering+100),"seek"===$.latency_adjust_method?$.zapping=!1:"fast-forward"===$.latency_adjust_method&&($.zapping=!0),void 0!==$.sync_buffer&&($.sync_buffer=parseInt($.sync_buffer),isNaN($.sync_buffer)?$.sync_buffer=null:($.sync_buffer<500&&($.sync_buffer=500),$.latency_tolerance&&(t.warn('Playback synchronization is set up. "latency_tolerance" parameter doesn\'t take any effect and is omitted.'),$.latency_tolerance=0),$.offset&&t.warn('Playback synchronization is set up. "offset" parameter doesn\'t have any effect and is omitted.'),$.buffering=$.sync_buffer-50,$.offset=$.sync_buffer)),$.vu_meter instanceof Object&&($.vu_meter.db_range=parseInt($.vu_meter.db_range),isNaN($.vu_meter.db_range)&&($.vu_meter.db_range=void 0),$.vu_meter.rate=parseFloat($.vu_meter.rate),isNaN($.vu_meter.rate)?$.vu_meter.rate=void 0:$.vu_meter.rate<.001&&($.vu_meter.rate=.001),void 0===$.vu_meter.mode&&void 0!==$.vu_meter.container&&($.vu_meter.mode="peak"),void 0!==$.vu_meter.mode&&void 0===$.vu_meter.container&&($.vu_meter.mode=void 0,t.warn("VU meter container is not specified, VU meter can't be created")),void 0===$.vu_meter.type&&($.vu_meter.type="output"),"input"!==$.vu_meter.type&&"output"!==$.vu_meter.type&&(t.warn('VU meter type "'+$.vu_meter.type+"\" is not recognized, VU meter can't be created"),$.vu_meter.type=void 0),void 0===$.vu_meter.api&&($.vu_meter.api="ScriptProcessor"),Q.isBrowser("Safari")&&"input"===$.vu_meter.type&&(t.warn('VU meter type is changed to "output" for Safari browser, because known bug (https://feedbackassistant.apple.com/feedback/9764540) breaks volume control for "input" type.'),$.vu_meter.type="output")),$.captions=!1,$.screenshots=!1,$.screenshots&&(!0===$.screenshots||$.screenshots instanceof Object?(!0===$.screenshots&&($.screenshots={}),void 0===$.screenshots.rate?$.screenshots.rate=-1:$.screenshots.rate<0&&($.screenshots.rate=0)):$.screenshots=!1)}(r),be(),ye(),Q.logData(),$.video_only||(ve=v.default.getInstance(e)).init(),I=A,$.adaptive_bitrate&&(q=!0,le||((le=i.create(Y,g,$.sync_buffer>0?$.sync_buffer-100:$.buffering)).callbacks={switchRendition:He,isInProgress:ze,isSeeking:qe,getCurStream:Ge,probeStream:Ye,cancelStream:Qe}),L.toggleBufferLineUp(q)),L.setOpusDecoderEnabled($.opus_decoder),L.callbacks={onProgress:$e,onMediaReady:lt,onCrash:st,onWaitUpdate:nt,onPlayStarted:Re,onLatencyCalc:et,onLatencySeek:tt,onLowBuffer:it,getAvgVBufLvl:ot},we(),n="latency_tolerance"in $?$.latency_tolerance:0,L.setLatencyTolerance(n/1e3,$.buffering/1e3,$.zapping),g.setMediaElement(J.mediaElement),Ee()},this.tgAudio=function(){F.stop_audio=!F.stop_audio},this.destroy=function(e){!function(e){t.debug("destroy playback"),le&&le.stop({hard:!0}),F.close(),J&&J.removePip((function(){me.stop(),Ce(!0),J.destroy(),J=void 0,L.clear(),e&&e()})),Te(),ke();for(var i=0;i<R.length;i++)R[i].close();R=[],_e(),$=void 0}(e)},this.refreshVUMeterUI=function(){X&&X.refreshUI(ie?ie.getAudioInfo():void 0)}}},function(e,t,i){"use strict";var r,n,o,a=i(1),s=i(32),u=i(125),c=i(6),l=i(19),f=i(27),h=i(83),d=i(38),p=i(150),v=i(31),m=i(16),y=i(23),g=i(101),b=i(151),_=i(185).set,w=i(258),A=i(261),S=i(154),k=i(188),C=i(34),T=i(102),P=i(103),x=i(104),E=P.CONSTRUCTOR,B=P.REJECTION_EVENT,M=P.SUBCLASSING,R=C.getterFor("Promise"),I=C.set,F=T&&T.prototype,L=T,O=F,j=c.TypeError,D=c.document,V=c.process,U=x.f,N=U,W=!!(D&&D.createEvent&&c.dispatchEvent),H=function(e){var t;return!(!y(e)||!m(t=e.then))&&t},z=function(e,t){var i,r,n,o=t.value,a=1==t.state,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,f=e.domain;try{s?(a||(2===t.rejection&&K(t),t.rejection=1),!0===s?i=o:(f&&f.enter(),i=s(o),f&&(f.exit(),n=!0)),i===e.promise?c(j("Promise-chain cycle")):(r=H(i))?l(r,i,u,c):u(i)):c(o)}catch(e){f&&!n&&f.exit(),c(e)}},q=function(e,t){e.notified||(e.notified=!0,w((function(){for(var i,r=e.reactions;i=r.get();)z(i,e);e.notified=!1,t&&!e.rejection&&Q(e)})))},G=function(e,t,i){var r,n;W?((r=D.createEvent("Event")).promise=t,r.reason=i,r.initEvent(e,!1,!0),c.dispatchEvent(r)):r={promise:t,reason:i},!B&&(n=c["on"+e])?n(r):"unhandledrejection"===e&&A("Unhandled promise rejection",i)},Q=function(e){l(_,c,(function(){var t,i=e.facade,r=e.value;if(Y(e)&&(t=S((function(){u?V.emit("unhandledRejection",r,i):G("unhandledrejection",i,r)})),e.rejection=u||Y(e)?2:1,t.error))throw t.value}))},Y=function(e){return 1!==e.rejection&&!e.parent},K=function(e){l(_,c,(function(){var t=e.facade;u?V.emit("rejectionHandled",t):G("rejectionhandled",t,e.value)}))},J=function(e,t,i){return function(r){e(t,r,i)}},X=function(e,t,i){e.done||(e.done=!0,i&&(e=i),e.value=t,e.state=2,q(e,!0))},Z=function(e,t,i){if(!e.done){e.done=!0,i&&(e=i);try{if(e.facade===t)throw j("Promise can't be resolved itself");var r=H(t);r?w((function(){var i={done:!1};try{l(r,t,J(Z,i,e),J(X,i,e))}catch(t){X(i,t,e)}})):(e.value=t,e.state=1,q(e,!1))}catch(t){X({done:!1},t,e)}}};if(E&&(O=(L=function(e){g(this,O),v(e),l(r,this);var t=R(this);try{e(J(Z,t),J(X,t))}catch(e){X(t,e)}}).prototype,(r=function(e){I(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new k,rejection:!1,state:0,value:void 0})}).prototype=f(O,"then",(function(e,t){var i=R(this),r=U(b(this,L));return i.parent=!0,r.ok=!m(e)||e,r.fail=m(t)&&t,r.domain=u?V.domain:void 0,0==i.state?i.reactions.add(r):w((function(){z(r,i)})),r.promise})),n=function(){var e=new r,t=R(e);this.promise=e,this.resolve=J(Z,t),this.reject=J(X,t)},x.f=U=function(e){return e===L||void 0===e?new n(e):N(e)},!s&&m(T)&&F!==Object.prototype)){o=F.then,M||f(F,"then",(function(e,t){var i=this;return new L((function(e,t){l(o,i,e,t)})).then(e,t)}),{unsafe:!0});try{delete F.constructor}catch(e){}h&&h(F,O)}a({global:!0,constructor:!0,wrap:!0,forced:E},{Promise:L}),d(L,"Promise",!1,!0),p("Promise")},function(e,t){var i,r,n=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(i===setTimeout)return setTimeout(e,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(e){i=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&d())}function d(){if(!l){var e=s(h);l=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];c.push(new p(e,t)),1!==c.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=v,n.addListener=v,n.once=v,n.off=v,n.removeListener=v,n.removeAllListeners=v,n.emit=v,n.prependListener=v,n.prependOnceListener=v,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,i){var r=i(5),n=i(31);e.exports=function(e,t,i){try{return r(n(Object.getOwnPropertyDescriptor(e,t)[i]))}catch(e){}}},function(e,t,i){var r=i(16),n=String,o=TypeError;e.exports=function(e){if("object"==typeof e||r(e))return e;throw o("Can't set "+n(e)+" as a prototype")}},function(e,t,i){var r,n,o,a,s,u=i(6),c=i(77),l=i(80).f,f=i(185).set,h=i(188),d=i(187),p=i(259),v=i(260),m=i(125),y=u.MutationObserver||u.WebKitMutationObserver,g=u.document,b=u.process,_=u.Promise,w=l(u,"queueMicrotask"),A=w&&w.value;if(!A){var S=new h,k=function(){var e,t;for(m&&(e=b.domain)&&e.exit();t=S.get();)try{t()}catch(e){throw S.head&&r(),e}e&&e.enter()};d||m||v||!y||!g?!p&&_&&_.resolve?((a=_.resolve(void 0)).constructor=_,s=c(a.then,a),r=function(){s(k)}):m?r=function(){b.nextTick(k)}:(f=c(f,u),r=function(){f(k)}):(n=!0,o=g.createTextNode(""),new y(k).observe(o,{characterData:!0}),r=function(){o.data=n=!n}),A=function(e){S.head||r(),S.add(e)}}e.exports=A},function(e,t,i){var r=i(74);e.exports=/ipad|iphone|ipod/i.test(r)&&"undefined"!=typeof Pebble},function(e,t,i){var r=i(74);e.exports=/web0s(?!.*chrome)/i.test(r)},function(e,t){e.exports=function(e,t){try{1==arguments.length?console.error(e):console.error(e,t)}catch(e){}}},function(e,t,i){var r=i(189),n=i(125);e.exports=!r&&!n&&"object"==typeof window&&"object"==typeof document},function(e,t,i){"use strict";var r=i(1),n=i(19),o=i(31),a=i(104),s=i(154),u=i(190);r({target:"Promise",stat:!0,forced:i(192)},{all:function(e){var t=this,i=a.f(t),r=i.resolve,c=i.reject,l=s((function(){var i=o(t.resolve),a=[],s=0,l=1;u(e,(function(e){var o=s++,u=!1;l++,n(i,t,e).then((function(e){u||(u=!0,a[o]=e,--l||r(a))}),c)})),--l||r(a)}));return l.error&&c(l.value),i.promise}})},function(e,t,i){"use strict";var r=i(1),n=i(32),o=i(103).CONSTRUCTOR,a=i(102),s=i(30),u=i(16),c=i(27),l=a&&a.prototype;if(r({target:"Promise",proto:!0,forced:o,real:!0},{catch:function(e){return this.then(void 0,e)}}),!n&&u(a)){var f=s("Promise").prototype.catch;l.catch!==f&&c(l,"catch",f,{unsafe:!0})}},function(e,t,i){"use strict";var r=i(1),n=i(19),o=i(31),a=i(104),s=i(154),u=i(190);r({target:"Promise",stat:!0,forced:i(192)},{race:function(e){var t=this,i=a.f(t),r=i.reject,c=s((function(){var a=o(t.resolve);u(e,(function(e){n(a,t,e).then(i.resolve,r)}))}));return c.error&&r(c.value),i.promise}})},function(e,t,i){"use strict";var r=i(1),n=i(19),o=i(104);r({target:"Promise",stat:!0,forced:i(103).CONSTRUCTOR},{reject:function(e){var t=o.f(this);return n(t.reject,void 0,e),t.promise}})},function(e,t,i){"use strict";var r=i(1),n=i(30),o=i(32),a=i(102),s=i(103).CONSTRUCTOR,u=i(268),c=n("Promise"),l=o&&!s;r({target:"Promise",stat:!0,forced:o||s},{resolve:function(e){return u(l&&this===c?a:this,e)}})},function(e,t,i){var r=i(22),n=i(23),o=i(104);e.exports=function(e,t){if(r(e),n(t)&&t.constructor===e)return t;var i=o.f(e);return(0,i.resolve)(t),i.promise}},function(e,t,i){"use strict";var r=i(1),n=i(6),o=i(19),a=i(5),s=i(32),u=i(20),c=i(87),l=i(3),f=i(21),h=i(43),d=i(22),p=i(37),v=i(97),m=i(24),y=i(81),g=i(47),b=i(129),_=i(91),w=i(270),A=i(123),S=i(80),k=i(29),C=i(194),T=i(143),P=i(27),x=i(39),E=i(89),B=i(121),M=i(122),R=i(119),I=i(15),F=i(195),L=i(108),O=i(197),j=i(38),D=i(34),V=i(36).forEach,U=B("hidden"),N=D.set,W=D.getterFor("Symbol"),H=Object.prototype,z=n.Symbol,q=z&&z.prototype,G=n.TypeError,Q=n.QObject,Y=S.f,K=k.f,J=w.f,X=T.f,Z=a([].push),$=E("symbols"),ee=E("op-symbols"),te=E("wks"),ie=!Q||!Q.prototype||!Q.prototype.findChild,re=u&&l((function(){return 7!=g(K({},"a",{get:function(){return K(this,"a",{value:7}).a}})).a}))?function(e,t,i){var r=Y(H,t);r&&delete H[t],K(e,t,i),r&&e!==H&&K(H,t,r)}:K,ne=function(e,t){var i=$[e]=g(q);return N(i,{type:"Symbol",tag:e,description:t}),u||(i.description=t),i},oe=function(e,t,i){e===H&&oe(ee,t,i),d(e);var r=v(t);return d(i),f($,r)?(i.enumerable?(f(e,U)&&e[U][r]&&(e[U][r]=!1),i=g(i,{enumerable:y(0,!1)})):(f(e,U)||K(e,U,y(1,{})),e[U][r]=!0),re(e,r,i)):K(e,r,i)},ae=function(e,t){d(e);var i=p(t),r=b(i).concat(le(i));return V(r,(function(t){u&&!o(se,i,t)||oe(e,t,i[t])})),e},se=function(e){var t=v(e),i=o(X,this,t);return!(this===H&&f($,t)&&!f(ee,t))&&(!(i||!f(this,t)||!f($,t)||f(this,U)&&this[U][t])||i)},ue=function(e,t){var i=p(e),r=v(t);if(i!==H||!f($,r)||f(ee,r)){var n=Y(i,r);return!n||!f($,r)||f(i,U)&&i[U][r]||(n.enumerable=!0),n}},ce=function(e){var t=J(p(e)),i=[];return V(t,(function(e){f($,e)||f(M,e)||Z(i,e)})),i},le=function(e){var t=e===H,i=J(t?ee:p(e)),r=[];return V(i,(function(e){!f($,e)||t&&!f(H,e)||Z(r,$[e])})),r};c||(P(q=(z=function(){if(h(q,this))throw G("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?m(arguments[0]):void 0,t=R(e),i=function(e){this===H&&o(i,ee,e),f(this,U)&&f(this[U],t)&&(this[U][t]=!1),re(this,t,y(1,e))};return u&&ie&&re(H,t,{configurable:!0,set:i}),ne(t,e)}).prototype,"toString",(function(){return W(this).tag})),P(z,"withoutSetter",(function(e){return ne(R(e),e)})),T.f=se,k.f=oe,C.f=ae,S.f=ue,_.f=w.f=ce,A.f=le,F.f=function(e){return ne(I(e),e)},u&&(x(q,"description",{configurable:!0,get:function(){return W(this).description}}),s||P(H,"propertyIsEnumerable",se,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!c,sham:!c},{Symbol:z}),V(b(te),(function(e){L(e)})),r({target:"Symbol",stat:!0,forced:!c},{useSetter:function(){ie=!0},useSimple:function(){ie=!1}}),r({target:"Object",stat:!0,forced:!c,sham:!u},{create:function(e,t){return void 0===t?g(e):ae(g(e),t)},defineProperty:oe,defineProperties:ae,getOwnPropertyDescriptor:ue}),r({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:ce}),O(),j(z,"Symbol"),M[U]=!0},function(e,t,i){var r=i(42),n=i(37),o=i(91).f,a=i(130),s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"Window"==r(e)?function(e){try{return o(e)}catch(e){return a(s)}}(e):o(n(e))}},function(e,t,i){var r=i(93),n=i(126),o=i(23),a=i(15)("species"),s=Array;e.exports=function(e){var t;return r(e)&&(t=e.constructor,(n(t)&&(t===s||r(t.prototype))||o(t)&&null===(t=t[a]))&&(t=void 0)),void 0===t?s:t}},function(e,t,i){var r=i(1),n=i(30),o=i(21),a=i(24),s=i(89),u=i(198),c=s("string-to-symbol-registry"),l=s("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!u},{for:function(e){var t=a(e);if(o(c,t))return c[t];var i=n("Symbol")(t);return c[t]=i,l[i]=t,i}})},function(e,t,i){var r=i(1),n=i(21),o=i(86),a=i(82),s=i(89),u=i(198),c=s("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!u},{keyFor:function(e){if(!o(e))throw TypeError(a(e)+" is not a symbol");if(n(c,e))return c[e]}})},function(e,t,i){var r=i(1),n=i(30),o=i(76),a=i(19),s=i(5),u=i(3),c=i(16),l=i(86),f=i(84),h=i(275),d=i(87),p=String,v=n("JSON","stringify"),m=s(/./.exec),y=s("".charAt),g=s("".charCodeAt),b=s("".replace),_=s(1..toString),w=/[\uD800-\uDFFF]/g,A=/^[\uD800-\uDBFF]$/,S=/^[\uDC00-\uDFFF]$/,k=!d||u((function(){var e=n("Symbol")();return"[null]"!=v([e])||"{}"!=v({a:e})||"{}"!=v(Object(e))})),C=u((function(){return'"\\udf06\\ud834"'!==v("\udf06\ud834")||'"\\udead"'!==v("\udead")})),T=function(e,t){var i=f(arguments),r=h(t);if(c(r)||void 0!==e&&!l(e))return i[1]=function(e,t){if(c(r)&&(t=a(r,this,p(e),t)),!l(t))return t},o(v,null,i)},P=function(e,t,i){var r=y(i,t-1),n=y(i,t+1);return m(A,e)&&!m(S,n)||m(S,e)&&!m(A,r)?"\\u"+_(g(e,0),16):e};v&&r({target:"JSON",stat:!0,arity:3,forced:k||C},{stringify:function(e,t,i){var r=f(arguments),n=o(k?T:v,null,r);return C&&"string"==typeof n?b(n,w,P):n}})},function(e,t,i){var r=i(5),n=i(93),o=i(16),a=i(42),s=i(24),u=r([].push);e.exports=function(e){if(o(e))return e;if(n(e)){for(var t=e.length,i=[],r=0;r<t;r++){var c=e[r];"string"==typeof c?u(i,c):"number"!=typeof c&&"Number"!=a(c)&&"String"!=a(c)||u(i,s(c))}var l=i.length,f=!0;return function(e,t){if(f)return f=!1,t;if(n(this))return t;for(var r=0;r<l;r++)if(i[r]===e)return t}}}},function(e,t,i){var r=i(1),n=i(87),o=i(3),a=i(123),s=i(25);r({target:"Object",stat:!0,forced:!n||o((function(){a.f(1)}))},{getOwnPropertySymbols:function(e){var t=a.f;return t?t(s(e)):[]}})},function(e,t){var i=Array,r=Math.abs,n=Math.pow,o=Math.floor,a=Math.log,s=Math.LN2;e.exports={pack:function(e,t,u){var c,l,f,h=i(u),d=8*u-t-1,p=(1<<d)-1,v=p>>1,m=23===t?n(2,-24)-n(2,-77):0,y=e<0||0===e&&1/e<0?1:0,g=0;for((e=r(e))!=e||e===1/0?(l=e!=e?1:0,c=p):(c=o(a(e)/s),e*(f=n(2,-c))<1&&(c--,f*=2),(e+=c+v>=1?m/f:m*n(2,1-v))*f>=2&&(c++,f/=2),c+v>=p?(l=0,c=p):c+v>=1?(l=(e*f-1)*n(2,t),c+=v):(l=e*n(2,v-1)*n(2,t),c=0));t>=8;)h[g++]=255&l,l/=256,t-=8;for(c=c<<t|l,d+=t;d>0;)h[g++]=255&c,c/=256,d-=8;return h[--g]|=128*y,h},unpack:function(e,t){var i,r=e.length,o=8*r-t-1,a=(1<<o)-1,s=a>>1,u=o-7,c=r-1,l=e[c--],f=127&l;for(l>>=7;u>0;)f=256*f+e[c--],u-=8;for(i=f&(1<<-u)-1,f>>=-u,u+=t;u>0;)i=256*i+e[c--],u-=8;if(0===f)f=1-s;else{if(f===a)return i?NaN:l?-1/0:1/0;i+=n(2,t),f-=s}return(l?-1:1)*i*n(2,f-t)}}},function(e,t,i){"use strict";var r=i(153),n=i(46);e.exports=r?{}.toString:function(){return"[object "+n(this)+"]"}},function(e,t,i){"use strict";var r=i(1),n=i(6),o=i(19),a=i(20),s=i(280),u=i(17),c=i(132),l=i(101),f=i(81),h=i(44),d=i(281),p=i(45),v=i(209),m=i(211),y=i(97),g=i(21),b=i(46),_=i(23),w=i(86),A=i(47),S=i(43),k=i(83),C=i(91).f,T=i(283),P=i(36).forEach,x=i(150),E=i(39),B=i(29),M=i(80),R=i(34),I=i(213),F=R.get,L=R.set,O=R.enforce,j=B.f,D=M.f,V=Math.round,U=n.RangeError,N=c.ArrayBuffer,W=N.prototype,H=c.DataView,z=u.NATIVE_ARRAY_BUFFER_VIEWS,q=u.TYPED_ARRAY_TAG,G=u.TypedArray,Q=u.TypedArrayPrototype,Y=u.aTypedArrayConstructor,K=u.isTypedArray,J=function(e,t){Y(e);for(var i=0,r=t.length,n=new e(r);r>i;)n[i]=t[i++];return n},X=function(e,t){E(e,t,{configurable:!0,get:function(){return F(this)[t]}})},Z=function(e){var t;return S(W,e)||"ArrayBuffer"==(t=b(e))||"SharedArrayBuffer"==t},$=function(e,t){return K(e)&&!w(t)&&t in e&&d(+t)&&t>=0},ee=function(e,t){return t=y(t),$(e,t)?f(2,e[t]):D(e,t)},te=function(e,t,i){return t=y(t),!($(e,t)&&_(i)&&g(i,"value"))||g(i,"get")||g(i,"set")||i.configurable||g(i,"writable")&&!i.writable||g(i,"enumerable")&&!i.enumerable?j(e,t,i):(e[t]=i.value,e)};a?(z||(M.f=ee,B.f=te,X(Q,"buffer"),X(Q,"byteOffset"),X(Q,"byteLength"),X(Q,"length")),r({target:"Object",stat:!0,forced:!z},{getOwnPropertyDescriptor:ee,defineProperty:te}),e.exports=function(e,t,i){var a=e.match(/\d+/)[0]/8,u=e+(i?"Clamped":"")+"Array",c="get"+e,f="set"+e,d=n[u],y=d,g=y&&y.prototype,b={},w=function(e,t){j(e,t,{get:function(){return function(e,t){var i=F(e);return i.view[c](t*a+i.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,r){var n=F(e);i&&(r=(r=V(r))<0?0:r>255?255:255&r),n.view[f](t*a+n.byteOffset,r,!0)}(this,t,e)},enumerable:!0})};z?s&&(y=t((function(e,t,i,r){return l(e,g),I(_(t)?Z(t)?void 0!==r?new d(t,m(i,a),r):void 0!==i?new d(t,m(i,a)):new d(t):K(t)?J(y,t):o(T,y,t):new d(v(t)),e,y)})),k&&k(y,G),P(C(d),(function(e){e in y||h(y,e,d[e])})),y.prototype=g):(y=t((function(e,t,i,r){l(e,g);var n,s,u,c=0,f=0;if(_(t)){if(!Z(t))return K(t)?J(y,t):o(T,y,t);n=t,f=m(i,a);var h=t.byteLength;if(void 0===r){if(h%a)throw U("Wrong length");if((s=h-f)<0)throw U("Wrong length")}else if((s=p(r)*a)+f>h)throw U("Wrong length");u=s/a}else u=v(t),n=new N(s=u*a);for(L(e,{buffer:n,byteOffset:f,byteLength:s,length:u,view:new H(n)});c<u;)w(e,c++)})),k&&k(y,G),g=y.prototype=A(Q)),g.constructor!==y&&h(g,"constructor",y),O(g).TypedArrayConstructor=y,q&&h(g,q,u);var S=y!=d;b[u]=y,r({global:!0,constructor:!0,forced:S,sham:!z},b),"BYTES_PER_ELEMENT"in y||h(y,"BYTES_PER_ELEMENT",a),"BYTES_PER_ELEMENT"in g||h(g,"BYTES_PER_ELEMENT",a),x(u)}):e.exports=function(){}},function(e,t,i){var r=i(6),n=i(3),o=i(193),a=i(17).NATIVE_ARRAY_BUFFER_VIEWS,s=r.ArrayBuffer,u=r.Int8Array;e.exports=!a||!n((function(){u(1)}))||!n((function(){new u(-1)}))||!o((function(e){new u,new u(null),new u(1.5),new u(e)}),!0)||n((function(){return 1!==new u(new s(2),1,void 0).length}))},function(e,t,i){var r=i(23),n=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&n(e)===e}},function(e,t,i){var r=i(35),n=RangeError;e.exports=function(e){var t=r(e);if(t<0)throw n("The argument can't be less than 0");return t}},function(e,t,i){var r=i(77),n=i(19),o=i(152),a=i(25),s=i(28),u=i(128),c=i(106),l=i(155),f=i(284),h=i(17).aTypedArrayConstructor,d=i(212);e.exports=function(e){var t,i,p,v,m,y,g,b,_=o(this),w=a(e),A=arguments.length,S=A>1?arguments[1]:void 0,k=void 0!==S,C=c(w);if(C&&!l(C))for(b=(g=u(w,C)).next,w=[];!(y=n(b,g)).done;)w.push(y.value);for(k&&A>2&&(S=r(S,arguments[2])),i=s(w),p=new(h(_))(i),v=f(p),t=0;i>t;t++)m=k?S(w[t],t):w[t],p[t]=v?d(m):+m;return p}},function(e,t,i){var r=i(46);e.exports=function(e){var t=r(e);return"BigInt64Array"==t||"BigUint64Array"==t}},function(e,t,i){"use strict";var r=i(25),n=i(75),o=i(28),a=i(167),s=Math.min;e.exports=[].copyWithin||function(e,t){var i=r(this),u=o(i),c=n(e,u),l=n(t,u),f=arguments.length>2?arguments[2]:void 0,h=s((void 0===f?u:n(f,u))-l,u-c),d=1;for(l<c&&c<l+h&&(d=-1,l+=h-1,c+=h-1);h-- >0;)l in i?i[c]=i[l]:a(i,c),c+=d,l+=d;return i}},function(e,t,i){var r=i(287),n=i(133);e.exports=function(e,t){return r(n(e),t)}},function(e,t,i){var r=i(28);e.exports=function(e,t){for(var i=0,n=r(t),o=new e(n);n>i;)o[i]=t[i++];return o}},function(e,t,i){var r=i(6),n=i(3),o=i(5),a=i(24),s=i(135).trim,u=i(136),c=r.parseInt,l=r.Symbol,f=l&&l.iterator,h=/^[+-]?0x/i,d=o(h.exec),p=8!==c(u+"08")||22!==c(u+"0x16")||f&&!n((function(){c(Object(f))}));e.exports=p?function(e,t){var i=s(a(e));return c(i,t>>>0||(d(h,i)?16:10))}:c},function(e,t,i){"use strict";var r=i(20),n=i(93),o=TypeError,a=Object.getOwnPropertyDescriptor,s=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=s?function(e,t){if(n(e)&&!a(e,"length").writable)throw o("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},function(e,t,i){var r=i(1),n=i(219);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==n},{assign:n})},function(e,t,i){"use strict";var r,n=i(1),o=i(92),a=i(80).f,s=i(45),u=i(24),c=i(292),l=i(73),f=i(294),h=i(32),d=o("".endsWith),p=o("".slice),v=Math.min,m=f("endsWith");n({target:"String",proto:!0,forced:!(!h&&!m&&(r=a(String.prototype,"endsWith"),r&&!r.writable)||m)},{endsWith:function(e){var t=u(l(this));c(e);var i=arguments.length>1?arguments[1]:void 0,r=t.length,n=void 0===i?r:v(s(i),r),o=u(e);return d?d(t,o,n):p(t,n-o.length,n)===o}})},function(e,t,i){var r=i(293),n=TypeError;e.exports=function(e){if(r(e))throw n("The method doesn't accept regular expressions");return e}},function(e,t,i){var r=i(23),n=i(42),o=i(15)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==n(e))}},function(e,t,i){var r=i(15)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(i){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},function(e,t,i){var r=i(6),n=i(3),o=i(5),a=i(24),s=i(135).trim,u=i(136),c=o("".charAt),l=r.parseFloat,f=r.Symbol,h=f&&f.iterator,d=1/l(u+"-0")!=-1/0||h&&!n((function(){l(Object(h))}));e.exports=d?function(e){var t=s(a(e)),i=l(t);return 0===i&&"-"==c(t,0)?-0:i}:l},function(e,t,i){var r=i(1),n=i(6),o=i(220)(n.setInterval,!0);r({global:!0,bind:!0,forced:n.setInterval!==o},{setInterval:o})},function(e,t){e.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},function(e,t,i){var r=i(1),n=i(6),o=i(220)(n.setTimeout,!0);r({global:!0,bind:!0,forced:n.setTimeout!==o},{setTimeout:o})},function(e,t,i){var r=i(19),n=i(21),o=i(43),a=i(169),s=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in s||n(e,"flags")||!o(s,e)?t:r(a,e)}},function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(4),i(124),i(0),i(9),i(10),i(11),i(2),i(7),i(8),i(158),i(159),i(160),i(161),i(110),i(111),i(162),i(163),i(112),i(164),i(165),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(134),i(221),i(41),i(222),i(26),i(118),i(40);var n=h(i(170)),o=h(i(117)),a=h(i(234)),s=h(i(324)),u=h(i(328)),c=(h(i(329)),h(i(236)),i(240)),l=h(i(18)),f=h(i(138));function h(e){return e&&e.__esModule?e:{default:e}}function d(){d=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,n=Object.defineProperty||function(e,t,i){e[t]=i.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,i){return e[t]=i}}function l(e,t,i,r){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new T(r||[]);return n(a,"_invoke",{value:function(e,t,i){var r="suspendedStart";return function(n,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===n)throw o;return{value:void 0,done:!0}}for(i.method=n,i.arg=o;;){var a=i.delegate;if(a){var s=S(a,i);if(s){if(s===h)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===r)throw r="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r="executing";var u=f(e,t,i);if("normal"===u.type){if(r=i.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r="completed",i.method="throw",i.arg=u.arg)}}}(e,i,s)}),a}function f(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var h={};function p(){}function v(){}function m(){}var y={};c(y,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(P([])));b&&b!==t&&i.call(b,a)&&(y=b);var _=m.prototype=p.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){var o;n(this,"_invoke",{value:function(n,a){function s(){return new t((function(o,s){!function n(o,a,s,u){var c=f(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==r(h)&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(h).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}(n,a,o,s)}))}return o=o?o.then(s,s):s()}})}function S(e,t){var i=t.method,r=e.iterator[i];if(void 0===r)return t.delegate=null,"throw"===i&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==i&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),h;var n=f(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function P(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:x}}function x(){return{value:void 0,done:!0}}return v.prototype=m,n(_,"constructor",{value:m,configurable:!0}),n(m,"constructor",{value:v,configurable:!0}),v.displayName=c(m,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,u,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},w(A.prototype),c(A.prototype,s,(function(){return this})),e.AsyncIterator=A,e.async=function(t,i,r,n,o){void 0===o&&(o=Promise);var a=new A(l(t,i,r,n),o);return e.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(_),c(_,u,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),i=[];for(var r in t)i.push(r);return i.reverse(),function e(){for(;i.length;){var r=i.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=P,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(i,r){return a.type="throw",a.arg=e,t.next=i,r&&(t.method="next",t.arg=void 0),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),C(i),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;C(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:P(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),h}},e}function p(e,t,i,r,n,o,a){try{var s=e[o](a),u=s.value}catch(e){return void i(e)}s.done?t(u):Promise.resolve(u).then(r,n)}t.default=function(e){var t,i,r;function h(h,v,m,y,g,b,_,w){var A,S,k,C,T,P,x,E,B,M,R,I,F,L,O,j,D,V,U,N,W,H=l.default.create(e,"Track "+v),z=h%parseInt("F0",16),q=n.default.getInstance(e),G=o.default.getInstance(e),Q=(U=v,"vp8"===(N=m)||"vp9"===N?"webm":"opus"===N?q.isCodecSupportedByMediaSource(U,N)?"webm":"pcm":"mp4"),Y=fe(Q),K=c.TRACK_STATE.OPEN,J=_.buffering,X=J*y/1e3,Z=J>=1e3?.2:J/5e3,$=J,ee=[],te=[],ie=!1,re=!1,ne=0,oe=!!_.sapAlignment,ae=!1,se={},ue=!1,ce=[],le=!1;function fe(n){switch(n){case"mp4":return t||(t=new a.default(e)),t.create({fragmentFullGop:_.fragmentFullGop});case"webm":return i||(i=new s.default(e)),i.create();case"pcm":return r||(r=new u.default(e)),r.create();default:return H.error("_buildComposer container not supported"),null}}function he(){void 0!==V&&(clearTimeout(V),V=void 0)}function de(e){e.data&&(D=e.data,Y.setTrackParams(A,{codec:m,codecData:e.data}),C.pushInit(Y.initSegment()))}function pe(e,t){var i=!1;if("mp4"==Q)if(t)if(i=!0,e){var r=t.byteLength;if(r==e.byteLength){i=!1;for(var n=0;n<r;n++)if(t[n]!==e[n]){i=!0;break}}}else H.debug("isInitSegmentNew: current init segment data is empty"),i=!0;else H.error("isInitSegmentNew: received empty codecData");return i}function ve(){return S+1}function me(e){void 0===e&&(e=1e3),$=J=e,X=J*y/1e3,Z=J>=1e3?.2:J/5e3,q.setLowBufferBorder(Z,v[0])}function ye(){for(var e=0;e<ee.length;e++){var t=ee[e];Ae(t.sap,t.data,t.ts,t.offset)}ee=[],te=[],re=!1}function ge(e,t){H.debug("flush all",e);var i=0,r=[];for(i=0;i<ce.length;i++)(void 0===e||ce[i].ts<e)&&r.push(ce[i]);for(ce=[],i=0;i<ee.length;i++)(void 0===e||ee[i].ts<e)&&r.push(ee[i]);if(ee=[],te=[],ie){var n=r.length;for(i=0;i<n;i++)be(r[i],e);t||be(null,e)}C&&C.filterOut(e)}function be(e,t){var i,r,n,o=e?Y.mediaSegment(A,[e]):Y.mediaSegment(A,[],!0);o&&(null==t||o.ts[0]<t)&&(C.pushSegment(o.data,o.ts,o.sap),i=o.ts[0],r=o.sn,n=o.sap[0],T=i,R=r,n&&(E=i))}function _e(e){ee.length>=2&&void 0!==L&&void 0!==A&&(K=c.TRACK_STATE.BUFFER,L(e,ee[0].ts/y),H.debug("process open state, base ts=".concat(ee[0].ts)))}function we(e){var t=(e-T)/y,i=Math.min(S/y,.0715);return[t>0&&t<=i,t,i]}function Ae(e,t,i,r){if(ie)!function(e,t,i,r){var n;if(ue){if(Se(ce,t,i,r,e),ce[ce.length-1].ts-ce[0].ts>=$*y/1e3){var o=ce.splice(0,1);n={data:o[0].data,ts:o[0].ts,offset:o[0].offset,sap:o[0].sap}}}else n={data:t,ts:i,offset:r,sap:e};P=i,x=r,n&&be(n)}(e,t,i,r);else if(e){if(le&&c.TRACK_STATE.CLOSED!==K){var n={codec:m};D&&(n.codecData=D),Y.setTrackParams(A,n),C.pushInit(Y.initSegment(),we(i)[0]),le=!1}!function(e,t,i){Y.setBaseSample(A,e,t,i),H.debug("process first frame",T,P,t),T=void 0,E=void 0,P=t,x=i,ie=!0}(t,i,r)}}function Se(e,t,i,r,n){e.push({data:t,ts:i,offset:r,sap:n})}w.add(z,v,y),this.setupMediaService=function(){q.setupMediaApi(v,m),q.setLowBufferBorder(Z,v[0])},this.attachToMediaService=function(){H.debug("attachToMediaService"),(C=q.createSourceBuffer(v,m,y,g)).removeAll()},this.isAttachedToMedia=function(){return void 0!==C},this.setupCaptions=function(){},this.id=function(){return z},this.timescale=function(){return y},this.getBufferedStart=function(){var e;return ee.length>0&&(e=ee[0].ts),e},this.getAudioInfo=function(){return Y.getTrackAudioInfo(A)},this.inTransition=function(e){return void 0!==e&&(ae=e,se={}),ae},this.setTransitionParams=function(e){(se=e).container=["vp8","vp9","opus"].includes(se.codec)?"webm":"mp4"},this.isTransitionSupported=function(){var e=!1;return se&&se.container==Q&&(e=q.isCodecSupported(v,se.codec)),e||H.error("transition is not supported: ",m),e},this.startTransition=function(e){se.mode=void 0!==e?e:c.TRANSITION_MODE.SMOOTH,se.initSegment=void 0,se.startupBuffer=[],se.initDataBuffer=[],se.curStreamCancelled=!1,se.newSapTimes=[],se.curSapTimes=[],ue=!0,w.add(se.id,v,y),q.setTransitOn(),H.debug("transit started",se.id)},this.setSapAlignment=function(e){oe=e},this.setBuffering=function(e){me(e)},this.getStreamName=function(){return b},this.getTransitionStreamName=function(){return se.name},this.transitionStreamId=function(){return se.id},this.type=function(){return v},this.latency=function(e){var t,i=w.getMetrics(z);return i&&(t=performance.now()/1e3-e-i.latencySubt),t},this.isVideo=function(){return"video"==v},this.isAudio=function(){return"audio"==v},this.isActual=function(){return c.TRACK_STATE.CLOSED!=K},this.isInited=function(){return void 0!==A},this.isTransitionInited=function(){return void 0!==se.cTrackId},this.isOpen=function(){return c.TRACK_STATE.OPEN==K},this.isBuffering=function(){return c.TRACK_STATE.BUFFER==K},this.isBackingUp=function(){return c.TRACK_STATE.BACKUP==K},this.isStarving=function(){var e=!1;if(c.TRACK_STATE.BUFFER==K||c.TRACK_STATE.OPEN==K){var t=w.getMetrics(z).avgBandwidth(),i=w.getMetrics(z).avgRate();e=t>0&&1.5*t<i,H.debug("video is "+(e?"starving":"not starving"),t,i)}return e},this.sapOffset=function(){var e=1e3*(1+(P-E)/y);return e<4e3&&(e+=1e4),isNaN(e)?1e4:e},this.reset=function(){H.debug("reset "+b),K=c.TRACK_STATE.OPEN,C&&C.removeAll(),Y.reset(),A=void 0,ee=[],te=[],ce=[],S=void 0,ie=!1,re=!1,k=void 0,ae=void 0,ne=0,w.remove(z),ue&&(w.remove(se.id),z=se.id,_=se.streamOptions,b=se.name),w.add(z,v,y),ue=!1,se={},I=void 0,T=void 0,P=void 0,x=void 0,E=void 0,B=void 0,M=void 0,me(void 0!==_.buffering?_.buffering:J),le=!1,D=void 0,he()},this.close=function(){H.debug("track close"),K=c.TRACK_STATE.CLOSED,C&&(C.closed=!0),Y.free(),Y=void 0,ee=[],te=[],w.remove(z),void 0!==se.id&&w.remove(se.id),he()},this.backup=function(){var e;return C.closed=!0,this.isTransitionInited()?(H.debug("backup track, transition is inited"),se.curStreamCancelled||(O(this),se.curStreamCancelled=!0),I={bufferLength:C.getBufferingLength()},this.completeTransition(),ee.length>0&&(e=ee[0].ts/y)):(I=C.getSegments(),H.debug("backup track",I.segments.length,I.start),I.init&&I.segments&&I.segments.length>I.start&&(K=c.TRACK_STATE.BACKUP,e=I.segments[I.start].ts/y,L(this,e))),e},this.recover=function(){if(I)if(K=c.TRACK_STATE.ACTIVE,I.init){H.debug("recover track");var e=0,t=0,i=I.segments.length;for(e=I.start;e<i;e++)if(I.segments[e].init)I.init=I.segments[e].data;else{if(!(I.segments[e].ts<=k))break;I.segments[e].sap&&(t=e)}for(C.pushInit(I.init),e=t;e<i;e++){var r=I.segments[e];r.init?C.pushInit(r.data):C.pushSegment(r.data,[r.ts],[r.sap])}(i-t-1>0||ee.length>0)&&(H.debug("recover sapSet = true",i,t,ee.length),ie=!0),ge(void 0,!0)}else void 0!==I.bufferLength&&(H.debug("recover track from transition"),q.setTransitOn(),C.setBufferingLength(I.bufferLength),this.applyTransition(!0))},this.populateInitDataBuffer=function(e){te.push({idx:ee.length,data:e}),H.debug("Recover populateInitDataBuffer",e.byteLength)},this.populateStartupBuffer=function(e,t,i,r){Se(ee,t,i,r,e),P=i,x=r,H.debug("Recover populateStartupBuffer",e,t.byteLength,i,r)},this.isRecoverable=function(){return I&&(void 0!==I.init||void 0!==I.bufferLength)},this.flush=function(){ge()},this.buffer=function(){K=c.TRACK_STATE.BUFFER,H.debug("buffering...")},this.setBufferDelay=function(){re=!0},this.activate=function(){c.TRACK_STATE.BUFFER===K&&(ye(),K=c.TRACK_STATE.ACTIVE,F())},this.bufferStatus=function(t){var i={lvl:void 0,low:!1};if(c.TRACK_STATE.ACTIVE==K){var r=0;i.lvl=0,P&&(r=Y.getRealTs(A,P+x)/y,i.lvl=r-t,i.lvl<0&&(i.lvl=0)),q.setCurrentBufferLevel(v,m,i.lvl),f.default.display(e,v+"-buffer",i.lvl.toFixed(4)),le||(i.lvl<Z&&(H.debug("bufferStatus low buffer ",t,P+x),w.reportLowBuffer(z),i.low=!0),w.reportBufLevel(z,i.lvl,r))}return i},this.updateBufferedState=function(t,i){if(c.TRACK_STATE.BUFFER==K){var r=0,n=0,o=0;B&&((n=(r=Y.getRealTs(A,B+M)/y)-i)<0&&(n=0),(o=r-t)<0&&(o=0)),q.setCurrentBufferLevel(v,m,n),f.default.display(e,v+"-buffer",n.toFixed(4)),H.debug("updateBufferedState: buf lvl "+o+", real buf lvl "+n,t,i),le||re||(o<Z&&(H.debug("updateBufferedState: low buffer"),w.reportLowBuffer(z)),w.reportBufLevel(z,o,r))}},this.setBaseDecodeTime=function(e){k=Math.floor(e*y+.5)},this.onBaseDecodeTimeReady=function(e){L=e},this.onSourceReady=function(e){F=e},this.onCancelStream=function(e){O=e},this.onTransitionCompleted=function(e){j=e},this.initPresentation=function(e){var t={timescale:y};if("mp4"==Q&&(t.codecData=e,D=e),t.codec=m,"video"===v&&(t.width=_.width,t.height=_.height),A=Y.addTrack(v,t).id,"audio"===v){var i=this.getAudioInfo();H.debug("init presentation set channel count ".concat(i.channels)),i&&G.setChannelCount(i.channels)}C.pushInit(Y.initSegment()),H.debug("init segment pushed, codec = ".concat(t.codec,", timescale = ").concat(t.timescale))},this.isInitSegmentNew=function(e){return"audio"==v||pe(D,e)},this.isTransitionInitNew=function(e){return"audio"==v||pe(se.initSegmentData,e)},this.processInitSegment=function(e){var t={syncBase:!0};"audio"==v&&(t.alignBase=!0),Y.setTrackParams(A,t),ge(),ie=!1,le=!0,D="mp4"==Q?e:void 0,H.debug("new init segment processed")},this.initTransition=function(e){var t={timescale:y};t.codec=se.codec,se.composer=fe(se.container),"mp4"==se.container&&(se.initSegmentData=e,t.codecData=e),"video"==v&&(t.width=se.streamOptions.width,t.height=se.streamOptions.height),se.cTrackId=se.composer.addTrack(v,t).id,se.initSegment=se.composer.initSegment(),se.initDataBuffer=[],H.debug("transit stream init segment pushed")},this.processTransitionInitSegment=function(e){se.initDataBuffer.push({idx:se.startupBuffer.length,data:e})},this.processMute=function(e,t){if(void 0!==A){var i;switch(K){case c.TRACK_STATE.OPEN:case c.TRACK_STATE.BUFFER:i=0==ee.length?void 0!==(i=t.getBufferedStart())?y/t.timescale()*i:void 0!==P?P:y/t.timescale()*e-X:ee[ee.length-1].ts;break;case c.TRACK_STATE.ACTIVE:i=P;break;default:H.error("processMute unexpected track state",K)}if(void 0!==i){var r=y/t.timescale()*e,n=r-i;if(n>=X/2){n>2*X&&(r=i+(n=2*X)),r-=X/10;var o=Y.getTrackSampleDuration(A),a=i+o;for(H.debug("processMute filling gap",i,r);a<=r;)this.processFrame(!0,null,Math.floor(a),0),a+=o}}}},this.processFrame=function(e,t,i,r){var n={done:!0};if(B=i,M=r,ue){if(se.curStreamCancelled)return n;if(H.debug("processFrame transition, current frame ts=".concat(i,", offset=").concat(r,", sap=").concat(e)),e&&se.curSapTimes.push(i),se.curStreamLastBufferedTs=i,function(e,t){var i=!1,r=se.newSapTimes.length;if(c.TRANSITION_MODE.ABRUPT==se.mode)i=!0;else if(r>0)if(oe)t&&(e>=se.newSapTimes[0]||e>=se.newSapTimes[r-1])&&(i=!0);else if(e>=se.newSapTimes[0]+$*y/1e3*2)H.debug("Cancel current stream, because current timestamp is twice ahead possible buffer of new stream",e,se.newSapTimes[0]),i=!0;else for(var n=se.newSapTimes.length-1;n>=0;n--){if(Math.abs(e-se.newSapTimes[n])<ve()){H.debug("Cancel current stream. Timestamp "+e+" is near new stream key frame "+se.newSapTimes[n]),i=!0;break}if(e>se.newSapTimes[n])break}return i}(i,e))return H.debug("processFrame cancel current rendition",se.curStreamLastBufferedTs,e),O&&O(this),se.curStreamCancelled=!0,Se(ee,t,i,r,e),n}switch(K){case c.TRACK_STATE.OPEN:(ee.length>0||e)&&(Se(ee,t,i,r,e),_e(this));break;case c.TRACK_STATE.BUFFER:var o=!1;if(Se(ee,t,i,r,e),!Y.isReady())break;var a=ee.length;if(void 0===S){if(void 0!==k&&a>3){var s=ee[a-1],u=s.ts-k-X;if(u>=0){H.debug("finished buffering, have "+a+" samples"),function(){S=0;var e=0,t={};for(e=1;e<ee.length;e++){var i=ee[e].ts-ee[e-1].ts;t[i]=t[i]>0?t[i]+1:1}var r=0;for(e in t)if(t[e]>r){var n=parseInt(e);n>0&&(S=n,r=t[e])}H.debug("max sample duration calculated: ",S,JSON.stringify(t))}(),w.setRateAdditive(z,S),q.startLogging(v,m,C.streamId),C.setBufferingLength(a),ie=!1;for(var l,f=0,h=0;h<a&&ee[h].ts<=k;h++)ee[h].sap&&(f=h);H.debug("base decode time:",k),H.debug("1 ts last ts",ee[0].ts,ee[0].sap,ee[a-1].ts),H.debug("buffer size: "+a+" first sap: "+f);var d=0;for(d=0;d<te.length&&te[d].idx<=f;d++)l=te.shift(),d--;for(l&&de(l),d=f;d<ee.length;d++){te.length>0&&d==te[0].idx&&de(te.shift());var p=ee[d];Ae(p.sap,p.data,p.ts,p.offset)}te.length>0&&de(te[0]),ee=[],te=[],o=!0}else-1*u>10*X&&(H.error("sample is far away from expected",s.ts,k+X),n.done=!1,ne++)}}else{var g=ee[a-1].ts-ee[0].ts;g>0?o=g>=X:g<0&&(o=a>=X/S+1),o&&ye()}o&&c.TRACK_STATE.CLOSED!==K&&(K=c.TRACK_STATE.ACTIVE,F(),H.debug("track is ready for playback"));break;case c.TRACK_STATE.ACTIVE:Ae(e,t,i,r)}return n.done?ne=0:n.errors=ne,n},this.processTransitionFrame=function(e,t,i,r){var n={done:!0};if(e)se.newSapTimes.push(i);else if(0==se.newSapTimes.length)return n;var o=se.startupBuffer.length;if(o>0){null==se.lastSampleDuration&&(se.lastSampleDuration=void 0!==S?S:0);var a=se.startupBuffer[o-1],s=i-a.ts;s<0?r>=-1*s?(r+=s,s=0):s=se.lastSampleDuration:s>2*y&&(s=se.lastSampleDuration),i=a.ts+s,se.lastSampleDuration=s}if(Se(se.startupBuffer,t,i,r,e),function(e,t){var i=!1,r=$*y/1e3,n=se.curSapTimes.length,o=se.newSapTimes.length,a=e-se.startupBuffer[0].ts;if(oe&&c.TRANSITION_MODE.ABRUPT!=se.mode){if(a>=r)if(n>0){for(var s=0,u=0;u<n;u++)if(!(se.curSapTimes[u]<se.newSapTimes[s]||se.curSapTimes[u]<=T)){for(var l=s;l<o&&(s=l,!(se.newSapTimes[l]>se.curSapTimes[u]));l++)se.newSapTimes[l]==se.curSapTimes[u]&&(H.debug("Switch to new stream because of SAP alignment"),i=!0);if(i)break}}else o>0&&(H.debug("No current stream frames, switch to new stream"),i=!0);!i&&n>=1&&o>=2&&(se.newSapTimes[o-1]>se.curSapTimes[0]||se.newSapTimes[o-1]>=se.curSapTimes[n-1])&&(H.debug("Switch to new stream SAP alignment does not work!"),i=!0)}else if(a>=2*r&&(e>=se.curStreamLastBufferedTs||null==se.curStreamLastBufferedTs))H.debug("Switch to new stream because transition buffer is twice filled"),i=!0;else if(a>=r)if(se.curStreamCancelled&&(e>=se.curStreamLastBufferedTs||null==se.curStreamLastBufferedTs))H.debug("Switch to new stream because buffer is filled and current stream is cancelled"),i=!0;else{for(var f=se.newSapTimes.length-1;f>=0;f--){if(Math.abs(se.curStreamLastBufferedTs-se.newSapTimes[f])<ve()){H.debug("Switch to new stream, because new key frame "+se.newSapTimes[f]+" is near to current latest timestamp "+se.curStreamLastBufferedTs),i=!0;break}if(se.curStreamLastBufferedTs>se.newSapTimes[f])break}!i&&e+2*r<se.curStreamLastBufferedTs&&a>=10*y&&(H.error("Error: new stream is "+(se.curStreamLastBufferedTs-e)/y+" seconds behind previous stream. Halting."),i=!0)}return i}(i)){se.curStreamCancelled||(H.debug("processTransitionFrame cancel current rendition"),O(this),se.curStreamCancelled=!0);var u=P;se.curStreamLastBufferedTs&&se.curStreamLastBufferedTs>u&&(u=se.curStreamLastBufferedTs);var l=se.newSapTimes[0],f=0,h=Math.abs(se.newSapTimes[0]-u);for(f=se.newSapTimes.length-1;f>=1;f--){var d=Math.abs(se.newSapTimes[f]-u);d<h&&(h=d,l=se.newSapTimes[f])}for(ge(l),f=0;f<se.startupBuffer.length&&!(se.startupBuffer[f].ts>=l);f++);if(f>0){var p;se.startupBuffer.splice(0,f);for(var v=0;v<se.initDataBuffer.length;v++)se.initDataBuffer[v].idx<=f?(p=se.initDataBuffer.shift(),v--):se.initDataBuffer[v].idx-=f;p&&(se.composer.setTrackParams(se.cTrackId,{codec:se.codec,codecData:p.data}),se.initSegment=se.composer.initSegment())}var m=we(l);if(C.pushInit(se.initSegment,m[0]),ue){var g=m[1];H.debug("transit buffer length = ".concat(se.startupBuffer.length)),H.debug("===== Rendition switch GAP ===== ".concat(1e3*g," msec, allowance = ").concat(1e3*m[2])),this.completeTransition(),this.applyTransition(),-g>10&&(n.done=!1,H.error("Correct rendition switch isn't possible, gap is too big (".concat(g,"s). Reloading stream.")))}}return n},this.completeTransition=function(){if(ee=se.startupBuffer,se.startupBuffer=[],se.composer.setTrackParams(se.cTrackId,{sequenceNumber:R+1}),w.remove(z),z=se.id,_=se.streamOptions,b=se.name,A=se.cTrackId,m=se.codec,Q=se.container,y=se.timescale,ie=!1,k=void 0,S=void 0,ae=!1,ue=!1,ne=0,Y.free(),Y=se.composer,q.setupMediaApi(v,m),se.buffering&&(J=se.buffering),me(J),D=se.initSegmentData,te=se.initDataBuffer,se={},le=!1,T=void 0,E=void 0,B=void 0,M=void 0,ee.length>0){var e=ee[ee.length-1];P=e.ts,x=e.offset}},this.applyTransition=function(e){if(e&&D&&de(D),j(this),K=c.TRACK_STATE.OPEN,_e(this),ee.length>=2){var t=ee.splice(ee.length-1,1)[0];this.processFrame(t.sap,t.data,t.ts,t.offset)}q.setPositionControl(),q.setTransitOff()},this.suspendMuteable=function(){"audio"===v&&(Y.isTrackSilent(A)||(he(),V=setTimeout((function(){V=void 0}),5e3)))},this.isMuteable=function(){return void 0===V},this.postInit=(W=d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("audio"!==v||"pcm"!==Y){e.next=3;break}return e.next=3,Y.postInit();case 3:case"end":return e.stop()}}),e)})),function(){var e=this,t=arguments;return new Promise((function(i,r){var n=W.apply(e,t);function o(e){p(n,i,r,o,a,"next",e)}function a(e){p(n,i,r,o,a,"throw",e)}o(void 0)}))})}return{create:function(e,t,i,r,n,o,a,s,u){return new h(e,t,i,r,n,o,a,s,u)}}}},function(e,t,i){"use strict";var r=i(35),n=i(24),o=i(73),a=RangeError;e.exports=function(e){var t=n(o(this)),i="",s=r(e);if(s<0||s==1/0)throw a("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(t+=t))1&s&&(i+=t);return i}},function(e,t,i){"use strict";var r=i(22),n=i(178),o=TypeError;e.exports=function(e){if(r(this),"string"===e||"default"===e)e="string";else if("number"!==e)throw o("Incorrect hint");return n(this,e)}},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(40),i(2),i(4),i(7),i(8),i(304),i(309),i(118),i(79),i(26),i(227),i(222),i(221);var r=f(i(310)),n=f(i(311)),o=f(i(115)),a=f(i(232)),s=f(i(171)),u=f(i(114)),c=f(i(18)),l=f(i(138));function f(e){return e&&e.__esModule?e:{default:e}}var h=0,d=1,p=2,v=3,m=function(){var e=s.default.getInstance();function t(t){var s,f,m,y,g,b,_,w,A,S,k,C,T,P,x,E,B,M,R,I,F,L=c.default.create(t,"MSE"),O=[],j=!1,D={},V=!1,U=h,N=!1,W={value:0,count:0,time:0},H={frames:0,count:0,time:0,seekCount:0},z=!1,q=-1,G=0,Q=0,Y=0,K=0,J=new a.default(t).create(10),X=!1,Z=[],$=0,ee=!1,te=0,ie={timeShift:0,bufferSize:0,start:void 0,integralDist:0,lastZapTime:0,PERIOD:4e3,SYNC_BORDER:e.isIOS()?.052:.04},re={enter:void 0,exit:void 0,time:void 0,bufTime:void 0,background:!1,stopBuffer:!1,vThreshold:1200,aThreshold:3600,ready:!1,seekTo:void 0,seekInd:void 0,audioOnly:!1,initStart:!1},ne={activated:!1,from:void 0,to:void 0},oe=o.default.getInstance(t),ae=new r.default,se=new n.default(t);function ue(){if(null==re.enter&&(re.enter=performance.now(),re.initStart=!j),null==re.time&&f){re.time=f.currentTime;var e=f.buffered.length;e>0&&(re.bufTime=f.buffered.end(e-1)-f.currentTime)}re.exit=void 0,re.ready=!1}function ce(){re.stopBuffer=!1,re.audioOnly=!1,re.forcePlay=!1,re.bufTime=void 0,re.seekInd=void 0,re.seekTo=void 0,re.enter=void 0,re.time=void 0,re.exit=void 0,re.ready=!1}function le(){ne.activated=!1,ne.from=void 0,ne.to=void 0,ne.aTime=void 0,ne.lastCurTime=void 0}function fe(){void 0!==w&&(clearTimeout(w),w=void 0)}function he(){void 0!==A&&(clearTimeout(A),A=void 0)}function de(){void 0!==_&&(clearTimeout(_),_=void 0)}function pe(){de(),_=setTimeout(ve,6e3)}function ve(){L.error("error seek timeout!"),_=void 0,U>d&&T("mse",e.isBrowser("Firefox")),U=h}function me(e,t){var i;void 0===t&&(t=we());for(var r=0;r<t.length;r++)if(e<t[r][1]&&t[r][1]-t[r][0]>=$){i=e>=t[r][0]?t[r][1]-e>=$/2?e:t[r][1]-$/2:t[r][0];break}return void 0===i&&(i=t[t.length-1][1]-$)<t[t.length-1][0]&&(i=t[t.length-1][0]),ye(i),i}function ye(e){var t=f.currentTime;return h===U&&t!=e&&(e=u.default.truncateDecimals(e,4),oe.setCurrentTime(e),U=p),e}function ge(e){var t=f.currentTime;if(U>h)return t;var i=e-t,r=i+1;if(0==f.currentTime)t=ye(e);else{var n;if(i>0)r=i>2?3:.25*Math.ceil(r/.25),n=u.default.truncateDecimals(i/(r-1));else if(r<0)n=-i,r=0;else{var o=Math.floor(r/.25);0===o&&(o=1),r=.25*o,n=Math.abs(u.default.truncateDecimals(i/(r-1)))}L.debug("zapping from ".concat(t," to ").concat(e," with rate"),r,n,i,r>1?(r-1)*n:(1-r)*n),oe.setPlaybackRate(r),Ce(!0),se.reset(oe,e),ae.start((function(){Pe(!0)}),1e3*n),t=e}return t}function be(){if(f&&f.buffered.length>0){for(var e=0;e<O.length;e++)O[e].buffered.length>0&&L.debug(O[e].streamId+": "+O[e].buffered.start(0),O[e].buffered.end(0));try{(function(){var e=f.currentTime,t=!1,i=we(),r=i.length;if(r>0){if(e<i[0][0])L.debug("Current position (".concat(e,") is behind the start of the first buffered range (").concat(i[0][0],"). Seek to the start.")),e=i[0][0],t=!0;else for(var n=1;n<r;n++)if(e>=i[n-1][1]&&e<i[n][0]&&i[n][1]-i[n][0]>=$){e=i[n][0],L.debug("Current position is between "+(n-1)+" and "+n+" . Seek to the start of "+n),t=!0;break}if(t)ye(e),fe();else if(!X)if(W.value==f.currentTime&&W.value!==D.playbackTime){W.count+=1;var o=(performance.now()-W.time)/1e3;if(W.count>10&&o>2){var a=f.currentTime+o,s=Be(a);void 0===s&&(s=a),L.debug("Stuck on ".concat(W.value,". Seek to ").concat(s)),me(s,i),fe(),t=!0}}else W.time=performance.now(),W.value=f.currentTime,W.count=1}return t})()&&_e(),re.background&&null==re.enter&&ue(),j=!0}catch(e){L.debug("seek to buffered start failed: ",e)}}}function _e(){D.playbackTime=f.currentTime}function we(){var e=[],t=O.length;if(t>1){for(var i=[],r=0;r<t;r++)for(var n=0;n<O[r].buffered.length;n++)i.push([O[r].buffered.start(n),0]),i.push([O[r].buffered.end(n),1]);i.sort((function(e,t){return e[0]-t[0]}));for(var o=0,a=0;a<i.length;a++)0==i[a][1]?t==++o&&e.push([i[a][0],void 0]):t-1==--o&&(e[e.length-1][1]=i[a][0])}else if(t>0)for(var s=0;s<O[0].buffered.length;s++)e.push([O[0].buffered.start(s),O[0].buffered.end(s)]);return e}function Ae(e){var t=0;return Z.length>0&&(t=Z[0],e&&2==Z.length&&Z[1]<t&&(t=Z[1])),t}function Se(){var e=f.currentTime,t=oe.getPauseTime();if(t&&(e+=(performance.now()-t)/1e3),void 0===g||e-g>30)for(var i=0;i<O.length;i++){var r=O[i];if(r.buffered.length>0){var n=e-30;n-r.buffered.start(0)>60&&(r.removeRange(0,Math.floor(n+.5)),g=e)}}}function ke(e){L.debug("onSeekStartEvent"),Ce()}function Ce(e){j&&(L.debug("Seek start",f.currentTime,e),U=e?v:p,e||pe())}function Te(){Pe()}function Pe(e){if(L.debug("Seek end",e),e)return U=d,void setTimeout((function(){U=h}),500);if(de(),U=h,re.forcePlay){var t=f.play();void 0!==t&&t.catch((function(e){L.error("_onSeekEnd play() error:",e)})),re.forcePlay=!1}}function xe(e){var t=function t(){if(!V){for(var i=0;i<O.length;i++)O[i].removeEventListener("updateend",t);e()}};if(V)for(var i=0;i<O.length;i++)O[i].addEventListener("updateend",t);else e()}function Ee(){if(f){var e=O.length;if(0!==e){for(var i=0;i<e;i++)if(O[i].closed)return void L.debug("onProgressEvent source buffer ".concat(i," is closed, exit"));if(!j)return L.debug("onProgressEvent seek to buffer start"),void xe((function(){be()}));if(oe.isPaused())return L.debug("onProgressEvent playback is paused, exit"),void Se();if(re.background)L.debug("onProgressEvent tab is under background trottling, exit");else{var r=f.currentTime;if(0!==r)if(N){L.debug("onProgress: wait state");var n=r+(performance.now()-b)/1e3;P("mse",n,r)}else{var o=E("mse",r);if(l.default.display(t,"latency",o.toFixed(4)),C("mse",r,o),U!==h||V||!f||f.ended||null!=re.exit)L.debug("onProgress skip, seekInProgress = ".concat(U,", removeInProgress = ").concat(V));else{var a=we();if(a.length>0){var s=m?m.buffered:f.buffered,u=s.length,c=!1;if(ne.activated&&(ne.from>r&&(r>ne.lastCurTime?ne.lastCurTime=r:r==ne.lastCurTime&&(ne.from=ne.lastCurTime)),void 0!==ne.to)){var d=s.start(u-1);L.debug("onProgress initswitch data to = ".concat(ne.to,", curTime = ").concat(r,", bufRangeStart = ").concat(d,", videoBufEnd = ").concat(s.end(u-1))),d!=ne.to&&d>=r&&(d<ne.to?ne.to-d<2&&(ne.to=d):(d-ne.to<2||u>1&&s.end(u-2)-ne.to<Q)&&(ne.to=d));var p=ne.to-r;ne.from<=r&&(ne.to<=s.end(u-1)-.9*Q||p<.1)&&(p>0&&(ne.to==d?(L.debug("initswitch seek to range start "+d+" from "+r,s.start(u-1),s.end(u-1)),ye(d)):(L.debug("initswitch seek to "+ne.to+" from "+r,s.start(u-1),s.end(u-1)),me(ne.to,a)),c=!0),le())}if(!c&&null==ne.to){var v=Ae(!0);if(null==A&&!X){var y=performance.now();if(q>0){if(v>q+.1&&v>Q+.1){var g=r+v-Q-.1;if(null==I||I<g-5){if(y-G>3e3){var _=F?g-.05:function(e){if(void 0===m)return e;for(var t,i=J.length()-1;i>=0;i--){var r=J.get(i);if(r<f.currentTime+.021||r<e-Y)break;if(r<e+K){t=r,L.debug("Found keyframe around ".concat(r));break}}return t}(g);_&&(L.debug("Adjust latency",_,v,_-r),I=F?ge(g):me(_,a),B("mse",r,I),G=y)}}else L.debug("Latency is not adjusted, try next time");c=!0}}else ie.bufferSize>0&&(c=function(e,t,i){var r=!1,n=performance.now();if(n-ie.lastZapTime>ie.PERIOD){var o=(n-ie.timeShift-ie.bufferSize)/1e3;if(o>e){var a=Math.min(Q,.5),s=e+Ae()-a,u=t.end(t.length-1)-a;s>u&&(s=u),s<=e?o=e:s<o&&(o=s)}var c=o-e,l=Math.abs(c),f=!1;if(l>.1?f=!0:l>ie.SYNC_BORDER&&(ie.integralDist+=c,L.debug("Integral distance for zapping",ie.integralDist,l),void 0===ie.start&&(ie.start=n),n-ie.start>15e3?(ie.start=n,ie.integralDist=c):Math.abs(ie.integralDist)>=4&&l>=.02&&(f=!0,L.debug("zapping by integral decision",ie.integralDist))),f){if(ie.integralDist=0,ie.start=void 0,l>3){var h=Be(o,!1,.5);null==h&&(h=o),me(h,i)}else ie.lastZapTime=n,ge(o);r=!0}}return r}(r,s,a));if(!c&&!ie.bufferSize&&ee&&y-te>4e3){var w=R("mse");if(w>0){var S=Q-w,k=Q-Ae();if(S>.14&&k>.12){var T=Math.min(S,k);L.debug("Realign avg buffer level by ",k,Q),ge(r-T+.05),te=y,c=!0}}}}if(!c&&null==ne.to&&(I=void 0,m&&f.getVideoPlaybackQuality&&!X)){var x=f.getVideoPlaybackQuality().totalVideoFrames;if(x==H.frames&&0!==H.time&&D.playbackTime!==r){if(0==H.seekCount){H.count++;var M=(performance.now()-H.time)/1e3;if(H.count>10&&M>3&&(M>=v&&(M=v-.1),M>0)){var W=r+M,z=Be(W);void 0===z&&(z=W),L.debug("Decoder freeze on ".concat(H.frames,". Seek to ").concat(z,".")),me(z,a),H.seekCount++,c=!0}}}else H.time=performance.now(),H.frames=x,H.count=1,H.seekCount=0}}c||Se()}}}else L.debug("onProgressEvent media element is at null position, exit")}}else L.debug("onProgressEvent no source buffers, exit")}else L.debug("onProgressEvent no media element, exit")}function Be(e,t,i){if(void 0===m)return e;var r=void 0===i?0:e-i;void 0===t&&(t=!0);for(var n,o=t?f.currentTime+.021:r,a=J.length()-1;a>=0;a--){var s=J.get(a);if(s<o||s<r)break;if(s<e+.1){n=s,L.debug("Found nearest keyframe ".concat(s));break}}return n}ae.setController(se),document.addEventListener("visibilitychange",(function(){f&&f.currentTime>0&&(document.hidden?(ue(),ae.interrupt()):re.background&&(oe.isPaused()?ce():function(){var e=performance.now();if(re.stopBuffer)re.ready=!0;else if(!re.ready&&f&&f.buffered.length>0){if((e-re.enter)/1e3>2*(f.currentTime-re.time))f.buffered.end(f.buffered.length-1)-f.currentTime>re.bufTime&&(re.ready=!0)}re.ready?(re.exit=e,re.audioOnly=null==m&&void 0!==y):ce()}()),re.background=document.hidden)})),this.startLogging=function(e){z=!1,void 0===S&&(S={}),void 0===S[e]&&(S[e]={times:[],prevTime:0,sumTime:0,stamps:[],gaps:[],thresh:60,avg:void 0})},this.setPositionControl=function(){fe(),w=setTimeout((function(){fe()}),3e4)},this.setTransitOn=function(){X=!0},this.setTransitOff=function(){X=!1,q>0&&(he(),A=setTimeout((function(){he()}),5e3))},this.setLatencyTolerance=function(t,i,r){(q=t)>0&&q<3.5&&e.isBrowser("Microsoft")&&(q=3.5),F=!!r,Q=i,Y=Math.min(.2*i,.5),K=Math.min(.1*i,.3)},this.toggleBufferLineUp=function(e){ee=!!e},this.setLowBufferBorder=function(e){$=e},this.setCurrentBufferLevel=function(e,t){2==O.length?Z["v"==e[0]?0:1]=t:Z[0]=t},this.init=function(e,t){return k?((s=new MediaSource).addEventListener("sourceopen",t||k),(f=e).addEventListener("progress",Ee),f.addEventListener("timeupdate",Ee),f.addEventListener("seeking",ke),f.addEventListener("seeked",Te),f.src=URL.createObjectURL(s),oe.init(f),!f.getVideoPlaybackQuality&&"webkitDecodedFrameCount"in f&&(f.getVideoPlaybackQuality=function(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount}}),!0):(L.error("Error: necessary callbacks are not defined."),!1)},this.createSourceBuffer=function(t,r,n,o){L.debug("createSourceBuffer",t,r,n,o);var a=s.addSourceBuffer(i(t,r));function u(e,t){e.updating?e.addEventListener("updateend",(function i(){e.updating||(e.removeEventListener("updateend",i),t())})):t()}return a.mode="segments",a.initSegment=void 0,a.segments=[],a.initPositions=[],a.sapPositions=[],a.appendedCount=0,a.bufferLength=0,a.fBufferLength=0,a.timescale=n,a.isVideo="video"==t,a.isVideo?m=a:y=a,a.filterOut=function(e){if(void 0!==e)for(var t=this.segments.length,i=0;i<t;i++)if(this.segments[i].ts>=e){var r=t-i;this.segments.splice(i,r),this.adjustPositions(i,!0),i<this.appendedCount&&(this.appendedCount=i);break}},a.getBufferingLength=function(){return this.bufferLength},a.setBufferingLength=function(e){this.bufferLength=e,this.fBufferLength=e},a.pushInit=function(e,t){var i={init:!0,data:e};if(this.isVideo&&!t){var r,n=this.segments.length;n>0&&(this.segments[n-1].ts?r=this.segments[n-1].ts:n>1&&this.segments[n-2].ts&&(r=this.segments[n-2].ts),void 0!==r&&(ne.from=r/this.timescale,ne.activated=!0,L.debug("initswitch set from = ".concat(ne.from))))}this.segments.push(i),this.initPositions.push(this.segments.length-1),this.appendNextSegment()},a.pushSegment=function(e,t,i){var r=this.isVideo?re.vThreshold:re.aThreshold;if(re.background&&!re.stopBuffer&&this.segments.length>r&&(L.debug("Throttle segments buffer",r),re.stopBuffer=!0),!re.background||!re.stopBuffer){var n={data:e,ts:t[0],sap:i[0]};re.ready&&(this.isVideo||re.audioOnly)&&n.sap&&(n.starter=!0,re.ready=!1),this.segments.push(n),this.isVideo&&n.sap&&this.sapPositions.push(this.segments.length-1),this.appendNextSegment()}z&&this.log(t)},a.appendNextSegment=function(){var e=this;u(e,(function(){e.closed||e.appendSegment()}))},a.appendSegment=function(){if(this.appendedCount<this.segments.length){var e=this.segments[this.appendedCount];!function(e,t){var i=!0;try{e.appendBuffer(t)}catch(t){var r=e.isVideo?"Video frame ":"Audio frame ";L.error(r+"append exception!",t),i=!1}return i}(this,e.data)?(L.debug("Append "+(e.init?"init ":"")+"segment error, reloading"),T("mse")):(this.appendedCount++,e.init?this.onInitAppended(e):(this.processThrottling(e),this.onSegmentAppended(e)))}},a.onInitAppended=function(e){this.initSegment=e.data,this.appendedCount>1&&(this.segments.splice(0,this.appendedCount-1),this.adjustPositions(this.appendedCount-1),this.appendedCount=1)},a.processThrottling=function(t){if(t.starter)re.seekTo=this.buffered.end(this.buffered.length-1),re.seekInd=re.seekTo+Q;else if(re.seekInd){var i=this.isVideo||re.audioOnly,r=this.buffered.end(this.buffered.length-1);if(i&&r>=re.seekInd){var n=!0;if(2==O.length){for(var o=0,a=0,s=0;s<O.length;s++)if(!O[s].isVideo){var u=O[s].buffered.length;o=O[s].buffered.start(u-1),a=O[s].buffered.end(u-1);break}re.seekTo<o&&(re.seekTo=o,re.seekInd=re.seekTo+Q),(re.seekInd>a||re.seekInd>r)&&(n=!1)}n&&(L.debug("Recover from throttling, jump to",re.seekTo),F?ge(re.seekTo):ye(re.seekTo),ce(),e.isMobile()&&(re.forcePlay=!0),re.initStart&&(_e(),re.initStart=!1))}}},a.onSegmentAppended=function(e){if(ne.activated&&!ne.to&&void 0!==ne.from){var t=e.ts/this.timescale;if(t>=ne.from)if(this.isVideo){ne.to=t,ne.lastCurTime=f.currentTime;var i=this.buffered.length>0?this.buffered.end(this.buffered.length-1):0,r=ne.lastCurTime-i;r>.02&&(void 0!==ne.aTime?ne.to=ne.aTime:y&&y.buffered.length>0&&(ne.to=y.buffered.end(y.buffered.length-1)),(r=ne.to-ne.lastCurTime)>0&&r<.5&&(L.debug("onSegmentAppended failsafe seek to next interval time ".concat(ne.to)),ye(ne.to),le()))}else void 0===ne.aTime&&(ne.aTime=t)}if(this.isVideo&&e.sap&&J.push(e.ts/this.timescale),this.segments.length>this.bufferLength)if(this.isVideo){var n=0;this.sapPositions.length>1&&this.sapPositions[1]<=this.appendedCount&&this.sapPositions[1]<=this.segments.length-this.bufferLength&&(n=this.sapPositions[1]),n>0&&(this.segments.splice(0,n),this.appendedCount-=n,this.adjustPositions(n)),this.onVideoSegmentPushed(this.appendedCount)}else{var o=this.segments.length-this.bufferLength;o>this.appendedCount&&(o=this.appendedCount),1==o?this.segments.shift():this.segments.splice(0,o),this.appendedCount-=o,this.adjustInitPositions(o)}},a.adjustPositions=function(e,t){var i=0;if(t){for(i=this.sapPositions.length-1;i>=0&&!(this.sapPositions[i]<e);i--);this.sapPositions.length=i+1}else for(i=0;i<this.sapPositions.length;i++)this.sapPositions[i]>=e?this.sapPositions[i]-=e:(this.sapPositions.shift(),i--);this.adjustInitPositions(e,t)},a.adjustInitPositions=function(e,t){var i=0;if(t){for(i=this.initPositions.length-1;i>=0&&!(this.initPositions[i]<e);i--);this.initPositions.length=i+1}else for(i=0;i<this.initPositions.length;i++)this.initPositions[i]>=e?this.initPositions[i]-=e:(this.initPositions.shift(),i--)},a.isVideo&&(a.onVideoSegmentPushed=function(e){y&&(y.bufferLength=Math.floor(y.bufLenRatio*e+.5))}),a.getSegments=function(){for(var e,t=0;t<this.initPositions.length;t++)if(this.initPositions[t]>this.appendedCount){var i=this.segments[this.initPositions[t]];if(this.initSegment!==i){this.initSegment=i,e=this.initPositions[t];break}}var r=0;if(void 0!==e)if(this.isVideo){for(var n=0;n<this.sapPositions.length;n++)if(this.sapPositions[n]>e){r=this.sapPositions[n];break}}else r=e+1;else this.initSegment=void 0;return{init:this.initSegment,segments:this.segments,start:r}},a.removeAll=function(){L.debug("Source buffer remove all. State = ".concat(s.readyState)),"open"===s.readyState&&(this.abort(),this.buffered.length>0&&this.removeRange(this.buffered.start(0),this.buffered.end(this.buffered.length-1))),this.initSegment=void 0,this.segments=[],this.sapPositions=[],this.initPositions=[],this.appendedCount=0},a.removeRange=function(e,t){var i=this;u(i,(function(){L.debug("Remove outdated range",e,t,f.currentTime,i.buffered.length),V=!0,i.remove(e,t),u(i,(function(){V=!1}))}))},z&&(a.log=function(e){for(var t=S[this.streamId],i=0;i<e.length;i++){var r=t.stamps.length>0?e[i]-t.stamps[t.stamps.length-1]:0,n=0;if(t.times.length>0){var o=performance.now();n=o-t.prevTime,t.prevTime=o}else t.prevTime=performance.now();if(void 0===t.avg)for(var a=1;a<t.stamps.length;a++){var s=t.stamps[a]-t.stamps[a-1];if(s>0){t.avg=s;break}}if(t.stamps.length==t.thresh){if(L.debug(this.streamId+" processed "+t.thresh+" frames"),0==t.gaps.length)t.sumTime>t.avg*t.thresh*1.1&&(L.debug("frames come slow",t.sumTime,t.avg*t.thresh),L.debug("intervals: ["+t.times.join(", ")+"]"));else{for(var u=[],c=0;c<t.gaps.length;c++)u.push("{val: "+t.gaps[c].val+", idx: "+t.gaps[c].idx+"}");L.debug("Gaps: ["+u.join(", ")+"], avgDuration "+t.avg),L.debug("Stamps: ["+t.stamps.join(", ")+"]"),t.sumTime>t.avg*t.thresh*1.1&&L.debug("Frames come slow!!!",t.sumTime,t.avg*t.thresh),L.debug("Intervals: ["+t.times.join(", ")+"]")}t.times=[],t.sumTime=0,t.stamps=[],t.gaps=[]}t.times.push(n),t.sumTime+=n,t.stamps.push(e[i]),Math.abs(r-t.avg)>1&&t.gaps.push({val:r,idx:t.stamps.length-1})}}),a.addEventListener("error",(function(e){L.error("SourceBuffer Error",e,this.streamId)})),a.streamId=o,O.push(a),a},this.startPlayback=function(e){L.debug("startPlayback, buffered ranges count ",f.buffered.length),f.buffered.length>0&&L.debug("video element buffer",f.buffered.start(0),f.buffered.end(0)),y&&m&&(y.bufLenRatio=2*y.fBufferLength/m.fBufferLength),(0==f.currentTime||oe.isPaused())&&oe.playMedia(e||{})},this.setSyncParams=function(t,i){ie.timeShift=t,ie.bufferSize=i,ie.integralDist=0,ie.start=void 0,ie.lastZapTime=e.isBrowser("Safari")?performance.now():0,L.debug("setSyncParams",t,i)},this.continue=function(){f.buffered.length>0&&L.debug("video element buffer",f.buffered.start(0),f.buffered.end(0)),oe.setPlaybackRate(1),p===U&&pe(),H.count=0,H.time=performance.now(),b=void 0,N=!1},this.wait=function(){ae.interrupt(),oe.setPlaybackRate(0),de(),b=performance.now(),N=!0,M("mse")},this.callbacks=function(e){k=e.onMediaReady,C=e.onProgress,T=e.onCrash,P=e.onWaitUpdate,x=e.onPlayStarted,E=e.onLatencyCalc,B=e.onLatencySeek,M=e.onLowBuffer,R=e.getAvgVBufLvl},this.resetPosition=function(){L.debug("reset position"),de(),fe(),he(),oe.resetPosition(),j=!1,D={},W={value:0,count:0,time:0},H={frames:0,count:0,time:0,seekCount:0},g=void 0,b=void 0,I=void 0,N=!1,V=!1,U=h,X=!1,te=0,G=0,Z=[],J.clear();for(var e=0;e<O.length;e++)O[e].initSegment=void 0,O[e].segments=[],O[e].sapPositions=[],O[e].initPositions=[],O[e].appendedCount=0,O[e].bufferLength=0,O[e].fBufferLength=0;le(),ce()},this.resumeTo=function(e){var t=Be(e,!0,.5);void 0===t&&(t=e),me(t)},this.handlePause=function(){ae.stop(),v===U&&(U=h),de()},this.isSeeking=function(){return!!f&&(U>h||re.background||void 0!==re.seekTo||void 0!==ne.to)},this.handlePlayEvent=function(){L.debug("handlePlayEvent",j),j||xe((function(){be(),x("mse")})),p===U&&pe()},this.handlePauseEvent=function(e){L.debug("handle pause event started = ".concat(j,", paused = ").concat(oe.isPaused())),j&&oe.resumeIfAutoPaused()},this.clear=function(){if(!e.isBrowser("Safari"))for(var t=0;t<O.length;t++)try{s.removeSourceBuffer(O[t])}catch(e){L.error("Failed to remove source buffer:",e)}ae.stop(),U=h,this.resetPosition(),O=[],m=void 0,y=void 0,f&&(f.removeEventListener("progress",Ee),f.removeEventListener("timeupdate",Ee),f.removeEventListener("seeking",ke),f.removeEventListener("seeked",Te),URL.revokeObjectURL(f.src),f.removeAttribute("src"),f.load(),f=void 0),s&&(s.removeEventListener("sourceopen",k),s=void 0),L.debug("clear source buffers and video element")},this.setVolume=function(e){f&&(f.volume=e)},this.getVolume=function(){return f?f.volume:0},this.setMuted=function(e){f&&(f.muted=e)},this.isMuted=function(){return!!f&&f.muted}}function i(t,i){var r=["vp8","vp9","opus"].includes(i)?"webm":"mp4";return e.isBrowser("Firefox")&&"mp4a.40.34"==i?t+"/"+r+'; codecs="mp3"':t+"/"+r+'; codecs="'+i+'"'}return{create:function(e){return new t(e)},isCodecSupported:function(t,r){return(!e.isBrowser("Microsoft")||"mp4a.40.34"!=r&&"mp4a.6B"!=r&&"mp4a.6B"!=r)&&MediaSource.isTypeSupported(i(t,r))}}}();t.default=m},function(e,t,i){i(305)},function(e,t,i){"use strict";i(7);var r,n=i(1),o=i(20),a=i(225),s=i(6),u=i(77),c=i(5),l=i(27),f=i(39),h=i(101),d=i(21),p=i(219),v=i(306),m=i(130),y=i(157).codeAt,g=i(308),b=i(24),_=i(38),w=i(127),A=i(226),S=i(34),k=S.set,C=S.getterFor("URL"),T=A.URLSearchParams,P=A.getState,x=s.URL,E=s.TypeError,B=s.parseInt,M=Math.floor,R=Math.pow,I=c("".charAt),F=c(/./.exec),L=c([].join),O=c(1..toString),j=c([].pop),D=c([].push),V=c("".replace),U=c([].shift),N=c("".split),W=c("".slice),H=c("".toLowerCase),z=c([].unshift),q=/[a-z]/i,G=/[\d+-.a-z]/i,Q=/\d/,Y=/^0x/i,K=/^[0-7]+$/,J=/^\d+$/,X=/^[\da-f]+$/i,Z=/[\0\t\n\r #%/:<>?@[\\\]^|]/,$=/[\0\t\n\r #/:<>?@[\\\]^|]/,ee=/^[\u0000-\u0020]+/,te=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,ie=/[\t\n\r]/g,re=function(e){var t,i,r,n;if("number"==typeof e){for(t=[],i=0;i<4;i++)z(t,e%256),e=M(e/256);return L(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,i=1,r=null,n=0,o=0;o<8;o++)0!==e[o]?(n>i&&(t=r,i=n),r=null,n=0):(null===r&&(r=o),++n);return n>i&&(t=r,i=n),t}(e),i=0;i<8;i++)n&&0===e[i]||(n&&(n=!1),r===i?(t+=i?":":"::",n=!0):(t+=O(e[i],16),i<7&&(t+=":")));return"["+t+"]"}return e},ne={},oe=p({},ne,{" ":1,'"':1,"<":1,">":1,"`":1}),ae=p({},oe,{"#":1,"?":1,"{":1,"}":1}),se=p({},ae,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),ue=function(e,t){var i=y(e,0);return i>32&&i<127&&!d(t,e)?e:encodeURIComponent(e)},ce={ftp:21,file:null,http:80,https:443,ws:80,wss:443},le=function(e,t){var i;return 2==e.length&&F(q,I(e,0))&&(":"==(i=I(e,1))||!t&&"|"==i)},fe=function(e){var t;return e.length>1&&le(W(e,0,2))&&(2==e.length||"/"===(t=I(e,2))||"\\"===t||"?"===t||"#"===t)},he=function(e){return"."===e||"%2e"===H(e)},de={},pe={},ve={},me={},ye={},ge={},be={},_e={},we={},Ae={},Se={},ke={},Ce={},Te={},Pe={},xe={},Ee={},Be={},Me={},Re={},Ie={},Fe=function(e,t,i){var r,n,o,a=b(e);if(t){if(n=this.parse(a))throw E(n);this.searchParams=null}else{if(void 0!==i&&(r=new Fe(i,!0)),n=this.parse(a,null,r))throw E(n);(o=P(new T)).bindURL(this),this.searchParams=o}};Fe.prototype={type:"URL",parse:function(e,t,i){var n,o,a,s,u,c=this,l=t||de,f=0,h="",p=!1,y=!1,g=!1;for(e=b(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=V(e,ee,""),e=V(e,te,"$1")),e=V(e,ie,""),n=v(e);f<=n.length;){switch(o=n[f],l){case de:if(!o||!F(q,o)){if(t)return"Invalid scheme";l=ve;continue}h+=H(o),l=pe;break;case pe:if(o&&(F(G,o)||"+"==o||"-"==o||"."==o))h+=H(o);else{if(":"!=o){if(t)return"Invalid scheme";h="",l=ve,f=0;continue}if(t&&(c.isSpecial()!=d(ce,h)||"file"==h&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=h,t)return void(c.isSpecial()&&ce[c.scheme]==c.port&&(c.port=null));h="","file"==c.scheme?l=Te:c.isSpecial()&&i&&i.scheme==c.scheme?l=me:c.isSpecial()?l=_e:"/"==n[f+1]?(l=ye,f++):(c.cannotBeABaseURL=!0,D(c.path,""),l=Me)}break;case ve:if(!i||i.cannotBeABaseURL&&"#"!=o)return"Invalid scheme";if(i.cannotBeABaseURL&&"#"==o){c.scheme=i.scheme,c.path=m(i.path),c.query=i.query,c.fragment="",c.cannotBeABaseURL=!0,l=Ie;break}l="file"==i.scheme?Te:ge;continue;case me:if("/"!=o||"/"!=n[f+1]){l=ge;continue}l=we,f++;break;case ye:if("/"==o){l=Ae;break}l=Be;continue;case ge:if(c.scheme=i.scheme,o==r)c.username=i.username,c.password=i.password,c.host=i.host,c.port=i.port,c.path=m(i.path),c.query=i.query;else if("/"==o||"\\"==o&&c.isSpecial())l=be;else if("?"==o)c.username=i.username,c.password=i.password,c.host=i.host,c.port=i.port,c.path=m(i.path),c.query="",l=Re;else{if("#"!=o){c.username=i.username,c.password=i.password,c.host=i.host,c.port=i.port,c.path=m(i.path),c.path.length--,l=Be;continue}c.username=i.username,c.password=i.password,c.host=i.host,c.port=i.port,c.path=m(i.path),c.query=i.query,c.fragment="",l=Ie}break;case be:if(!c.isSpecial()||"/"!=o&&"\\"!=o){if("/"!=o){c.username=i.username,c.password=i.password,c.host=i.host,c.port=i.port,l=Be;continue}l=Ae}else l=we;break;case _e:if(l=we,"/"!=o||"/"!=I(h,f+1))continue;f++;break;case we:if("/"!=o&&"\\"!=o){l=Ae;continue}break;case Ae:if("@"==o){p&&(h="%40"+h),p=!0,a=v(h);for(var _=0;_<a.length;_++){var w=a[_];if(":"!=w||g){var A=ue(w,se);g?c.password+=A:c.username+=A}else g=!0}h=""}else if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(p&&""==h)return"Invalid authority";f-=v(h).length+1,h="",l=Se}else h+=o;break;case Se:case ke:if(t&&"file"==c.scheme){l=xe;continue}if(":"!=o||y){if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(c.isSpecial()&&""==h)return"Invalid host";if(t&&""==h&&(c.includesCredentials()||null!==c.port))return;if(s=c.parseHost(h))return s;if(h="",l=Ee,t)return;continue}"["==o?y=!0:"]"==o&&(y=!1),h+=o}else{if(""==h)return"Invalid host";if(s=c.parseHost(h))return s;if(h="",l=Ce,t==ke)return}break;case Ce:if(!F(Q,o)){if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()||t){if(""!=h){var S=B(h,10);if(S>65535)return"Invalid port";c.port=c.isSpecial()&&S===ce[c.scheme]?null:S,h=""}if(t)return;l=Ee;continue}return"Invalid port"}h+=o;break;case Te:if(c.scheme="file","/"==o||"\\"==o)l=Pe;else{if(!i||"file"!=i.scheme){l=Be;continue}if(o==r)c.host=i.host,c.path=m(i.path),c.query=i.query;else if("?"==o)c.host=i.host,c.path=m(i.path),c.query="",l=Re;else{if("#"!=o){fe(L(m(n,f),""))||(c.host=i.host,c.path=m(i.path),c.shortenPath()),l=Be;continue}c.host=i.host,c.path=m(i.path),c.query=i.query,c.fragment="",l=Ie}}break;case Pe:if("/"==o||"\\"==o){l=xe;break}i&&"file"==i.scheme&&!fe(L(m(n,f),""))&&(le(i.path[0],!0)?D(c.path,i.path[0]):c.host=i.host),l=Be;continue;case xe:if(o==r||"/"==o||"\\"==o||"?"==o||"#"==o){if(!t&&le(h))l=Be;else if(""==h){if(c.host="",t)return;l=Ee}else{if(s=c.parseHost(h))return s;if("localhost"==c.host&&(c.host=""),t)return;h="",l=Ee}continue}h+=o;break;case Ee:if(c.isSpecial()){if(l=Be,"/"!=o&&"\\"!=o)continue}else if(t||"?"!=o)if(t||"#"!=o){if(o!=r&&(l=Be,"/"!=o))continue}else c.fragment="",l=Ie;else c.query="",l=Re;break;case Be:if(o==r||"/"==o||"\\"==o&&c.isSpecial()||!t&&("?"==o||"#"==o)){if(".."===(u=H(u=h))||"%2e."===u||".%2e"===u||"%2e%2e"===u?(c.shortenPath(),"/"==o||"\\"==o&&c.isSpecial()||D(c.path,"")):he(h)?"/"==o||"\\"==o&&c.isSpecial()||D(c.path,""):("file"==c.scheme&&!c.path.length&&le(h)&&(c.host&&(c.host=""),h=I(h,0)+":"),D(c.path,h)),h="","file"==c.scheme&&(o==r||"?"==o||"#"==o))for(;c.path.length>1&&""===c.path[0];)U(c.path);"?"==o?(c.query="",l=Re):"#"==o&&(c.fragment="",l=Ie)}else h+=ue(o,ae);break;case Me:"?"==o?(c.query="",l=Re):"#"==o?(c.fragment="",l=Ie):o!=r&&(c.path[0]+=ue(o,ne));break;case Re:t||"#"!=o?o!=r&&("'"==o&&c.isSpecial()?c.query+="%27":c.query+="#"==o?"%23":ue(o,ne)):(c.fragment="",l=Ie);break;case Ie:o!=r&&(c.fragment+=ue(o,oe))}f++}},parseHost:function(e){var t,i,r;if("["==I(e,0)){if("]"!=I(e,e.length-1))return"Invalid host";if(!(t=function(e){var t,i,r,n,o,a,s,u=[0,0,0,0,0,0,0,0],c=0,l=null,f=0,h=function(){return I(e,f)};if(":"==h()){if(":"!=I(e,1))return;f+=2,l=++c}for(;h();){if(8==c)return;if(":"!=h()){for(t=i=0;i<4&&F(X,h());)t=16*t+B(h(),16),f++,i++;if("."==h()){if(0==i)return;if(f-=i,c>6)return;for(r=0;h();){if(n=null,r>0){if(!("."==h()&&r<4))return;f++}if(!F(Q,h()))return;for(;F(Q,h());){if(o=B(h(),10),null===n)n=o;else{if(0==n)return;n=10*n+o}if(n>255)return;f++}u[c]=256*u[c]+n,2!=++r&&4!=r||c++}if(4!=r)return;break}if(":"==h()){if(f++,!h())return}else if(h())return;u[c++]=t}else{if(null!==l)return;f++,l=++c}}if(null!==l)for(a=c-l,c=7;0!=c&&a>0;)s=u[c],u[c--]=u[l+a-1],u[l+--a]=s;else if(8!=c)return;return u}(W(e,1,-1))))return"Invalid host";this.host=t}else if(this.isSpecial()){if(e=g(e),F(Z,e))return"Invalid host";if(null===(t=function(e){var t,i,r,n,o,a,s,u=N(e,".");if(u.length&&""==u[u.length-1]&&u.length--,(t=u.length)>4)return e;for(i=[],r=0;r<t;r++){if(""==(n=u[r]))return e;if(o=10,n.length>1&&"0"==I(n,0)&&(o=F(Y,n)?16:8,n=W(n,8==o?1:2)),""===n)a=0;else{if(!F(10==o?J:8==o?K:X,n))return e;a=B(n,o)}D(i,a)}for(r=0;r<t;r++)if(a=i[r],r==t-1){if(a>=R(256,5-t))return null}else if(a>255)return null;for(s=j(i),r=0;r<i.length;r++)s+=i[r]*R(256,3-r);return s}(e)))return"Invalid host";this.host=t}else{if(F($,e))return"Invalid host";for(t="",i=v(e),r=0;r<i.length;r++)t+=ue(i[r],ne);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return d(ce,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&le(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,i=e.username,r=e.password,n=e.host,o=e.port,a=e.path,s=e.query,u=e.fragment,c=t+":";return null!==n?(c+="//",e.includesCredentials()&&(c+=i+(r?":"+r:"")+"@"),c+=re(n),null!==o&&(c+=":"+o)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+L(a,"/"):"",null!==s&&(c+="?"+s),null!==u&&(c+="#"+u),c},setHref:function(e){var t=this.parse(e);if(t)throw E(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new Le(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+re(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(b(e)+":",de)},getUsername:function(){return this.username},setUsername:function(e){var t=v(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var i=0;i<t.length;i++)this.username+=ue(t[i],se)}},getPassword:function(){return this.password},setPassword:function(e){var t=v(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var i=0;i<t.length;i++)this.password+=ue(t[i],se)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?re(e):re(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Se)},getHostname:function(){var e=this.host;return null===e?"":re(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,ke)},getPort:function(){var e=this.port;return null===e?"":b(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=b(e))?this.port=null:this.parse(e,Ce))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+L(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Ee))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=b(e))?this.query=null:("?"==I(e,0)&&(e=W(e,1)),this.query="",this.parse(e,Re)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=b(e))?("#"==I(e,0)&&(e=W(e,1)),this.fragment="",this.parse(e,Ie)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Le=function(e){var t=h(this,Oe),i=w(arguments.length,1)>1?arguments[1]:void 0,r=k(t,new Fe(e,!1,i));o||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},Oe=Le.prototype,je=function(e,t){return{get:function(){return C(this)[e]()},set:t&&function(e){return C(this)[t](e)},configurable:!0,enumerable:!0}};if(o&&(f(Oe,"href",je("serialize","setHref")),f(Oe,"origin",je("getOrigin")),f(Oe,"protocol",je("getProtocol","setProtocol")),f(Oe,"username",je("getUsername","setUsername")),f(Oe,"password",je("getPassword","setPassword")),f(Oe,"host",je("getHost","setHost")),f(Oe,"hostname",je("getHostname","setHostname")),f(Oe,"port",je("getPort","setPort")),f(Oe,"pathname",je("getPathname","setPathname")),f(Oe,"search",je("getSearch","setSearch")),f(Oe,"searchParams",je("getSearchParams")),f(Oe,"hash",je("getHash","setHash"))),l(Oe,"toJSON",(function(){return C(this).serialize()}),{enumerable:!0}),l(Oe,"toString",(function(){return C(this).serialize()}),{enumerable:!0}),x){var De=x.createObjectURL,Ve=x.revokeObjectURL;De&&l(Le,"createObjectURL",u(De,x)),Ve&&l(Le,"revokeObjectURL",u(Ve,x))}_(Le,"URL"),n({global:!0,constructor:!0,forced:!a,sham:!o},{URL:Le})},function(e,t,i){"use strict";var r=i(77),n=i(19),o=i(25),a=i(307),s=i(155),u=i(126),c=i(28),l=i(107),f=i(128),h=i(106),d=Array;e.exports=function(e){var t=o(e),i=u(this),p=arguments.length,v=p>1?arguments[1]:void 0,m=void 0!==v;m&&(v=r(v,p>2?arguments[2]:void 0));var y,g,b,_,w,A,S=h(t),k=0;if(!S||this===d&&s(S))for(y=c(t),g=i?new this(y):d(y);y>k;k++)A=m?v(t[k],k):t[k],l(g,k,A);else for(w=(_=f(t,S)).next,g=i?new this:[];!(b=n(w,_)).done;k++)A=m?a(_,v,[b.value,k],!0):b.value,l(g,k,A);return g.length=k,g}},function(e,t,i){var r=i(22),n=i(191);e.exports=function(e,t,i,o){try{return o?t(r(i)[0],i[1]):t(i)}catch(t){n(e,"throw",t)}}},function(e,t,i){var r=i(5),n=/[^\0-\u007E]/,o=/[.\u3002\uFF0E\uFF61]/g,a="Overflow: input needs wider integers to process",s=RangeError,u=r(o.exec),c=Math.floor,l=String.fromCharCode,f=r("".charCodeAt),h=r([].join),d=r([].push),p=r("".replace),v=r("".split),m=r("".toLowerCase),y=function(e){return e+22+75*(e<26)},g=function(e,t,i){var r=0;for(e=i?c(e/700):e>>1,e+=c(e/t);e>455;)e=c(e/35),r+=36;return c(r+36*e/(e+38))},b=function(e){var t,i,r=[],n=(e=function(e){for(var t=[],i=0,r=e.length;i<r;){var n=f(e,i++);if(n>=55296&&n<=56319&&i<r){var o=f(e,i++);56320==(64512&o)?d(t,((1023&n)<<10)+(1023&o)+65536):(d(t,n),i--)}else d(t,n)}return t}(e)).length,o=128,u=0,p=72;for(t=0;t<e.length;t++)(i=e[t])<128&&d(r,l(i));var v=r.length,m=v;for(v&&d(r,"-");m<n;){var b=2147483647;for(t=0;t<e.length;t++)(i=e[t])>=o&&i<b&&(b=i);var _=m+1;if(b-o>c((2147483647-u)/_))throw s(a);for(u+=(b-o)*_,o=b,t=0;t<e.length;t++){if((i=e[t])<o&&++u>2147483647)throw s(a);if(i==o){for(var w=u,A=36;;){var S=A<=p?1:A>=p+26?26:A-p;if(w<S)break;var k=w-S,C=36-S;d(r,l(y(S+k%C))),w=c(k/C),A+=36}d(r,l(y(w))),p=g(u,_,m==v),u=0,m++}}u++,o++}return h(r,"")};e.exports=function(e){var t,i,r=[],a=v(p(m(e),o,"."),".");for(t=0;t<a.length;t++)i=a[t],d(r,u(n,i)?"xn--"+b(i):i);return h(r,".")}},function(e,t,i){i(226)},function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,"symbol"===r(o=function(e,t){if("object"!==r(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t);if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key,"string"))?o:String(o),n)}var o}i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(40),i(12),i(13),i(9),i(10),i(4),i(14);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultFraction=100,this.timeout=this.fraction=this.defaultFraction,this.leeway=8}var t,i;return t=e,(i=[{key:"setController",value:function(e){this.ctrl=e,this.ctrl.setFraction(this.defaultFraction)}},{key:"start",value:function(e,t){if(!this.timer){this.onFinish=e,this.pos=this.startPos=performance.now(),this.timeout=this.defaultFraction,this.end=this.startPos+t;var i=this;this.timeout=this._fractionForInterval(t),this.timer=setTimeout((function e(){i.pos=performance.now();var t=i.ctrl?i.ctrl.onProgress((i.pos-i.startPos)/1e3):Math.floor(i.end-i.pos);i._shouldProceed(t)?(i.timeout=i._fractionForInterval(t),i.timer=setTimeout(e,i.timeout)):(i.timer=void 0,i.onFinish())}),this.timeout)}}},{key:"interrupt",value:function(){this.timer&&(this.stop(),this.onFinish())}},{key:"stop",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.timeout=this.defaultFraction}},{key:"_shouldProceed",value:function(e){return this.ctrl?!this.ctrl.isFinished():e>this.leeway}},{key:"_fractionForInterval",value:function(e){var t=this.ctrl?this.ctrl.getFraction():this.fraction;return e<t&&(t=e),t}}])&&n(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=o},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(26),i(79),i(312),i(137),i(12),i(13),i(9),i(10),i(4),i(14);var r=a(i(18)),n=a(i(138)),o=a(i(114));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===s(n=function(e,t){if("object"!==s(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=r.default.create(t,"Zap Controller"),this.instanceId=t,this.leeway=.003}var t,i;return t=e,(i=[{key:"reset",value:function(e,t){this.playbackService=e,this.targetTime=t,this.direction=t-e.getCurrentTime()>0?0:1,this.distRaise=0,this.finished=!1,this.overrun=!1,this.state=1,this._readDefaultMomentums(),n.default.display(this.instanceId,"momentum",this.momentums)}},{key:"onProgress",value:function(e){this.rate=this.playbackService.getPlaybackRate();var t=this.dist;this.dist=this.targetTime+e-this.playbackService.getCurrentTime(),void 0===t&&(t=this.dist),this.effDist=this.dist+this.momentums[this.direction],this._calcZapDuration();var i=this._getDirectedDistance(this.effDist);if(1===this.state){if(this._checkDistIsRaising(t))return this.logger.debug("Terminate zapping for next time. Lack of playback rate control."),this.playbackService.setPlaybackRate(1),this.finished=!0,0;this._updateFraction(),this._updateRate(i),i>.3&&this.distRaise>=5&&(this._calcZapRate(),this._calcZapDuration(),this.playbackService.setPlaybackRate(this.rate)),this._shouldStabilize(i)&&(this.stblDist=this.dist,this.playbackService.setPlaybackRate(1),this.state=2,this.stblStartTime=performance.now(),this.fraction=100,this.duration=.1)}else if(2===this.state&&performance.now()-this.stblStartTime>500)if(Math.abs(this.dist)<.035)this.logger.debug("Finish zapping, dist = ".concat(this.dist,", momentums = [").concat(this.momentums.join(", "),"]")),this.finished=!0,this._storeDefaultMomentums();else{var r=this.dist-this.stblDist-this.momentums[this.direction];this.momentums[this.direction]+=r,this.momentums[this.direction]<-.5&&(this.momentums[this.direction]=-.5),this.momentums[this.direction]>.5&&(this.momentums[this.direction]=.5),n.default.display(this.instanceId,"momentum",this.momentums),this.direction=this.dist>0?0:1,this.effDist=this.dist+this.momentums[this.direction],this._calcZapRate(),this._calcZapDuration(),this.playbackService.setPlaybackRate(this.rate),this._updateFraction(),this.state=1,this.dist=void 0,this.distRaise=0}return 1e3*this.duration}},{key:"setFraction",value:function(e){this.fraction=e}},{key:"getFraction",value:function(){return this.fraction}},{key:"isFinished",value:function(){return this.finished}},{key:"_updateRate",value:function(e){this._isForward()?e<.05&&this.rate>1.1&&(this.rate=1.1,this.playbackService.setPlaybackRate(this.rate)):e<.05&&this.rate<.9&&(this.rate=.9,this.playbackService.setPlaybackRate(this.rate))}},{key:"_checkDistIsRaising",value:function(e){var t=this._getDirectedDistance(this.dist),i=t-this._getDirectedDistance(e)>=.001;return i?(0===this.distRaise&&(this.raisedDist=t),this.distRaise++,(i=this.distRaise>20&&t-this.raisedDist>=3||this.distRaise>200)&&(this.distRaise=0)):this.distRaise>0&&this.distRaise--,i}},{key:"_calcDistWithMomentum",value:function(){return this.dist+this.momentums[this.direction]}},{key:"_calcZapDuration",value:function(){1!==this.rate?(this.duration=Math.abs(o.default.truncateDecimals(this.effDist/(this.rate-1))),this.duration<0&&this.logger.error("_calcZapDuration is negative",this.effDist,this.rate)):this.duration=1e3}},{key:"_isForward",value:function(){return 0===this.direction}},{key:"_calcZapRate",value:function(){var e=this._isForward();if(e&&this.effDist>0&&this.effDist<.1)this.rate=1.1;else if(!e&&this.effDist<0&&this.effDist>-.1)this.rate=.9;else{if(this.rate=this.effDist+1,this.effDist>0)this.rate=this.effDist>2?3:.1*Math.ceil(this.rate/.1);else if(this.rate<0)this.rate=0;else{var t=Math.floor(this.rate/.1);0===t&&(t=1),this.rate=.1*t}e&&this.rate<1&&this.logger.debug("Slow rate on forward",this.effDist,this.rate),!e&&this.rate>1&&this.logger.debug("Fast rate on backward",this.effDist,this.rate)}}},{key:"_shouldStabilize",value:function(e){return e<this.leeway}},{key:"_getDirectedDistance",value:function(e){return this._isForward()?e:-e}},{key:"_updateFraction",value:function(){var e=this._getDirectedDistance(this.effDist);this.fraction=e<0?5:e<.1?10:e<.3?20:100}},{key:"_readDefaultMomentums",value:function(){if(this.momentums=[0,0],"localStorage"in window)try{var e=window.localStorage.getItem("sldp_player_momentums");e&&(this.momentums=e.split(",").map((function(e){var t=parseFloat(e);return isNaN(t)?0:t})))}catch(e){this.logger.warn("Error getting default momentums from local storage",e)}n.default.display(this.instanceId,"momentum",this.momentums)}},{key:"_storeDefaultMomentums",value:function(){if("localStorage"in window)try{window.localStorage.setItem("sldp_player_momentums",this.momentums.join(","))}catch(e){this.logger.warn("Error setting default momentum to local storage",e)}}}])&&u(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=c},function(e,t,i){"use strict";var r=i(1),n=i(36).map;r({target:"Array",proto:!0,forced:!i(131)("map")},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,i){var r=i(3),n=i(6).RegExp,o=r((function(){var e=n("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),a=o||r((function(){return!n("a","y").sticky})),s=o||r((function(){var e=n("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:s,MISSED_STICKY:a,UNSUPPORTED_Y:o}},function(e,t,i){var r=i(3),n=i(6).RegExp;e.exports=r((function(){var e=n(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},function(e,t,i){var r=i(3),n=i(6).RegExp;e.exports=r((function(){var e=n("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},function(e,t,i){"use strict";var r=i(19),n=i(229),o=i(22),a=i(85),s=i(45),u=i(24),c=i(73),l=i(98),f=i(230),h=i(231);n("match",(function(e,t,i){return[function(t){var i=c(this),n=a(t)?void 0:l(t,e);return n?r(n,t,i):new RegExp(t)[e](u(i))},function(e){var r=o(this),n=u(e),a=i(t,r,n);if(a.done)return a.value;if(!r.global)return h(r,n);var c=r.unicode;r.lastIndex=0;for(var l,d=[],p=0;null!==(l=h(r,n));){var v=u(l[0]);d[p]=v,""===v&&(r.lastIndex=f(n,s(r.lastIndex),c)),p++}return 0===p?null:d}]}))},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(12),i(13),i(9),i(10),i(4),i(14);var r=c(i(116)),n=c(i(18)),o=c(i(115)),a=c(i(117)),s=c(i(233)),u=c(i(318));function c(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function h(e,t,i){return(t=d(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===l(t)?t:String(t)}var p,v=(p=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"_onWorkletModuleNotFound",(function(e){i._workletUrl===u.default?i._onWorkletModuleError(error):i._audioCtx.audioWorklet.addModule(u.default).then(i._onWorkletModuleAdded).catch(i._onWorkletModuleError)})),h(this,"_onWorkletModuleError",(function(e){i._logger.error(i._spProvider.notAvailableError("Opus decoder worklet",u.default)),i.clear()})),h(this,"_onWorkletModuleAdded",(function(){i._pcmFeeder=new AudioWorkletNode(i._audioCtx,"pcm-feed-processor",{outputChannelCount:[2]}),i._pcmFeeder.channelCount=2,i._gainer=i._audioCtx.createGain(),i._gainer.gain.value=void 0!==i._curVolume?i._curVolume:1,i._pcmFeeder.connect(i._gainer),i._audGraphCtrl.addMediaSourceChain([i._pcmFeeder],[i._gainer]),i._audioCtx.resume(),i._initCallback()})),this._logger=n.default.create(t,"WebAudio"),this._syncParams={},this._id=t,this._playbackService=o.default.getInstance(t),this._spProvider=r.default.getInstance(t)}var t,i;return t=e,(i=[{key:"init",value:function(e,t){return this._mediaElement=e,this._playbackService.init(e),this._audCtxProvider=a.default.getInstance(this._id),this._audioCtx=this._audCtxProvider.get(),"running"!==this._audioCtx.state?(this._logger.warn("Audio context state is ".concat(this._audioCtx.state,', but should be "running"')),!1):(this._audGraphCtrl=s.default.getInstance(this._id),this._audGraphCtrl.init(e,2),this._initCallback=t||this._onMediaReadyCallback,this._workletUrl=this._spProvider.translateToScriptPath(u.default),this._audioCtx.audioWorklet.addModule(this._workletUrl).then(this._onWorkletModuleAdded).catch(this._onWorkletModuleNotFound),!0)}},{key:"clear",value:function(){this.resetPosition(),this._mediaElement=void 0}},{key:"resetPosition",value:function(){this._playStarted=!1,this._pcmFeeder&&(this._curVolume=void 0,this._pcmFeeder.port.postMessage({cmd:"stop"}),this._audGraphCtrl.removeMediaSourceChain(),this._pcmFeeder.disconnect(this._gainer),this._pcmFeeder=void 0,this._gainer=void 0)}},{key:"setLowBufferBorder",value:function(e){this._lowBufferBorder=e}},{key:"setLatencyTolerance",value:function(e,t,i){this._latencyTolerance=e,this._latencyAdjustZap=!!i,this._bufferToKeep=t,this._bckAllowance=Math.min(.2*t,.5),this._fwdAllowance=Math.min(.1*t,.3)}},{key:"toggleBufferLineUp",value:function(e){this._bufLineUpEnabled=!!e}},{key:"setCurrentBufferLevel",value:function(e,t){this._curBufferLevel=t}},{key:"callbacks",set:function(e){this._onMediaReadyCallback=e.onMediaReady,this._onProgressCallback=e.onProgress,this._onCrashCallback=e.onCrash,this._onWaitStatusCallback=e.onWaitUpdate,this._onPlayStartedCallback=e.onPlayStarted,this._onLatencyCalcCallback=e.onLatencyCalc,this._onLatencySeekCallback=e.onLatencySeek,this._onLowBufferCallback=e.onLowBuffer}},{key:"createSourceBuffer",value:function(e,t,i,r){return{wapi:this,removeAll:function(){},getBufferingLength:function(){return this.bufferLength},setBufferingLength:function(e){this.bufferLength=e,this.fBufferLength=e},pushInit:function(e,t){},pushSegment:function(e,t,i){var r=this;e.then((function(e){var i=e.channelData;if(e.samplesDecoded,e.sampleRate,r.wapi._pcmFeeder){for(var n=[],o=0;o<i.length;o++)n.push(i[o].buffer);r.wapi._pcmFeeder.port.postMessage([i,t[0]],n)}}))},filterOut:function(e){},getSegments:function(){return{segments:[],start:0}}}}},{key:"setSyncParams",value:function(e,t){this._syncParams.timeShift=e,this._syncParams.bufferSize=t,this._syncParams.integralDist=0,this._syncParams.start=void 0,this._logger.debug("setSyncParams",e,t)}},{key:"startLogging",value:function(){}},{key:"startPlayback",value:function(e){this._logger.debug("startPlayback, buffered ranges count ",this._mediaElement.buffered.length),this._mediaElement.buffered.length>0&&this._logger.debug("video element buffer",this._mediaElement.buffered.start(0),this._mediaElement.buffered.end(0)),(0==this._mediaElement.currentTime||this._playbackService.isPaused())&&this._playbackService.playMedia(e||{})}},{key:"handlePlayEvent",value:function(){this._playStarted||(this._playStarted=!0,this._onPlayStartedCallback("wapi"))}},{key:"handlePauseEvent",value:function(){this._logger.debug("handlePauseEvent")}},{key:"resumeTo",value:function(e){this._pcmFeeder.port.postMessage({cmd:"play",val:e}),this._logger.debug("resumeTo",e)}},{key:"handlePause",value:function(){this._pcmFeeder.port.postMessage({cmd:"pause"}),this._logger.debug("handlePause")}},{key:"isSeeking",value:function(){return!!this._mediaElement&&this._seekInProgress}},{key:"setVolume",value:function(e){this._curVolume=e,this._gainer&&this._gainer.gain.setValueAtTime(e,this._audioCtx.currentTime)}},{key:"getVolume",value:function(){return this._curVolume||1}},{key:"setMuted",value:function(e){this._curMuted=e,this.setVolume(e?0:this._curVolume)}},{key:"isMuted",value:function(){return this._curMuted}}])&&f(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),{create:function(e){return new p(e)},isCodecSupported:function(e,t){return"audio"===e&&"opus"===t}});t.default=v},function(e,t,i){"use strict";e.exports=i.p+"opus-v2.25.0.worklet.min.js"},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(174);var r=o(i(320)),n=o(i(323));function o(e){return e&&e.__esModule?e:{default:e}}var a={createFile:function(){return new n.default},createBox:function(e,t,i){var n=r.default.create(e);return t&&t.append(n,i),n},createFullBox:function(e,t,i){var r=a.createBox(e,t,i);return r.version=0,r.flags=0,r}},s=a;t.default=s},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(174),i(113),i(48),i(139),i(4),i(2),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(68),i(69),i(70),i(71),i(72),i(41);var r=a(i(322)),n=a(i(140)),o=a(i(235));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){this._cursor=new n.default,this.int32pow=Math.pow(2,32)};s.create=function(e){var t=new s;return t.type=e,t.boxes=[],t},s.prototype._boxContainers=["dinf","mdia","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak"],s.prototype._boxProcessors={},s.prototype._writeFieldArray=function(e,t,i){for(var r=0;r<i.length;r++)this._writeField(e,t,i[r])},s.prototype._writeFullBox=function(){this._writeField("uint",8,this.version),this._writeField("uint",24,this.flags)},s.prototype._procEntries=function(e,t,i){for(var r=0;r<t;r++)i.call(this,this[e][r])},s.prototype._procSubBoxes=function(e,t){for(var i=0;i<t;i++)this._rawo?this[e][i].write():this.size+=this[e][i].getLength()},s.prototype.append=function(e,t){o.default.appendBox(this,e,t)},s.prototype.getLength=function(){if(this._rawo=null,this.size=0,this._writeField("uint",32,this.size),this._writeField("string",4,this.type),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},s.prototype.write=function(){if(this._cursor.offset=this._parent._cursor.offset,0===this.size?this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset):this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size),this._writeField("uint",32,this.size),this._writeField("string",4,this.type),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},s.prototype._writeInt=function(e,t){if(this._rawo){var i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(i,t);break;case 16:this._rawo.setInt16(i,t);break;case 32:this._rawo.setInt32(i,t);break;case 64:var r=Math.floor(t/this.int32pow),n=t-r*this.int32pow;this._rawo.setUint32(i,r),this._rawo.setUint32(i+4,n)}this._cursor.offset+=e>>3}else this.size+=e>>3},s.prototype._writeUint=function(e,t){if(this._rawo){var i,r,n=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(n,t);break;case 16:this._rawo.setUint16(n,t);break;case 24:i=(16776960&t)>>8,r=255&t,this._rawo.setUint16(n,i),this._rawo.setUint8(n+2,r);break;case 32:this._rawo.setUint32(n,t);break;case 64:r=t-(i=Math.floor(t/this.int32pow))*this.int32pow,this._rawo.setUint32(n,i),this._rawo.setUint32(n+4,r)}this._cursor.offset+=e>>3}else this.size+=e>>3},s.prototype._writeString=function(e,t){for(var i=0;i<e;i++)this._writeUint(8,t.charCodeAt(i))},s.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},s.prototype._writeTemplate=function(e,t){var i=Math.floor(t),r=(t-i)*Math.pow(2,e/2);this._writeUint(e/2,i),this._writeUint(e/2,r)},s.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Uint8Array)this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length;else if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,i=0;i<e.length;i++)this._rawo.setInt8(t+i,e[i]);this._cursor.offset+=e.length}}else this.size+=e.length},s.prototype._writeUTF8String=function(e){var t=r.default.utf8ToByteArray(e);if(this._rawo)for(var i=new DataView(this._rawo.buffer,this._cursor.offset,t.length),n=0;n<t.length;n++)i.setUint8(n,t[n]);else this.size+=t.length},s.prototype._writeField=function(e,t,i){switch(e){case"uint":this._writeUint(t,i);break;case"int":this._writeInt(t,i);break;case"template":this._writeTemplate(t,i);break;case"string":-1==t?this._writeTerminatedString(i):this._writeString(t,i);break;case"data":this._writeData(i);break;case"utf8":this._writeUTF8String(i)}},s.prototype._boxProcessors.avc1=s.prototype._boxProcessors.avc2=s.prototype._boxProcessors.avc3=s.prototype._boxProcessors.avc4=s.prototype._boxProcessors.hvc1=s.prototype._boxProcessors.hev1=s.prototype._boxProcessors.av01=s.prototype._boxProcessors.encv=function(){this._writeFieldArray("uint",8,this.reserved1),this._writeField("uint",16,this.data_reference_index),this._writeField("uint",16,this.pre_defined1),this._writeField("uint",16,this.reserved2),this._writeFieldArray("uint",32,this.pre_defined2),this._writeField("uint",16,this.width),this._writeField("uint",16,this.height),this._writeField("template",32,this.horizresolution),this._writeField("template",32,this.vertresolution),this._writeField("uint",32,this.reserved3),this._writeField("uint",16,this.frame_count),this._writeFieldArray("uint",8,this.compressorname),this._writeField("uint",16,this.depth),this._writeField("int",16,this.pre_defined3),this._writeField("data",-1,this.config),this._procSubBoxes("entries",this.entry_count)},s.prototype._boxProcessors.dref=function(){this._writeFullBox(),this._writeField("uint",32,this.entry_count),this._procSubBoxes("entries",this.entry_count)},s.prototype._boxProcessors.pasp=function(){this._writeField("uint",32,this.hSpacing),this._writeField("uint",32,this.vSpacing)},s.prototype._boxProcessors.styp=s.prototype._boxProcessors.ftyp=function(){this._writeField("string",4,this.major_brand),this._writeField("uint",32,this.minor_version),this._writeFieldArray("string",4,this.compatible_brands)},s.prototype._boxProcessors.sidx=function(){this._writeFullBox(),this._writeField("uint",32,this.reference_ID),this._writeField("uint",32,this.timescale),this._writeField("uint",1==this.version?64:32,this.earliest_presentation_time),this._writeField("uint",1==this.version?64:32,this.first_offset),this._writeField("uint",16,this.reserved),this._writeField("uint",16,this.reference_count),this._procEntries("references",this.reference_count,(function(e){e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time,this._writeField("uint",32,e.reference),this._writeField("uint",32,e.subsegment_duration),this._writeField("uint",32,e.sap)}))},s.prototype._boxProcessors.hdlr=function(){this._writeFullBox(),this._writeField("uint",32,this.pre_defined),this._writeField("string",4,this.handler_type),this._writeFieldArray("uint",32,this.reserved),this._writeField("string",-1,this.name)},s.prototype._boxProcessors.mdat=function(){this._writeField("data",-1,this.data)},s.prototype._boxProcessors.mdhd=function(){this._writeFullBox(),this._writeField("uint",1==this.version?64:32,this.creation_time),this._writeField("uint",1==this.version?64:32,this.modification_time),this._writeField("uint",32,this.timescale),this._writeField("uint",1==this.version?64:32,this.duration),"string"==typeof this.language&&(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._writeField("uint",16,this.language),this._writeField("uint",16,this.pre_defined)},s.prototype._boxProcessors.mehd=function(){this._writeFullBox(),this._writeField("uint",1==this.version?64:32,this.fragment_duration)},s.prototype._boxProcessors.mfhd=function(){this._writeFullBox(),this._writeField("uint",32,this.sequence_number)},s.prototype._boxProcessors.mp4a=s.prototype._boxProcessors.enca=function(){this._writeFieldArray("uint",8,this.reserved1),this._writeField("uint",16,this.data_reference_index),this._writeFieldArray("uint",32,this.reserved2),this._writeField("uint",16,this.channelcount),this._writeField("uint",16,this.samplesize),this._writeField("uint",16,this.pre_defined),this._writeField("uint",16,this.reserved3),this._writeField("uint",32,this.samplerate),this._writeField("data",-1,this.esds)},s.prototype._boxProcessors[".mp3"]=function(){this._writeFieldArray("uint",8,this.reserved1),this._writeField("uint",16,this.data_reference_index),this._writeFieldArray("uint",32,this.reserved2),this._writeField("uint",16,this.channelcount),this._writeField("uint",16,this.samplesize),this._writeField("uint",16,this.pre_defined),this._writeField("uint",16,this.reserved3),this._writeField("uint",32,this.samplerate),this._procSubBoxes("entries",this.entry_count)},s.prototype._boxProcessors.btrt=function(){this._writeField("uint",32,this.bufferSizeDB),this._writeField("uint",32,this.maxBitrate),this._writeField("uint",32,this.avgBitrate)},s.prototype._boxProcessors.mvhd=function(){this._writeFullBox(),this._writeField("uint",1==this.version?64:32,this.creation_time),this._writeField("uint",1==this.version?64:32,this.modification_time),this._writeField("uint",32,this.timescale),this._writeField("uint",1==this.version?64:32,this.duration),this._writeField("template",32,this.rate),this._writeField("template",16,this.volume),this._writeField("uint",16,this.reserved1),this._writeFieldArray("uint",32,this.reserved2),this._writeFieldArray("template",32,this.matrix),this._writeFieldArray("uint",32,this.pre_defined),this._writeField("uint",32,this.next_track_ID)},s.prototype._boxProcessors.smhd=function(){this._writeFullBox(),this._writeField("uint",16,this.balance),this._writeField("uint",16,this.reserved)},s.prototype._boxProcessors.stsd=function(){this._writeFullBox(),this._writeField("uint",32,this.entry_count),this._procSubBoxes("entries",this.entry_count)},s.prototype._boxProcessors.tfdt=function(){this._writeFullBox(),this._writeField("uint",1==this.version?64:32,this.baseMediaDecodeTime)},s.prototype._boxProcessors.tfhd=function(){this._writeFullBox(),this._writeField("uint",32,this.track_ID),1&this.flags&&this._writeField("uint",64,this.base_data_offset),2&this.flags&&this._writeField("uint",32,this.sample_description_offset),8&this.flags&&this._writeField("uint",32,this.default_sample_duration),16&this.flags&&this._writeField("uint",32,this.default_sample_size),32&this.flags&&this._writeField("uint",32,this.default_sample_flags)},s.prototype._boxProcessors.tkhd=function(){this._writeFullBox(),this._writeField("uint",1==this.version?64:32,this.creation_time),this._writeField("uint",1==this.version?64:32,this.modification_time),this._writeField("uint",32,this.track_ID),this._writeField("uint",32,this.reserved1),this._writeField("uint",1==this.version?64:32,this.duration),this._writeFieldArray("uint",32,this.reserved2),this._writeField("uint",16,this.layer),this._writeField("uint",16,this.alternate_group),this._writeField("template",16,this.volume),this._writeField("uint",16,this.reserved3),this._writeFieldArray("template",32,this.matrix),this._writeField("template",32,this.width),this._writeField("template",32,this.height)},s.prototype._boxProcessors.trex=function(){this._writeFullBox(),this._writeField("uint",32,this.track_ID),this._writeField("uint",32,this.default_sample_description_index),this._writeField("uint",32,this.default_sample_duration),this._writeField("uint",32,this.default_sample_size),this._writeField("uint",32,this.default_sample_flags)},s.prototype._boxProcessors.trun=function(){this._writeFullBox(),this._writeField("uint",32,this.sample_count),1&this.flags&&this._writeField("int",32,this.data_offset),4&this.flags&&this._writeField("uint",32,this.first_sample_flags),this._procEntries("samples",this.sample_count,(function(e){256&this.flags&&this._writeField("uint",32,e.sample_duration),512&this.flags&&this._writeField("uint",32,e.sample_size),1024&this.flags&&this._writeField("uint",32,e.sample_flags),2048&this.flags&&this._writeField(1===this.version?"int":"uint",32,e.sample_composition_time_offset)}))},s.prototype._boxProcessors["url "]=s.prototype._boxProcessors["urn "]=function(){this._writeFullBox(),"urn "===this.type&&this._writeField("string",-1,this.name),this._writeField("string",-1,this.location)},s.prototype._boxProcessors.vmhd=function(){this._writeFullBox(),this._writeField("uint",16,this.graphicsmode),this._writeFieldArray("uint",16,this.opcolor)};var u=s;t.default=u},function(e,t,i){var r=i(1),n=i(132);r({global:!0,constructor:!0,forced:!i(166)},{DataView:n.DataView})},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(79);var r={dataViewToString:function(e,t){var i=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(i).decode(e);var r=[],n=0;if("utf-8"===i)for(;n<e.byteLength;){var o=e.getUint8(n++);o<128||(o<224?(o=(31&o)<<6,o|=63&e.getUint8(n++)):o<240?(o=(15&o)<<12,o|=(63&e.getUint8(n++))<<6,o|=63&e.getUint8(n++)):(o=(7&o)<<18,o|=(63&e.getUint8(n++))<<12,o|=(63&e.getUint8(n++))<<6,o|=63&e.getUint8(n++))),r.push(String.fromCharCode(o))}else for(;n<e.byteLength;)r.push(String.fromCharCode(e.getUint8(n++)));return r.join("")},utf8ToByteArray:function(e){var t,i;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],i=0;i<e.length;++i){var r=e.charCodeAt(i);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t}};t.default=r},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(2),i(48),i(4),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(68),i(69),i(70),i(71),i(72),i(139);var r=o(i(140)),n=o(i(235));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){this._cursor=new r.default,this.boxes=[]};a.prototype.write=function(){var e=0,t=0;for(t=0;t<this.boxes.length;t++)e+=this.boxes[t].getLength();var i=new Uint8Array(e);for(this._rawo=new DataView(i.buffer),this.bytes=i,this._cursor.offset=0,t=0;t<this.boxes.length;t++)this.boxes[t].write();return i.buffer},a.prototype.append=function(e,t){n.default.appendBox(this,e,t)};var s=a;t.default=s},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(2),i(48),i(4),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(68),i(69),i(70),i(71),i(72),i(26);var r=o(i(325)),n=o(i(18));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=n.default.create(e,"WebmComposer");function i(){var e=[],i=1;function n(e,i,r){var n=r.prevSamplCntTs+i.samplesPerFrame,o=r.nextSamplCntTs-n;if(o>=i.samplesPerFrame&&o<=10*i.samplingRate){t.debug("recover audio gap effShift = ".concat(o,", prevTs = ").concat(r.prevTs,", prevSamplCntTs = ").concat(r.prevSamplCntTs,", nextSamplCntTs = ").concat(r.nextSamplCntTs));for(var a=Math.floor(o/i.samplesPerFrame),s=r.prevTs,u=0;u<a;u++){s+=i.tsPerFrame;var c={data:r.data,sap:!0,ts:s,msTs:i.millisecondsFromTs(s),msDuration:i.msPerFrame,samplCntTs:n,samplCntDur:i.samplesPerFrame};e.push(c),n+=i.samplesPerFrame}t.warn("adding dummy frames",e.length-1,n,r.nextSamplCntTs)}return n}function o(e,t){return t<0||t>10*e.timescale}function a(e,i,r){var n=!1;if(e.isAudio&&e.lastSilenceSampleTs>0&&null!==r){var o=e.lastSilenceSampleTs-i;o>=0?o<5*e.timescale&&(t.debug("Ignore real frames after mute",i,e.lastSilenceSampleTs),n=!0):e.lastSilenceSampleTs=0}return n}function s(e,i,r,s){if(a(e,s,r))return[];var u=[],c=e.lastSample,l=s-c.rawts;o(e,l)&&(t.debug("Incorrect DTS difference (".concat(l,") between previous (ts: ").concat(c.rawts,", sap: ").concat(c.sap,") and current frame (ts: ").concat(s,", sap: ").concat(i,")")),l=e.lastSampleDuration);var f=s;if(s=c.ts+l,l>0&&(e.lastSampleDuration=l),c.duration=l,c.msDuration=e.millisecondsFromTs(l),a(e,s,r))return[];e.isAudio&&(void 0===e.samplesPerFrame&&function(e,t){t>0&&(e.tsPerFrame=t,e.msPerFrame=1e3*t/e.timescale,e.samplesPerFrame=e.samplingRate*t/e.timescale)}(e,l),e.alignBase&&(e.prevSample&&(n(u,e,{prevTs:e.prevSample.ts,prevSamplCntTs:e.prevSample.samplCntTs,nextSamplCntTs:c.samplCntTs,data:e.silence?e.silence:c.data}),e.prevSample=void 0),e.alignBase=void 0)),u.push(c);var h=0;e.isAudio&&(h=n(u,e,{prevTs:c.ts,prevSamplCntTs:c.samplCntTs,nextSamplCntTs:e.sampleCountFromTs(s),data:e.silence?e.silence:c.data}),c.samplCntDur=e.samplesPerFrame);var d=r;return null===d&&e.isAudio&&(d=e.silence,e.lastSilenceSampleTs=s),e.lastSample={data:d,sap:i,ts:s,rawts:f,samplCntTs:h,msTs:e.millisecondsFromTs(s)},u}function u(e){var i;switch(e.codec){case"OPUS":i=function(e){var t=new Uint8Array(19);t.set([79,112,117,115,72,101,97,100],0);var i=8;return t[i++]=1,t[i++]=e.channels,t[i++]=255&e.preSkipSamples,t[i++]=(65280&e.preSkipSamples)>>8,t[i++]=255&e.samplingRate,t[i++]=(65280&e.samplingRate)>>8,t[i++]=(16711680&e.samplingRate)>>16,t[i++]=(4278190080&e.samplingRate)>>24,t[i++]=0,t[i++]=0,t[18]=0,t}(e);break;default:t.error("Audio header generation is not supported for codec",e.codec)}return i}function c(e,t,i){var n=r.default.createElement("Cluster",e);r.default.createElement("Timecode",n,i.msTs);var o=r.default.createElement("SimpleBlock",n);o.sap=i.sap,o.timecode=0,o.trackNumber=t.id,o.frame=i.data}function l(i){for(var r,n=0;n<e.length;n++)if(e[n].id==i){r=e[n];break}return void 0===r&&t.error("track ID "+i+" is not found!"),r}this.reset=function(){e=[],i=1},this.free=function(){},this.isReady=function(){return!0},this.addTrack=function(r,n){var o={id:i,type:r,isAudio:"audio"===r,curSeqNumber:0,lastSampleDuration:0,lastSilenceSampleTs:0,sampleCountFromTs:function(e){return Math.floor(this.samplingRate/this.timescale*e+.5)},millisecondsFromTs:function(e){return Math.floor(1e3*e/this.timescale+.5)}};if(t.setPrefix("WebmComposer "+r),n)switch(o.timescale=n.timescale,r){case"video":o.codec=n.codec?n.codec.toUpperCase():"VP8",o.width=n.width||0,o.height=n.height||0;break;case"audio":o.codec=n.codec.toUpperCase(),o.samplingRate=48e3,o.channels=2,o.preSkipSamples=3840,o.seekPreRollNanoSec=8e7,o.silence=new Uint8Array([252,255,254])}return e.push(o),i++,o},this.setTrackParams=function(e,i){var r=l(e);return r&&("codec"in i&&(i.codec=i.codec.toUpperCase()),"width"in i&&(r.width=i.width),"height"in i&&(r.height=i.height),"timescale"in i&&(r.timescale=i.timescale),"sequenceNumber"in i&&(r.curSeqNumber=i.sequenceNumber),"alignBase"in i&&(r.alignBase=i.alignBase),"syncBase"in i&&(r.syncBase=i.syncBase),t.debug("setTrackParams: ",e,i)),r},this.getTrackSampleDuration=function(e,t){var i,r=l(e);return r&&(i=r.tsPerFrame),i},this.getTrackAudioInfo=function(e){var t,i=l(e);return i&&(t={samplingRate:i.samplingRate,channels:i.channels}),t},this.isTrackSilent=function(e){var t,i=l(e);return i&&i.isAudio&&(t=i.lastSilenceSampleTs>0),t},this.setBaseSample=function(e,i,r){var n=l(e);if(n){var a=r;if(n.syncBase){if(n.syncSample){var s=r-n.syncSample.rawts;o(s)&&(t.debug("setBaseSample discontinuity: "+s,r,n.syncSample.ts,n.syncSample.rawts,n.lastSampleDuration),s=n.lastSampleDuration),r=n.syncSample.ts+s,n.syncSample=void 0}n.syncBase=void 0}var u=i,c=0;n.isAudio&&(n.lastSilenceSampleTs=0,null===u&&(u=n.silence,n.lastSilenceSampleTs=r),c=n.sampleCountFromTs(r)),n.lastSample={data:u,sap:!0,ts:r,rawts:a,samplCntTs:c,msTs:n.millisecondsFromTs(r)},t.debug("setBaseSample: ",n.type,r)}else t.error("setBaseSample: track "+e+" not found!!!")},this.getRealTs=function(e,i){var r=i,n=l(e);if(n){if(n.lastSample){var o=n.lastSample.ts-n.lastSample.rawts;0!==o&&(o>0&&i<n.lastSample.ts||i>=n.lastSample.rawts)&&(r=i+o)}}else t.error("getRealTs: track ".concat(e," not found"));return r},this.initSegment=function(){var t=r.default.createFile();!function(e){var t=r.default.createElement("EBML",e);r.default.createElement("EBMLVersion",t,1),r.default.createElement("EBMLReadVersion",t,1),r.default.createElement("EBMLMaxIDLength",t,4),r.default.createElement("EBMLMaxSizeLength",t,8),r.default.createElement("DocType",t,"webm"),r.default.createElement("DocTypeVersion",t,4),r.default.createElement("DocTypeReadVersion",t,2)}(t);var i=function(e){var t=r.default.createElement("Segment",e);return t._unbound=!0,t}(t);return function(e){var t=r.default.createElement("SegmentInfo",e);r.default.createElement("TimecodeScale",t,1e6),r.default.createElement("MuxingApp",t,"sldp-player"),r.default.createElement("WritingApp",t,"sldp-player")}(i),function(t){for(var i=r.default.createElement("Tracks",t),n=0;n<e.length;n++){var o="video"==e[n].type,a=r.default.createElement("TrackEntry",i);if(r.default.createElement("TrackNumber",a,e[n].id),r.default.createElement("TrackUID",a,e[n].id),r.default.createElement("FlagLacing",a,0),r.default.createElement("Language",a,"und"),r.default.createElement("CodecName",a,e[n].codec),r.default.createElement("TrackType",a,o?1:2),r.default.createElement("CodecID",a,o?"V_"+e[n].codec:"A_"+e[n].codec),o){var s=r.default.createElement("Video",a);r.default.createElement("PixelWidth",s,e[n].width),r.default.createElement("PixelHeight",s,e[n].height)}else{r.default.createElement("SeekPreRoll",a,e[n].seekPreRollNanoSec),r.default.createElement("CodecPrivate",a,u(e[n]));var c=r.default.createElement("Audio",a);r.default.createElement("SamplingFrequency",c).frequency=e[n].samplingRate,r.default.createElement("Channels",c,e[n].channels)}}}(i),t.write()},this.mediaSegment=function(e,i,n){var o,a=l(e),u=[],f=[];if(a){for(var h=[],d=0;d<i.length;d++)if(a.lastSample)for(var p=s(a,i[d].sap,i[d].data,i[d].ts),v=0;v<p.length;v++)h.push(p[v]),u.push(p[v].ts),f.push(p[v].sap);else t.error("mediaSegment is executed while no base sample is set. Compelled setting of base sample: ",i[d].sap,i[d].ts),i[d].sap&&this.setBaseSample(e,i[d].data,i[d].ts);if(n&&void 0!==a.lastSample&&(a.lastSample.duration=a.lastSampleDuration,t.debug("Push last sample, ts = ".concat(a.lastSample.ts,", duration = ").concat(a.lastSample.duration)),h.push(a.lastSample),u.push(a.lastSample.ts),f.push(a.lastSample.sap),a.alignBase&&(a.prevSample={ts:a.lastSample.ts,samplCntTs:a.lastSample.samplCntTs}),a.syncBase&&(a.syncSample={ts:a.lastSample.ts,rawts:a.lastSample.rawts}),a.lastSample=void 0),h.length>0){for(var m=r.default.createFile(),y=0;y<h.length;y++)c(m,a,h[y]);a.curSeqNumber++,o={ts:u,sap:f,sn:a?a.curSeqNumber-1:void 0,data:m.write()}}}return o}}return{create:function(){return new i}}}},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(i(326)),n=o(i(327));function o(e){return e&&e.__esModule?e:{default:e}}var a={createFile:function(){return new n.default},createElement:function(e,t,i){var n=r.default.create(e,i);return t&&(n._root=t._root?t._root:t,n._parent=t,t.elements.push(n)),n}};t.default=a},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(48),i(139),i(4),i(2),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(68),i(69),i(70),i(71),i(72);var r,n=(r=i(140))&&r.__esModule?r:{default:r},o=281474976710656,a={EBML:440786851,EBMLVersion:17030,EBMLReadVersion:17143,EBMLMaxIDLength:17138,EBMLMaxSizeLength:17139,DocType:17026,DocTypeVersion:17031,DocTypeReadVersion:17029,Segment:408125543,SegmentInfo:357149030,TimecodeScale:2807729,MuxingApp:19840,WritingApp:22337,Duration:17545,Tracks:374648427,TrackEntry:174,TrackNumber:215,TrackUID:29637,FlagLacing:156,Language:2274716,CodecID:134,CodecName:2459272,TrackType:131,SeekPreRoll:22203,Video:224,PixelWidth:176,PixelHeight:186,Cluster:524531317,Timecode:231,SimpleBlock:163,Audio:225,SamplingFrequency:181,Channels:159,CodecPrivate:25506},s=function(){this._cursor=new n.default};s.create=function(e,t){var i=new s;return i.id=a[e],i.elements=[],void 0!==t&&(i._data=t),i},s.prototype._elemProcessors={},s.prototype.getLength=function(){this._rawo=null,this.size=0,this._idLength=this._measureUint(this.id);for(var e=0;e<this.elements.length;e++)this.size+=this.elements[e].getLength();return this._elemProcessors[this.id]&&this._elemProcessors[this.id].call(this),void 0!==this._data&&this._processData(this._data),this._unbound?this._sizeLength=1:this._sizeLength=this._measureVarInt(this.size),this.size+this._idLength+this._sizeLength},s.prototype.write=function(){this._cursor.offset=this._parent._cursor.offset;var e=this._idLength+this._sizeLength+this.size;0===this.size?this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset):this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,e),this._writeField("uint",this.id,this._idLength),this._unbound?this._writeField("uint",255,1):this._writeField("vint",this.size,this._sizeLength);for(var t=0;t<this.elements.length;t++)this.elements[t].write();return this._elemProcessors[this.id]&&this._elemProcessors[this.id].call(this),void 0!==this._data&&this._processData(this._data),this._parent._cursor.offset+=e,e},s.prototype._setU8=function(e){this._rawo.setUint8(this._viewOffset,e),this._viewOffset++},s.prototype._setFloat32=function(e){this._rawo.setFloat32(this._viewOffset,e,!1),this._viewOffset+=4},s.prototype._setFloat64=function(e){this._rawo.setFloat64(this._viewOffset,e,!1),this._viewOffset+=8},s.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Uint8Array)this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length;else if(e instanceof Array){this._cursor.offset,this._rawo.byteOffset;for(var t=0;t<e.length;t++)this._setU8(e[t]);this._cursor.offset+=e.length}}else this.size+=e.length},s.prototype._writeString=function(e){if(this._rawo){this._viewOffset=this._cursor.offset-this._rawo.byteOffset;for(var t=0;t<e.length;t++)this._setU8(e.charCodeAt(t));this._cursor.offset+=e.length}else this.size+=e.length},s.prototype._writeVarInt=function(e,t){if(void 0===t&&(t=this._measureVarInt(e)),this._rawo){switch(this._viewOffset=this._cursor.offset-this._rawo.byteOffset,t){case 1:this._setU8(128|e);break;case 2:this._setU8(64|e>>8);break;case 3:this._setU8(32|e>>16);break;case 4:this._setU8(16|e>>24);break;case 5:this._setU8(8|Math.floor(e/4294967296));break;case 6:this._setU8(4|Math.floor(e/1099511627776));break;case 7:this._setU8(2|Math.floor(e/o));break;case 8:this._setU8(1)}switch(t){case 8:this._setU8(Math.floor(e/o));case 7:this._setU8(Math.floor(e/1099511627776));case 6:this._setU8(Math.floor(e/4294967296));case 5:this._setU8(e>>24);case 4:this._setU8(e>>16);case 3:this._setU8(e>>8);case 2:this._setU8(e)}this._cursor.offset+=t}else this.size+=t},s.prototype._writeFloat=function(e,t){if(4!==t&&8!==t)throw new RuntimeException("Bad float size",t);this._rawo?(this._viewOffset=this._cursor.offset-this._rawo.byteOffset,4===t?this._setFloat32(e):this._setFloat64(e),this._cursor.offset+=t):this.size+=t},s.prototype._writeUint=function(e,t){if(void 0===t&&(t=this._measureUint(e)),this._rawo){switch(this._viewOffset=this._cursor.offset-this._rawo.byteOffset,t){case 8:this._setU8(e/72057594037927940>>>0);case 7:this._setU8(e/o>>>0);case 6:this._setU8(e/1099511627776>>>0);case 5:this._setU8(e/4294967296>>>0);case 4:this._setU8(e>>24);case 3:this._setU8(e>>16);case 2:this._setU8(e>>8);case 1:this._setU8(e);break;default:throw new RuntimeException("Bad UINT size",t)}this._cursor.offset+=t}else this.size+=t},s.prototype._measureVarInt=function(e){if(e<127)return 1;if(e<16383)return 2;if(e<2097151)return 3;if(e<268435455)return 4;if(e<34359738367)return 5;if(e<4398046511103)return 6;if(e<562949953421311)return 7;if(e<72057594037927940)return 8;throw new RuntimeException("EBML VINT size not supported",e)},s.prototype._measureUint=function(e){return e<256?1:e<65536?2:e<16777216?3:e<4294967296?4:e<1099511627776?5:e<o?6:e<72057594037927940?7:8},s.prototype._writeField=function(e,t,i){switch(e){case"float":this._writeFloat(t,i);break;case"uint":this._writeUint(t,i);break;case"vint":this._writeVarInt(t,i);break;case"string":this._writeString(t,i);break;case"data":this._writeData(t)}},s.prototype._processData=function(e){"number"==typeof e?this._writeField("uint",e):"string"==typeof e?this._writeField("string",e):this._writeField("data",e)},s.prototype._elemProcessors[a.SimpleBlock]=function(){this._writeField("vint",this.trackNumber),this._writeField("uint",this.timecode,2);var e=this.sap?128:0;this._writeField("uint",e,1),this._writeField("data",this.frame)},s.prototype._elemProcessors[a.SamplingFrequency]=function(){this._writeField("float",this.frequency,4)};var u=s;t.default=u},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(2),i(48),i(4),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(68),i(69),i(70),i(71),i(72),i(139);var r,n=(r=i(140))&&r.__esModule?r:{default:r},o=function(){this._cursor=new n.default,this.elements=[]};o.prototype.write=function(){var e=0,t=0;for(t=0;t<this.elements.length;t++)e+=this.elements[t].getLength();var i=new Uint8Array(e);for(this._rawo=new DataView(i.buffer),this.bytes=i,this._cursor.offset=0,t=0;t<this.elements.length;t++)this.elements[t].write();return i.buffer};var a=o;t.default=a},function(e,t,i){"use strict";i(0),i(11),i(158),i(159),i(160),i(161),i(110),i(111),i(162),i(163),i(41),i(112),i(164),i(165),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(2),i(4),i(124),i(7),i(8),i(48),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(68),i(69),i(70),i(71),i(72),i(26),i(12),i(13),i(9),i(10),i(14);var r=o(i(116)),n=o(i(18));function o(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(){s=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(e,t,i){e[t]=i.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",u=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function l(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,i){return e[t]=i}}function f(e,t,i,n){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new T(n||[]);return r(a,"_invoke",{value:function(e,t,i){var r="suspendedStart";return function(n,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===n)throw o;return{value:void 0,done:!0}}for(i.method=n,i.arg=o;;){var a=i.delegate;if(a){var s=S(a,i);if(s){if(s===d)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===r)throw r="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r="executing";var u=h(e,t,i);if("normal"===u.type){if(r=i.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r="completed",i.method="throw",i.arg=u.arg)}}}(e,i,s)}),a}function h(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=f;var d={};function p(){}function v(){}function m(){}var y={};l(y,o,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(P([])));b&&b!==t&&i.call(b,o)&&(y=b);var _=m.prototype=p.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){var n;r(this,"_invoke",{value:function(r,o){function s(){return new t((function(n,s){!function r(n,o,s,u){var c=h(e[n],e,o);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==a(f)&&i.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,u)}))}u(c.arg)}(r,o,n,s)}))}return n=n?n.then(s,s):s()}})}function S(e,t){var i=t.method,r=e.iterator[i];if(void 0===r)return t.delegate=null,"throw"===i&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==i&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),d;var n=h(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,d;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function P(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:x}}function x(){return{value:void 0,done:!0}}return v.prototype=m,r(_,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:v,configurable:!0}),v.displayName=l(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},w(A.prototype),l(A.prototype,u,(function(){return this})),e.AsyncIterator=A,e.async=function(t,i,r,n,o){void 0===o&&(o=Promise);var a=new A(f(t,i,r,n),o);return e.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(_),l(_,c,"Generator"),l(_,o,(function(){return this})),l(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),i=[];for(var r in t)i.push(r);return i.reverse(),function e(){for(;i.length;){var r=i.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=P,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(i,r){return a.type="throw",a.arg=e,t.next=i,r&&(t.method="next",t.arg=void 0),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),C(i),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;C(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:P(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),d}},e}function u(e,t,i,r,n,o,a){try{var s=e[o](a),u=s.value}catch(e){return void i(e)}s.done?t(u):Promise.resolve(u).then(r,n)}function c(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function a(e){u(o,r,n,a,s,"next",e)}function s(e){u(o,r,n,a,s,"throw",e)}a(void 0)}))}}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function f(e,t,i){return(t=h(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e){var t=function(e,t){if("object"!==a(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===a(t)?t:String(t)}t.default=function(e){var t=new n.default.create(e,"OpusPcmComposer"),o=function(){function e(n){var o,a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"_onModuleAdded",(o=c(s().mark((function e(i){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.OpusDecoderWebWorker,t.debug("Opus decoder module is loaded"),a._decoder=new r,e.next=5,a._decoder.ready;case 5:a._ready=!0;case 6:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})),f(this,"_onModuleNotFound",(function(e){t.debug("Opus decoder module is not found",e.request),a._modUrl=e.request;var r=a;a._spProvider.runWebpackImportUnderScriptPath((function(){i.e(1).then(i.bind(null,248)).then(r._onModuleAdded).catch(r._onModuleError)}))})),f(this,"_onModuleError",(function(e){t.error(a._spProvider.notAvailableError("Opus decoder",a._modUrl))})),this._ready=!1,this.reset(),this._spProvider=r.default.getInstance(n),i.e(1).then(i.bind(null,248)).then(this._onModuleAdded).catch(this._onModuleNotFound)}var n,o,a;return n=e,(o=[{key:"reset",value:function(){this._tracks=[],this._nextTrackID=1}},{key:"free",value:function(){this._ready&&(this._decoder.free(),this._ready=!1)}},{key:"postInit",value:(a=c(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._ready||!this._run){e.next=3;break}return e.next=3,this._decoder.reset();case 3:this._run=!0;case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"isReady",value:function(){return this._ready}},{key:"addTrack",value:function(e,t){var i={id:this._nextTrackID,curSeqNumber:0,lastSampleDuration:0,lastSilenceSampleTs:0,sampleCountFromTs:function(e){return Math.floor(this.samplingRate/this.timescale*e+.5)},millisecondsFromTs:function(e){return Math.floor(1e3*e/this.timescale+.5)}};return t&&(i.timescale=t.timescale,i.codec=t.codec.toUpperCase(),i.samplingRate=48e3,i.channels=2,i.silence=new Uint8Array([252,255,254])),this._tracks.push(i),this._nextTrackID++,i}},{key:"setTrackParams",value:function(e,i){var r=this._findTrackById(e);return r&&("codec"in i&&(i.codec=i.codec.toUpperCase()),"timescale"in i&&(r.timescale=i.timescale),"sequenceNumber"in i&&(r.curSeqNumber=i.sequenceNumber),"alignBase"in i&&(r.alignBase=i.alignBase),"syncBase"in i&&(r.syncBase=i.syncBase),t.debug("setTrackParams: ",e,i)),r}},{key:"getTrackSampleDuration",value:function(e,t){var i=this._findTrackById(e);if(i)return i.tsPerFrame}},{key:"getTrackAudioInfo",value:function(e){var t=this._findTrackById(e);if(t)return{samplingRate:t.samplingRate,channels:t.channels}}},{key:"isTrackSilent",value:function(e){var t=this._findTrackById(e);if(t)return t.lastSilenceSampleTs>0}},{key:"setBaseSample",value:function(e,i,r){var n=this._findTrackById(e);if(n){var o=r;if(n.syncBase){if(n.syncSample){var a=r-n.syncSample.rawts;this._tsDiscontinuity(a)&&(t.debug("setBaseSample discontinuity: "+a,r,n.syncSample.ts,n.syncSample.rawts,n.lastSampleDuration),a=n.lastSampleDuration),r=n.syncSample.ts+a,n.syncSample=void 0}n.syncBase=void 0}var s=i;n.lastSilenceSampleTs=0,null===s&&(s=n.silence,n.lastSilenceSampleTs=r),n.lastSample={data:s,sap:!0,ts:r,rawts:o,samplCntTs:n.sampleCountFromTs(r),msTs:n.millisecondsFromTs(r)},t.debug("setBaseSample: ",n.type,r)}else t.error("setBaseSample: track "+e+" not found!!!")}},{key:"getRealTs",value:function(e,i){var r=i,n=this._findTrackById(e);if(n){if(n.lastSample){var o=n.lastSample.ts-n.lastSample.rawts;0!==o&&(o>0&&i<n.lastSample.ts||i>=n.lastSample.rawts)&&(r=i+o)}}else t.error("getRealTs: track ".concat(e," not found"));return r}},{key:"initSegment",value:function(){return null}},{key:"mediaSegment",value:function(e,i,r){var n,o=this._findTrackById(e),a=[],s=[];if(o){for(var u=[],c=0;c<i.length;c++)if(o.lastSample)for(var l=this._processSample(o,i[c].sap,i[c].data,i[c].ts),f=0;f<l.length;f++)u.push(l[f].data),a.push(l[f].ts),s.push(l[f].sap);else t.error("mediaSegment is executed while no base sample is set. Compelled setting of base sample: ",i[c].sap,i[c].ts),i[c].sap&&this.setBaseSample(e,i[c].data,i[c].ts);r&&void 0!==o.lastSample&&(o.lastSample.duration=o.lastSampleDuration,t.debug("Push last sample, ts = ".concat(o.lastSample.ts,", duration = ").concat(o.lastSample.duration)),u.push(o.lastSample.data),a.push(o.lastSample.ts),s.push(o.lastSample.sap),o.alignBase&&(o.prevSample={ts:o.lastSample.ts,samplCntTs:o.lastSample.samplCntTs}),o.syncBase&&(o.syncSample={ts:o.lastSample.ts,rawts:o.lastSample.rawts}),o.lastSample=void 0),u.length>0&&(o.curSeqNumber++,n={ts:a,sap:s,sn:o?o.curSeqNumber-1:void 0,data:this._decoder.decodeFrames(u)})}return n}},{key:"_setAudioSampleParamsFor",value:function(e,t){t>0&&(e.tsPerFrame=t,e.msPerFrame=1e3*t/e.timescale,e.samplesPerFrame=e.samplingRate*t/e.timescale)}},{key:"_recoverAudioGapIfExists",value:function(e,i,r){var n=r.prevSamplCntTs+i.samplesPerFrame,o=r.nextSamplCntTs-n;if(o>=i.samplesPerFrame&&o<=10*i.samplingRate){t.debug("recover audio gap effShift = ".concat(o,", prevTs = ").concat(r.prevTs,", prevSamplCntTs = ").concat(r.prevSamplCntTs,", nextSamplCntTs = ").concat(r.nextSamplCntTs));for(var a=Math.floor(o/i.samplesPerFrame),s=r.prevTs,u=0;u<a;u++){s+=i.tsPerFrame;var c={data:r.data,sap:!0,ts:s,msTs:i.millisecondsFromTs(s),msDuration:i.msPerFrame,samplCntTs:n,samplCntDur:i.samplesPerFrame};e.push(c),n+=i.samplesPerFrame}t.warn("adding dummy frames",e.length-1,n,r.nextSamplCntTs)}return n}},{key:"_tsDiscontinuity",value:function(e,t){return t<0||t>10*e.timescale}},{key:"_checkIgnoreRealSamples",value:function(e,i,r){var n=!1;if(e.lastSilenceSampleTs>0&&null!==r){var o=e.lastSilenceSampleTs-i;o>=0?o<5*e.timescale&&(t.debug("Ignore real frames after mute",i,e.lastSilenceSampleTs),n=!0):e.lastSilenceSampleTs=0}return n}},{key:"_processSample",value:function(e,i,r,n){if(this._checkIgnoreRealSamples(e,n,r))return[];var o=[],a=e.lastSample,s=n-a.rawts;this._tsDiscontinuity(e,s)&&(t.debug("Incorrect DTS difference (".concat(s,") between previous (ts: ").concat(a.rawts,", sap: ").concat(a.sap,") and current frame (ts: ").concat(n,", sap: ").concat(i,")")),s=e.lastSampleDuration);var u=n;if(n=a.ts+s,s>0&&(e.lastSampleDuration=s),a.duration=s,a.msDuration=e.millisecondsFromTs(s),this._checkIgnoreRealSamples(e,n,r))return[];void 0===e.samplesPerFrame&&this._setAudioSampleParamsFor(e,s),e.alignBase&&(e.prevSample&&(this._recoverAudioGapIfExists(o,e,{prevTs:e.prevSample.ts,prevSamplCntTs:e.prevSample.samplCntTs,nextSamplCntTs:a.samplCntTs,data:e.silence?e.silence:a.data}),e.prevSample=void 0),e.alignBase=void 0),o.push(a);var c=this._recoverAudioGapIfExists(o,e,{prevTs:a.ts,prevSamplCntTs:a.samplCntTs,nextSamplCntTs:e.sampleCountFromTs(n),data:e.silence?e.silence:a.data});a.samplCntDur=e.samplesPerFrame;var l=r;return null===l&&(l=e.silence,e.lastSilenceSampleTs=n),e.lastSample={data:l,sap:i,ts:n,rawts:u,samplCntTs:c,msTs:e.millisecondsFromTs(n)},o}},{key:"_findTrackById",value:function(e){for(var i,r=0;r<this._tracks.length;r++)if(this._tracks[r].id==e){i=this._tracks[r];break}return void 0===i&&t.error("track ID ".concat(e," is not found")),i}}])&&l(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();return{create:function(){return new o}}}},function(e,t,i){"use strict";i(0),i(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(2),i(4),i(124),i(7),i(8),i(227),i(12),i(13),i(9),i(10),i(14);var r=i(33),n=a(i(116)),o=(a(i(114)),a(i(18)));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function c(e,t,i){return(t=l(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===s(t)?t:String(t)}var f=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"_onModuleAdded",(function(e){var t=e.default;r._logger.debug("CEA608 module is loaded"),r._handlers.push(new t(r._instId,r._captionPresenter))})),c(this,"_onModuleNotFound",(function(e){r._logger.debug("CEA608 module not found",e.request),r._modUrl=e.request;var t=r;r._spProvider.runWebpackImportUnderScriptPath((function(){i.e(0).then(i.t.bind(null,247,7)).then(t._onModuleAdded).catch(t._onModuleError)}))})),c(this,"_onModuleError",(function(e){r._logger.error(r._spProvider.notAvailableError("CEA608 captions decoder",r._modUrl))})),this._instId=t,this._handlers=[],this._spProvider=n.default.getInstance(t),this._logger=o.default.create(t,"SEI Processor"),this._ordered=[],this._mGopEndTime=0}var t,r;return t=e,(r=[{key:"addCea608CaptionsHandler",value:function(e){this._captionPresenter=e,i.e(0).then(i.t.bind(null,247,7)).then(this._onModuleAdded).catch(this._onModuleNotFound)}},{key:"handleFrame",value:function(e,t){if(0!==this._handlers.length){if(e>this._mGopEndTime){this._ordered.sort((function(e,t){return e.pTime-t.pTime}));for(var i=0;i<this._ordered.length;i++)this._process(this._ordered[i].pTime,this._ordered[i].frame);this._ordered=[],this._mGopEndTime=e}this._ordered.push({pTime:e,frame:t})}}},{key:"_process",value:function(e,t){for(var i=0;i<t.byteLength-4;){var r=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3];if(6==(31&t[i+=4]))for(var n=i+1;n<i+r-1;){for(var o=0,a=255;255===a;)o+=a=t[n],n++;var s=0;for(a=255;255===a;)s+=a=t[n],n++;for(var u=0;u<this._handlers.length;u++)if(this._handlers[u].isMatching(o,s,t,n)){this._handlers[u].handleUnit(e,t,[n,s]);break}n+=s}i+=r}}},{key:"reset",value:function(){for(var e=0;e<this._handlers.length;e++)this._handlers[e].reset();this._ordered=[],this._mGopEndTime=0}}])&&u(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),h=(0,r.multiInstanceHolder)(f);t.default=h},function(e,t,i){var r=i(90).PROPER,n=i(3),o=i(136);e.exports=function(e){return n((function(){return!!o[e]()||"â€‹Â…á Ž"!=="â€‹Â…á Ž"[e]()||r&&o[e].name!==e}))}},function(e,t,i){"use strict";var r=i(76),n=i(19),o=i(5),a=i(229),s=i(3),u=i(22),c=i(16),l=i(85),f=i(35),h=i(45),d=i(24),p=i(73),v=i(230),m=i(98),y=i(332),g=i(231),b=i(15)("replace"),_=Math.max,w=Math.min,A=o([].concat),S=o([].push),k=o("".indexOf),C=o("".slice),T="$0"==="a".replace(/./,"$0"),P=!!/./[b]&&""===/./[b]("a","$0");a("replace",(function(e,t,i){var o=P?"$":"$0";return[function(e,i){var r=p(this),o=l(e)?void 0:m(e,b);return o?n(o,e,r,i):n(t,d(r),e,i)},function(e,n){var a=u(this),s=d(e);if("string"==typeof n&&-1===k(n,o)&&-1===k(n,"$<")){var l=i(t,a,s,n);if(l.done)return l.value}var p=c(n);p||(n=d(n));var m=a.global;if(m){var b=a.unicode;a.lastIndex=0}for(var T=[];;){var P=g(a,s);if(null===P)break;if(S(T,P),!m)break;""===d(P[0])&&(a.lastIndex=v(s,h(a.lastIndex),b))}for(var x,E="",B=0,M=0;M<T.length;M++){for(var R=d((P=T[M])[0]),I=_(w(f(P.index),s.length),0),F=[],L=1;L<P.length;L++)S(F,void 0===(x=P[L])?x:String(x));var O=P.groups;if(p){var j=A([R],F,I,s);void 0!==O&&S(j,O);var D=d(r(n,void 0,j))}else D=y(R,s,I,F,O,n);I>=B&&(E+=C(s,B,I)+D,B=I+R.length)}return E+C(s,B)}]}),!!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!T||P)},function(e,t,i){var r=i(5),n=i(25),o=Math.floor,a=r("".charAt),s=r("".replace),u=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,i,r,f,h){var d=i+e.length,p=r.length,v=l;return void 0!==f&&(f=n(f),v=c),s(h,v,(function(n,s){var c;switch(a(s,0)){case"$":return"$";case"&":return e;case"`":return u(t,0,i);case"'":return u(t,d);case"<":c=f[u(s,1,-1)];break;default:var l=+s;if(0===l)return n;if(l>p){var h=o(l/10);return 0===h?n:h<=p?void 0===r[h-1]?a(s,1):r[h-1]+a(s,1):n}c=r[l-1]}return void 0===c?"":c}))}},function(e,t,i){"use strict";i(0),i(11),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(334),i(48),i(4),i(2),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(68),i(69),i(70),i(71),i(72),i(26),i(238),i(79),i(12),i(13),i(9),i(10),i(14);var r=o(i(241)),n=o(i(18));function o(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===a(n=function(e,t){if("object"!==a(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}t.default=function(e){var t=n.default.create(e,"WS"),i=new r.default(e).create(),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metricsManager=t,this.stop_audio=!1,this.curSocketId=0,this.isLogging=!1,this.useSteady=!1,this.dtsEqPts=!1,this.loggerData={video:{frames:[],prevTime:0,sumTimes:0,times:[],thresh:60,avg:void 0},audio:{frames:[],prevTime:0,sumTimes:0,times:[],thresh:60,avg:void 0}}}var r,n;return r=e,(n=[{key:"open",value:function(e){try{var r=e.substring(0,5);if("ws://"!=r&&"wss:/"!=r&&(e="ws://"+e),void 0!==this.socket)throw t.error("attempt to open socket when socket exists!",this.socket,e),"Socket open error";this.socket=new WebSocket(e,["sldp.softvelum.com"])}catch(e){return t.error(""+e.message),!1}function n(e,t){e.isLogging&&void 0===e.loggerData[t]&&(e.loggerData[t]={frames:[],prevTime:0,sumTimes:0,times:[],thresh:60,avg:void 0})}return this.socket.binaryType="arraybuffer",this.socket.sampleCounter=0,this.socket.transport=this,this.socket.socketId=++this.curSocketId,this.socket.streamURL=e,this.socket.onopen=function(){t.debug("Connection established.")},this.socket.onclose=function(e){e.wasClean?t.debug("Connection closed clean"):(t.debug("Connection dropped",this),this.socketId==this.transport.curSocketId&&(3==this.readyState&&(this.transport.socket=void 0),this.transport.onConnectionClosedCallback&&this.transport.onConnectionClosedCallback()));var r=i.closeCodes[e.code]||"";t.debug("Close code "+e.code+"("+r+") reason: "+e.reason)},this.socket.onmessage=function(e){if(e.data instanceof ArrayBuffer){var r,o=new Uint8Array(e.data),a=o[0],s=o[1],u=0,c=10,l=o.byteLength;switch(s){case i.liveFrameTypes.WEB_AAC_SEQUENCE_HEADER:case i.liveFrameTypes.WEB_AVC_SEQUENCE_HEADER:case i.liveFrameTypes.WEB_HEVC_SEQUENCE_HEADER:case i.liveFrameTypes.WEB_AV1_SEQUENCE_HEADER:if(t.debug("".concat(0===s?"audio":"video"," init segment, trackId: ").concat(a)),this.transport.onInitSegmentReceivedCallback){var f=o.subarray(2,l);this.transport.onInitSegmentReceivedCallback(a,f),this.transport.metricsManager.run(a),n(this.transport,a)}break;case i.liveFrameTypes.WEB_MP3:if(this.transport.metricsManager.isReadyToStart(a)){var h=o.subarray(10,14);this.transport.onInitSegmentReceivedCallback(a,h),this.transport.metricsManager.run(a),n(this.transport,a)}case i.liveFrameTypes.WEB_AAC_FRAME:if(this.transport.onDataReceivedCallback&&0==this.transport.stop_audio){r=i.readValue(o,2,8),this.transport.useSteady&&(u=i.readValue(o,c,8),c+=8);var d=o.subarray(c,l);this.transport.onDataReceivedCallback(a,!0,d,r,0,u)}break;case i.liveFrameTypes.WEB_AVC_KEY_FRAME:case i.liveFrameTypes.WEB_AVC_FRAME:case i.liveFrameTypes.WEB_HEVC_KEY_FRAME:case i.liveFrameTypes.WEB_HEVC_FRAME:case i.liveFrameTypes.WEB_AV1_KEY_FRAME:case i.liveFrameTypes.WEB_AV1_FRAME:if(this.transport.onDataReceivedCallback){r=i.readValue(o,2,8),this.transport.useSteady&&(u=i.readValue(o,c,8),c+=8);var p=0;s!==i.liveFrameTypes.WEB_AV1_KEY_FRAME&&s!==i.liveFrameTypes.WEB_AV1_FRAME&&(p=i.readValue(o,c,4),c+=4),this.transport.dtsEqPts&&(r+=p,p=0);var v=o.subarray(c,l),m=i.liveFrameTypes.WEB_AVC_KEY_FRAME==s||i.liveFrameTypes.WEB_HEVC_KEY_FRAME==s||i.liveFrameTypes.WEB_AV1_KEY_FRAME==s;this.transport.onDataReceivedCallback(a,m,v,r,p,u),r+=p}break;case i.liveFrameTypes.WEB_VP8_KEY_FRAME:case i.liveFrameTypes.WEB_VP9_KEY_FRAME:case i.liveFrameTypes.WEB_OPUS_FRAME:this.transport.metricsManager.isReadyToStart(a)&&(this.transport.onInitSegmentReceivedCallback(a,null),this.transport.metricsManager.run(a),n(this.transport,a));case i.liveFrameTypes.WEB_VP8_FRAME:case i.liveFrameTypes.WEB_VP9_FRAME:if(this.transport.onDataReceivedCallback){r=i.readValue(o,2,8),this.transport.useSteady&&(u=i.readValue(o,c,8),c+=8);var y=o.subarray(c,l),g=i.liveFrameTypes.WEB_VP8_KEY_FRAME==s||i.liveFrameTypes.WEB_VP9_KEY_FRAME==s||i.liveFrameTypes.WEB_OPUS_FRAME==s;this.transport.onDataReceivedCallback(a,g,y,r,0,u)}break;default:t.error("Unknown type of frame received ",s)}this.transport.metricsManager.reportBandwidth(a,l,r),0==this.sampleCounter&1023&&t.debug("sampleCounter",this.sampleCounter),this.sampleCounter+=1}else{t.debug("Command received",e.data);var b=JSON.parse(e.data);"status"==b.command&&this.transport.onStatusReceivedCallback&&this.transport.onStatusReceivedCallback(b.info,b.steady,b.system)}},this.socket.onerror=function(e){t.error("Error happened:",e)},this.socket}},{key:"send",value:function(e){this.socket&&this.socket.send(JSON.stringify(e))}},{key:"close",value:function(){t.debug("socket close ",this.socket),this.socket&&(this.socket.close(1e3),this.socket=void 0),this.onStatusReceivedCallback=void 0,this.onInitSegmentReceivedCallback=void 0,this.onDataReceivedCallback=void 0,this.onConnectionClosedCallback=void 0}},{key:"acceptSteadyTimestamps",value:function(e){this.useSteady=e}},{key:"setDtsEqPtsMode",value:function(e){this.dtsEqPts=e}},{key:"callbacks",set:function(e){this.onStatusReceivedCallback=e.onStatusReceived,this.onInitSegmentReceivedCallback=e.onInitSegmentReceived,this.onDataReceivedCallback=e.onDataReceived,this.onConnectionClosedCallback=e.onConnectionClosed}}])&&s(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();return{create:function(e){return new o(e)}}}},function(e,t,i){"use strict";var r=i(1),n=i(6),o=i(132),a=i(150),s=o.ArrayBuffer;r({global:!0,constructor:!0,forced:n.ArrayBuffer!==s},{ArrayBuffer:s}),a("ArrayBuffer")},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(78),i(40),i(113),i(134),i(41),i(137),i(12),i(13),i(9),i(10),i(4),i(14);var r=s(i(336)),n=s(i(338)),o=s(i(114)),a=s(i(18));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function l(e,t,i){return(t=f(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===u(t)?t:String(t)}s(i(339)),s(i(242));var h=function(){function e(t,i){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l(this,"_handleClicks",function(e){if(this.doubleClickHandler){this.clicks++;var t=this;1==this.clicks&&setTimeout((function(){1==t.clicks?t.singleClickHandler&&t.singleClickHandler(e):t.doubleClickHandler&&t.doubleClickHandler(e),t.clicks=0}),300)}else this.singleClickHandler&&this.singleClickHandler(e)}.bind(this)),l(this,"_handleEnterPip",function(e){e.pictureInPictureWindow,this.pipMode=!0,this._onEnterPip&&this._onEnterPip()}.bind(this)),l(this,"_handleLeavePip",function(e){this.pipMode=!1,this._onLeavePip&&this._onLeavePip()}.bind(this)),l(this,"_mediaElementClick",function(e){var t=!1;this.mobileCtrl?e.target!=this.mobileCtrl&&e.target!=this.mobileCtrlBtn||(this.mobileCtrlVisible?t=!0:this.showControlsForPeriod(4)):e.target==this.mediaElement&&(t=!0),t&&this._playPauseBtnClick(e)}.bind(this)),l(this,"_playPauseBtnClick",function(e){this._isUserActionAcceptable()&&(this.playPauseButton.classList.contains("sldp-icon-play")?(this.mediaElement&&this.hackPlayByPauseOnClick&&(this.mediaElement.pause(),this.hackPlayByPauseOnClick=!1),this._handlePlay(!0)):this._handlePause()),e.stopPropagation()}.bind(this)),l(this,"_handlePlayEvent",function(e){this.deactivated||(this.pipMode?this._handlePlay():this._onPlayEventCallback&&this._onPlayEventCallback())}.bind(this)),l(this,"_handlePauseEvent",function(e){this.deactivated||(this.pipMode?this._handlePause():this._onPauseEventCallback&&this._onPauseEventCallback())}.bind(this)),l(this,"_configBtnClick",function(e){this.cfgDialog?(this.cfgDialog.remove(),delete this.cfgDialog,this.showControlsForPeriod(2)):(this.closeCtrlDialogs(),this.cfgDialog=document.createElement("ul"),this.cfgDialog.className="sldp_cfg_dialog sldp_ctrl_dialog",this._updateCfgDialog(),this.playerWrapper.insertBefore(this.cfgDialog,this.controlBar),this.showControlsForPeriod("infinite")),e.stopPropagation()}.bind(this)),l(this,"_volumeBtnClick",function(e){var t=0;e.currentTarget.classList.contains("sldp-icon-volume-medium")?this.mediaElement.prev_volume=this.volumeController.volume:(null==this.mediaElement.prev_volume&&(0!=this.volumeController.volume?this.mediaElement.prev_volume=this.volumeController.volume:this.mediaElement.prev_volume=1),t=100*this.mediaElement.prev_volume),this._adjustVolume(t),this.showControlsForPeriod(2),e.stopPropagation()}.bind(this)),l(this,"_expandBtnClick",function(e){var t,i=this,r=this.playerWrapper;if(this._isFullscreenMode())document.cancelFullScreen?document.cancelFullScreen():document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();else{var n=!0;r.requestFullscreen?t=r.requestFullscreen():r.mozRequestFullScreen?t=r.mozRequestFullScreen():r.webkitRequestFullscreen?t=r.webkitRequestFullscreen():r.msRequestFullscreen?t=r.msRequestFullscreen():this.mediaElement.webkitEnterFullScreen?(n=!1,this.mediaElement.webkitEnterFullScreen()):n=!1,n&&(this.fullscreenReq=!0,t&&t.catch((function(){i.fullscreenReq=!1})))}e&&e.stopPropagation()}.bind(this)),l(this,"_orientationchangeHandler",function(e){this._isFullscreenMode()&&this._updatePlayerFullscreen()}.bind(this)),l(this,"_fullscreenchangeHandler",function(e){this._isPlayerElement(e.target)&&(this.fullscreenReq=!1,this._isFullscreenMode()?(this._stashCurrentSize(),this._updatePlayerFullscreen()):(this._applyCurrentSize(),this._resizeHandler()))}.bind(this)),l(this,"_fullscreenErrorHandler",function(e){this.fullscreenReq=!1}.bind(this)),l(this,"_webkitendfullscreenHandler",function(e){var t=this;setTimeout((function(){t.mediaElement.play(),t._handlePlay()}),500)}.bind(this)),l(this,"_resizeHandler",function(e){this._onResize&&this._onResize(),this._updateLoadingIndicator()}.bind(this)),this.instId=i,this.settings=t,this.logger=a.default.create(i,"UI"),this.settings.video_element=void 0,this.settings.ar=void 0,this.pipMode=!1,this.orientMq=window.matchMedia("(orientation: portrait)"),this.fullscreenReq=!1,this.can_play=this.settings.autoplay,this.hackPlayByPauseOnClick=!this.settings.autoplay,this.settings.video_element)this.mediaElement=document.getElementById(this.settings.video_element),this.storageId=this.settings.video_element,this.quality_ar=[],this.settings.controls=!1,this.volumeController=new n.default(this.instId,this.settings.vu_meter),this.volumeController.muted=!!this.settings.muted,this._createResizeHandler(),this._createPipHandlers(),this._createPlayPauseHandlers();else{if(this.container=document.getElementById(this.settings.container),!this.container)return void this.logger.error("Container element is not found. Aborting UI setup.");o.default.getElementCoordinates(this.container),this.storageId=this.settings.container,this.quality_ar=[],this.css=new r.default,this._createPlayerWrapper();var s=this.settings.audio_only?"audio":"video";this.mediaElement=document.createElement(s),this.volumeController=new n.default(this.instId,this.settings.vu_meter),this.volumeController.muted=!!this.settings.muted,this._setSplashScreen(),this.settings.audio_only||null!=this.settings.height&&(this.mediaElement.style.height="100%","number"==typeof this.settings.height?this.playerWrapper.style.height="".concat(t.height,"px"):this.playerWrapper.style.height=this.settings.height),void 0!==this.settings.width&&(this.mediaElement.style.width="100%","number"==typeof this.settings.width?this.playerWrapper.style.width="".concat(t.width,"px"):this.playerWrapper.style.width=this.settings.width),this.playerWrapper.appendChild(this.mediaElement),this._createHandlers(),this.settings.controls&&(this._createControls(),this.settings.audio_only&&this.settings.audio_title&&this._addMessage(this.settings.audio_title),this._createLoadingIndicator()),this.settings.fullscreen&&!this.settings.audio_only&&this._expandBtnClick()}this._nullifyContainerLineHeight()}var t,i;return t=e,(i=[{key:"removePip",value:function(e){var t=this;this.pipMode?(this.deactivated=!0,document.exitPictureInPicture().then((function(){t.pipMode=!1,e()}))):e()}},{key:"destroy",value:function(){if(this._revertContainerLineHeight(),this.container){for(this._removeHandlers();this.container.firstChild;)this.container.removeChild(this.container.firstChild);this.playPauseButton=void 0,this.playerWrapper=void 0,this.mobileCtrlBtn=void 0,this.mobileCtrl=void 0,this.css.destroy()}else this._removeResizeHandler(),this._removePipHandlers(),this.mediaElement=void 0;this.volumeController.destroy(),this.volumeController=void 0,this.quality_ar=[],this.stashed=!1}},{key:"showNotSupported",value:function(e){if(this._removeSplashScreen(),this.container?(this._removeHandlers(),this.settings.controls&&(this._removePlayerControls(),this.mobileCtrl&&(e?this.mobileCtrl.style.display="none":(this.mobileCtrl.style.opacity="0",this.mobileCtrlVisible=!1)))):(this._removeResizeHandler(),this._removePipHandlers()),e){this.settings.video_element||(this.mediaElement.style.display="none"),this._addMessage("In order to play this media you will need an application from App Store",'<a href="'+this.settings.ios_failback_app_url+'" style="vertical-align: middle;display:inline-block;overflow:hidden;background:url(http://linkmaker.itunes.apple.com/images/badges/en-us/badge_appstore-lrg.svg) no-repeat;width:202px;height:60px;background-size: 202px 60px;margin-right: 10px;"></a>');var t=this.settings.stream_url;if(t&&t.length>0){var i=t.substring(0,5),r=t.indexOf("?")>0;"ws://"==i?t=this.settings.ios_failback_scheme+"://"+t.substring(5):"wss:/"==i&&(t=this.settings.ios_failback_secure_scheme+"://"+t.substring(6)),this.settings.sync_buffer>0&&(t+=(r?"&":"?")+"steady=true&buffering="+this.settings.sync_buffer),setTimeout((function(){window.location=t}),100)}}else this._addMessage("MediaSource is not supported in current browser")}},{key:"showNotPlaying",value:function(){this._removeSplashScreen(),this.settings.controls&&this._togglePlayButton(!0),this._addMessage("No playable sources found"),this.showControlsForPeriod("infinite")}},{key:"clearMediaElement",value:function(){this.settings.audio_only||(this._finishLoadingIndicator(),this._removeSplashScreen(),this._removeMessage())}},{key:"onPlaybackStarted",value:function(){this._removeSplashScreen()}},{key:"onPlaybackFinished",value:function(){this._setSplashScreen()}},{key:"adjustHeight",value:function(){this.mediaElement&&this.playerWrapper&&!this.fullscreenReq&&this.container.offsetHeight>0&&(this._isFullscreenMode()?this._updateFullscreenWrapperSize():"100%"===this.settings.height&&(this.playerWrapper.style.height="".concat(this.container.offsetHeight,"px")))}},{key:"adjustX",value:function(e,t,i,r){}},{key:"adjustY",value:function(e,t,i){}},{key:"refresh",value:function(){if(this.cfgDialog){for(;this.cfgDialog.firstChild;)this.cfgDialog.removeChild(this.cfgDialog.firstChild);this._updateCfgDialog()}}},{key:"getSize",value:function(){return o.default.getElementSize(this.mediaElement)}},{key:"triggerPlay",value:function(){return this._handlePlay()}},{key:"triggerPause",value:function(e){this._handlePause(e)}},{key:"triggerVolume",value:function(e){this.volumeController&&(e>100?e=100:e<0&&(e=0),this._adjustVolume(e))}},{key:"getVolume",value:function(){if(this.volumeController)return 100*this.volumeController.volume}},{key:"setMuted",value:function(){this.volumeController&&(this.volumeController.muted=!0,this._adjustVolume(100*this.volumeController.volume,!0))}},{key:"setVUMeterHandler",value:function(e){this.volumeController&&this.volumeController.setVUMeter(e)}},{key:"unmuteVUMeter",value:function(){this.volumeController&&this.volumeController.activateVUMeter()}},{key:"getCaptionController",value:function(){return this.captionController}},{key:"_nullifyContainerLineHeight",value:function(){if(!this.settings.audio_only){var e=this.settings.video_element?this.mediaElement.parentElement:this.container;e&&(this.prevParentLineHeight=e.style.lineHeight,e.style.lineHeight=0)}}},{key:"_revertContainerLineHeight",value:function(){if(!this.settings.audio_only){var e=this.settings.video_element?this.mediaElement.parentElement:this.container;e&&(e.style.lineHeight=this.prevParentLineHeight||"")}}},{key:"_getContainerWidth",value:function(){return this.container?this.container.offsetWidth:this.mediaElement.parentElement.offsetWidth}},{key:"_getContainerHeight",value:function(){return this.container?this.container.offsetHeight:this.mediaElement.parentElement.offsetHeight}},{key:"_stashCurrentSize",value:function(){this.stashed||(this.mediaElement.pw_width_prev=this.playerWrapper.style.width,this.mediaElement.pw_height_prev=this.playerWrapper.style.height,this.mediaElement.v_width_prev=this.mediaElement.style.width,this.mediaElement.v_height_prev=this.mediaElement.style.height,this.settings.ar||(this.mediaElement.v_margin_prev=this.mediaElement.style.margin,this.mediaElement.style.margin=""),this.stashed=!0)}},{key:"_applyCurrentSize",value:function(){this.stashed&&(this.mediaElement.style.width=this.mediaElement.v_width_prev,this.mediaElement.style.height=this.mediaElement.v_height_prev,this.playerWrapper.style.width=this.mediaElement.pw_width_prev,this.playerWrapper.style.height=this.mediaElement.pw_height_prev,this.settings.ar||(this.mediaElement.style.margin=this.mediaElement.v_margin_prev),this.stashedContWidth=this.currentContWidth,this.stashedContHeight=this.currentContHeight,this.stashed=!1)}},{key:"_getScreenSize",value:function(){var e=this.orientMq.matches,t=[screen.width,screen.height];return(e&&screen.width>screen.height||!e&&screen.width<screen.height)&&(t[0]=screen.height,t[1]=screen.width),t}},{key:"_processContainerSize",value:function(){if(this.cW=this.settings.width,this.cH=this.settings.height,this._isFullscreenMode()){var e=this._getScreenSize();this.cW=e[0],this.cH=e[1],this._stashCurrentSize()}else{if(this.stashed)return!1;"100%"===this.settings.width&&(this.stashedContWidth?(this.cW=this.stashedContWidth,this.stashedContWidth=void 0):(this.cW=this._getContainerWidth(),this.cW||(this.cW=this.playerWrapper?this.playerWrapper.offsetWidth:this.mediaElement.offsetWidth),this.currentContWidth=this.cW)),"100%"===this.settings.height&&(this.stashedContHeight?(this.cH=this.stashedContHeight,this.stashedContHeight=void 0):(this.cH=this._getContainerHeight(),this.cH||(this.cH=this.playerWrapper?this.playerWrapper.offsetHeight:this.mediaElement.offsetHeight),this.currentContHeight=this.cH)),this.settings.width||this.settings.height||(this.cW=this.mediaElement.offsetWidth)}return!0}},{key:"_createPlayerWrapper",value:function(){var e=document.createElement("div");if(e.className=this.settings.audio_only?"sldp_player_wrp sldp_player_wrp_audio":"sldp_player_wrp sldp_player_wrp_video",this.settings.controls&&!this.settings.audio_only){if(this.settings.autoplay&&this.hideControlsAfterPeriod(2),this.settings.mobile){this.mobileCtrl=document.createElement("div"),this.mobileCtrl.className="sldp_mobile_ctrl",this.mobileCtrlBtn=document.createElement("div");var t=this.settings.autoplay?"sldp-icon-pause-o":"sldp-icon-play-o";this.mobileCtrlBtn.className="sldp_mobile_ctrl_icon "+t,this.mobileCtrl.appendChild(this.mobileCtrlBtn),this.mobileCtrlVisible=!0,e.appendChild(this.mobileCtrl)}e.onmousemove=function(e){this.mobileCtrl||this.settings.audio_only||(this.mouseClientX=e.clientX,this.mouseClientY=e.clientY,this.showControlsForPeriod(2))}.bind(this),e.onmouseout=function(){this.mobileCtrl||this.settings.audio_only||(this.mouseClientX=this.mouseClientY=void 0,this._hideControls())}.bind(this)}this.container.appendChild(e),this.playerWrapper=e}},{key:"_hideControls",value:function(){if(this.controlBar&&!this.settings.audio_only&&this.playPauseButton&&this.playPauseButton.classList.contains("sldp-icon-pause")){var e=!1;if(!this.mobileCtrl&&void 0!==this.mouseClientX&&void 0!==this.mouseClientY){var t=this.controlBar.getBoundingClientRect();t.left<this.mouseClientX&&this.mouseClientX<t.right&&t.top<this.mouseClientY&&this.mouseClientY<t.bottom&&(e=!0)}e?this.hideControlsAfterPeriod(4):this.cfgDialog||this.captionList&&this.captionList.isVisible()||(this.controlBar.style.opacity="0",this.mobileCtrl&&(this.mobileCtrl.style.opacity="0",this.mobileCtrlVisible=!1))}}},{key:"closeCtrlDialogs",value:function(){this.cfgDialog&&(this.cfgDialog.remove(),delete this.cfgDialog),this.captionList&&this.captionList.isVisible()&&this.captionList.closeDialog()}},{key:"hideControlsAfterPeriod",value:function(e){this.settings.controls&&(this.control_hide_delay&&(clearTimeout(this.control_hide_delay),this.control_hide_delay=void 0),this.settings.audio_only||(this.control_hide_delay=setTimeout(function(){this._hideControls()}.bind(this),1e3*e)))}},{key:"_showControls",value:function(){this.controlBar&&(this.controlBar.style.opacity="1",this.mobileCtrl&&(this.mobileCtrl.style.opacity="1",this.mobileCtrlVisible=!0))}},{key:"showControlsForPeriod",value:function(e){this.settings.controls&&(this._showControls(),this.control_hide_delay&&(clearTimeout(this.control_hide_delay),this.control_hide_delay=void 0),"infinite"===e||this.settings.audio_only||(this.control_hide_delay=setTimeout(function(){this._hideControls()}.bind(this),1e3*e)))}},{key:"_addMessage",value:function(e,t){if(this.container){this._removeMessage();var i=document.createElement("div");i.className="sldp_message_wrp";var r=document.createElement("div");if(this.settings.audio_only?(i.className=this.settings.controls?"sldp_message_wrp":"sldp_message_wrp sldp_message_wrp_audio_noctrl",r.className="sldp_message"):(i.className="sldp_message_wrp sldp_message_wrp_video",r.className="sldp_message sldp_message_pad"),r.innerHTML=e,t){var n=document.createElement("div");n.className="ios_button",n.innerHTML=t,r.appendChild(n)}i.appendChild(r),this.playerWrapper.appendChild(i)}}},{key:"_removeMessage",value:function(){if(this.container){var e=this.playerWrapper.getElementsByClassName("sldp_message_wrp")[0];e&&this.playerWrapper.removeChild(e)}}},{key:"_createControls",value:function(){var e=document.createElement("div");if(e.className=this.settings.audio_only?"sldp_cbar sldp_cbar_audio":"sldp_cbar sldp_cbar_video",!this.settings.audio_only){var t=document.createElement("div");t.className="sldp_expand_btn",t.classList.add("sldp_btn"),t.classList.add("sldp-icon-enlarge"),t.onclick=this._expandBtnClick,e.appendChild(t),this.expand_button=t;var i=document.createElement("div");i.className="sldp_config_btn",i.classList.add("sldp_btn"),i.classList.add("sldp-icon-cog"),i.onclick=this._configBtnClick,e.appendChild(i),this.config_button=i}var r=document.createElement("div");r.className="sldp_play_pause_btn",r.classList.add("sldp_btn"),r.classList.add(this.settings.autoplay?"sldp-icon-pause":"sldp-icon-play"),r.onclick=this._playPauseBtnClick,e.appendChild(r);var n=document.createElement("div");n.className="sldp_volume_wrp "+(this.settings.mobile?"sldp_volume_mobile":"sldp_volume_desktop"),this.settings.mobile||this.settings.audio_only||(n.onmouseover=function(e){this.volume_slider&&(this.volume_slider.style.display="block")}.bind(this),n.onmouseout=function(e){this.volume_slider&&(this.volume_slider.style.display="none")}.bind(this)),e.appendChild(n);var o=document.createElement("div");o.className="sldp_volume_btn",o.classList.add("sldp_btn"),o.classList.add("sldp-icon-volume-medium"),o.onclick=this._volumeBtnClick,n.appendChild(o),this.playerWrapper.appendChild(e),this.volume_button=o,this.volume_wrapper=n,this.playPauseButton=r,this.controlBar=e,this.settings.mobile||this._create_volume_slider(),this._setStoredVolume()}},{key:"_create_volume_slider",value:function(){var e=document.createElement("div");e.className="sldp_volume_slider_wrp";var t=document.createElement("div");t.className="sldp_volume_slider",this.thumb=document.createElement("div"),this.thumb.className="sldp_volume_thumb",t.appendChild(this.thumb),e.appendChild(t),e.onmousedown=function(e){this.mediaElement.prev_volume=this.volumeController.volume;var i=o.default.getElementCoordinates(t),r=o.default.getElementCoordinates(this.thumb),n=e.pageX-(r.right-r.left)/2-i.left;n<0?n=0:n>100&&(n=100),this._adjustVolume(n),e.stopPropagation()}.bind(this),this.thumb.onmousedown=function(e){this.mediaElement.prev_volume=this.volumeController.volume;var i=o.default.getElementCoordinates(this.thumb),r=e.pageX-i.left,n=o.default.getElementCoordinates(t);return document.onmousemove=function(e){var i=e.pageX-r-n.left;i<0?i=0:i>100&&(i=100);var o=t.offsetWidth-this.thumb.offsetWidth;0==o&&(o=100),i>o&&(i=o),this._adjustVolume(i)}.bind(this),document.onmouseup=function(e){document.onmousemove=document.onmouseup=null},e.stopPropagation(),!1}.bind(this),this.thumb.ondragstart=function(){return!1},this.volume_wrapper.appendChild(e),this.volume_slider=t,this.settings.audio_only||(this.volume_slider.style.display="none")}},{key:"_setStoredVolume",value:function(){var e=100;if("localStorage"in window){try{e=parseInt(window.localStorage.getItem("sldp_player_volume_"+this.storageId))}catch(e){this.logger.warn("Error getting last volume from local storage",e)}isNaN(e)&&(e=100)}this._adjustVolume(e,!0)}},{key:"_adjustVolume",value:function(e,t){this.thumb&&(t&&this.volumeController.muted?this.thumb.style.left="0px":this.thumb.style.left=e+"px");var i=e/100;if(this.volumeController.volume!==i&&(this.volumeController.volume=i,!t&&this._onVolumeSet&&this._onVolumeSet(e)),0==e||t&&this.volumeController.muted?(this.volumeController.muted=!0,this.volume_button&&(this.volume_button.classList.remove("sldp-icon-volume-medium"),this.volume_button.classList.add("sldp-icon-volume-mute"))):(this.volumeController.muted=!1,this.volume_button&&(this.volume_button.classList.remove("sldp-icon-volume-mute"),this.volume_button.classList.add("sldp-icon-volume-medium"))),this.settings.controls&&"localStorage"in window)try{window.localStorage.setItem("sldp_player_volume_"+this.storageId,e)}catch(e){this.logger.warn("Error setting current volume to localStorage",e)}}},{key:"_setSplashScreen",value:function(){this.container&&this.settings.splash_screen&&(this.mediaElement.style["background-image"]="url('".concat(this.settings.splash_screen,"')"),this.mediaElement.style["background-size"]="cover")}},{key:"_removeSplashScreen",value:function(){this.container&&this.settings.splash_screen&&(this.mediaElement.style["background-image"]="",this.mediaElement.style["background-size"]="",this.mediaElement.style.background="#000")}},{key:"_removePlayerControls",value:function(){var e=this.playerWrapper.getElementsByClassName("sldp_cbar")[0];e&&this.playerWrapper.removeChild(e);var t=this.playerWrapper.getElementsByClassName("sldp_indicator")[0];t&&this.playerWrapper.removeChild(t)}},{key:"_handlePlay",value:function(e){var t=!1;return this.can_play&&(this.settings.audio_only&&this.settings.audio_title?this._addMessage(this.settings.audio_title):this._removeMessage(),this._togglePlayButton(!1),this._onPlayCallback&&(this._onPlayCallback(e),this.showControlsForPeriod(.5),t=!0)),t}},{key:"_handlePause",value:function(e){this._togglePlayButton(!0),!e&&this._onPauseCallback&&this._onPauseCallback(),this.showControlsForPeriod("infinite")}},{key:"_togglePlayClass",value:function(e,t,i,r){if(e){var n=t?r:i,o=t?i:r;e.classList.remove(n),e.classList.add(o)}}},{key:"_togglePlayButton",value:function(e){this._togglePlayClass(this.playPauseButton,e,"sldp-icon-play","sldp-icon-pause"),this._togglePlayClass(this.mobileCtrlBtn,e,"sldp-icon-play-o","sldp-icon-pause-o")}},{key:"_updateCfgDialog",value:function(){for(var e=this,t=function(){var t=e.quality_ar[i].name,r=e.quality_ar[i].idx,n=document.createElement("li");t==e.cur_quality.name&&r==e.cur_quality.idx&&(t="&#10003 "+t),n.innerHTML=t,n.onclick=function(e){this._onQualityChangeCallback&&(this._onQualityChangeCallback(t,r),this.cfgDialog.remove(),delete this.cfgDialog,this.hideControlsAfterPeriod(.5)),e.stopPropagation()}.bind(e),e.cfgDialog.appendChild(n)},i=0;i<this.quality_ar.length;i++)t()}},{key:"_isFullscreenMode",value:function(){var e=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;return this._isPlayerElement(e)}},{key:"_updateFullscreenWrapperSize",value:function(){this.mediaElement.style.width="100vw",this.mediaElement.style.height="100vh",this.playerWrapper.style.width="100vw",this.playerWrapper.style.height="100vh"}},{key:"_isPlayerElement",value:function(e){if(e){var t=e.parentElement;return t&&this.container&&t.id===this.container.id}return!1}},{key:"_updatePlayerFullscreen",value:function(){this._updateFullscreenWrapperSize(),this._resizeHandler()}},{key:"_createHandlers",value:function(){this.clicks=0,this.singleClickHandler=this.settings.controls?this._mediaElementClick:void 0,this.doubleClickHandler=void 0,this.settings.audio_only||(this.settings.mobile||(this.doubleClickHandler=this._expandBtnClick),this._createFullscreenHandler(),this._createResizeHandler(),this._createPipHandlers(),this._createOrientationChangeHandler()),this._createClicksHandler(),this._createPlayPauseHandlers(),this._createWebkitendfullscreenHandler()}},{key:"_removeHandlers",value:function(){this.settings.audio_only||(this._removeFullscreenHandler(),this._removeResizeHandler(),this._removePipHandlers(),this._removeOrientationChangeHandler()),this.singleClickHandler=void 0,this.doubleClickHandler=void 0,this._removeClicksHandler(),this._removeWebkitendfullscreenHandler()}},{key:"_createClicksHandler",value:function(){this.playerWrapper.addEventListener("click",this._handleClicks,!1)}},{key:"_removeClicksHandler",value:function(){this.playerWrapper.removeEventListener("click",this._handleClicks)}},{key:"_createPlayPauseHandlers",value:function(){this.mediaElement.addEventListener("play",this._handlePlayEvent,!1),this.mediaElement.addEventListener("pause",this._handlePauseEvent,!1)}},{key:"_removePlayPauseHandlers",value:function(){this.mediaElement.removeEventListener("play",this._handlePlayEvent),this.mediaElement.removeEventListener("pause",this._handlePauseEvent)}},{key:"_createResizeHandler",value:function(){window.addEventListener("resize",this._resizeHandler,!1)}},{key:"_removeResizeHandler",value:function(){window.removeEventListener("resize",this._resizeHandler)}},{key:"_createPipHandlers",value:function(){window.addEventListener("enterpictureinpicture",this._handleEnterPip,!1),window.addEventListener("leavepictureinpicture",this._handleLeavePip,!1)}},{key:"_removePipHandlers",value:function(){window.removeEventListener("enterpictureinpicture",this._handleEnterPip),window.removeEventListener("leavepictureinpicture",this._handleLeavePip),this.pipMode&&(document.exitPictureInPicture(),this.pipMode=!1)}},{key:"_createOrientationChangeHandler",value:function(){window.addEventListener("orientationchange",this._orientationchangeHandler,!1)}},{key:"_removeOrientationChangeHandler",value:function(){window.removeEventListener("orientationchange",this._orientationchangeHandler)}},{key:"_createFullscreenHandler",value:function(){document.addEventListener("webkitfullscreenchange",this._fullscreenchangeHandler,!1),document.addEventListener("mozfullscreenchange",this._fullscreenchangeHandler,!1),document.addEventListener("fullscreenchange",this._fullscreenchangeHandler,!1),document.addEventListener("MSFullscreenChange",this._fullscreenchangeHandler,!1),document.addEventListener("webkitfullscreenerror",this._fullscreenErrorHandler,!1),document.addEventListener("fullscreenerror",this._fullscreenErrorHandler,!1)}},{key:"_removeFullscreenHandler",value:function(){document.removeEventListener("webkitfullscreenchange",this._fullscreenchangeHandler),document.removeEventListener("mozfullscreenchange",this._fullscreenchangeHandler),document.removeEventListener("fullscreenchange",this._fullscreenchangeHandler),document.removeEventListener("MSFullscreenChange",this._fullscreenchangeHandler),document.removeEventListener("webkitfullscreenerror",this._fullscreenErrorHandler),document.removeEventListener("fullscreenerror",this._fullscreenErrorHandler)}},{key:"_createWebkitendfullscreenHandler",value:function(){this.mediaElement.addEventListener("webkitendfullscreen",this._webkitendfullscreenHandler,!1)}},{key:"_removeWebkitendfullscreenHandler",value:function(){this.mediaElement.removeEventListener("webkitendfullscreen",this._webkitendfullscreenHandler)}},{key:"_finishLoadingIndicator",value:function(){this.indicator&&this.indicator.quickRelease()}},{key:"_updateLoadingIndicator",value:function(){this.indicator&&this.indicator.updatePosition()}},{key:"_createLoadingIndicator",value:function(){var e=document.createElement("div");e.className="sldp_indicator",this.playerWrapper.appendChild(e),this.indicator={ui:this,fps:60,element:e,counter:0,percentage:100,fullWidth:1,releaseDuration:.5,start:function(){this.interval&&clearInterval(this.interval),this.counter=0,this.percentage=0,this.element.style.opacity=1,this.fullWidth=this.ui.playerWrapper.offsetWidth,this.interval=setInterval(this.onInterval.bind(this),1e3/this.fps)},release:function(){this.interval&&clearInterval(this.interval),this.counter=0,this.percentagePerFrame=(100-this.percentage)/(this.releaseDuration*this.fps),this.opacityPerFrame=1/(this.releaseDuration*this.fps),this.interval=setInterval(this.onReleaseInterval.bind(this),1e3/this.fps)},quickRelease:function(){if(this.percentage<100){var e=.1;45<this.percentage&&(e=(100-this.percentage)/(this.percentagePerFrame*this.fps)),e>=.1&&(e=this.releaseDuration,this.releaseDuration=.1,this.release(),this.releaseDuration=e)}},onInterval:function(){this.counter+=1,this.percentage=8*Math.log(this.counter),this.adjustElementWidth(),45<this.percentage&&this.release()},onReleaseInterval:function(){this.percentage+=this.percentagePerFrame,100<=this.percentage&&(this.percentage=100,clearInterval(this.interval)),this.adjustElementWidth();var e=parseFloat(this.element.style.opacity)||1;this.element.style.opacity=""+(e-this.opacityPerFrame)},adjustElementWidth:function(){this.element.style.width=parseInt(.01*this.fullWidth*this.percentage)+"px"},updatePosition:function(){this.percentage<100&&(this.fullWidth=this.ui.playerWrapper.offsetWidth,this.adjustElementWidth())}},this.settings.autoplay&&this.indicator.start()}},{key:"qualities",set:function(e){this.quality_ar=e,this.cur_quality=e[0]}},{key:"currentQuality",set:function(e){this.cur_quality=e}},{key:"onPlay",set:function(e){this._onPlayCallback=e}},{key:"onPlayEvent",set:function(e){this._onPlayEventCallback=e}},{key:"onPause",set:function(e){this._onPauseCallback=e}},{key:"onPauseEvent",set:function(e){this._onPauseEventCallback=e}},{key:"canPlay",set:function(e){this.can_play=!!e}},{key:"onQualityChange",set:function(e){this._onQualityChangeCallback=e}},{key:"onUserAction",set:function(e){this._isUserActionAcceptable=e}},{key:"onVolumeSet",set:function(e){this._onVolumeSet=e}},{key:"onResize",set:function(e){this._onResize=e}},{key:"onEnterPip",set:function(e){this._onEnterPip=e}},{key:"onLeavePip",set:function(e){this._onLeavePip=e}}])&&c(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=h},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(12),i(13),i(9),i(10),i(4),i(14);var r,n=(r=i(337))&&r.__esModule?r:{default:r};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===o(n=function(e,t){if("object"!==o(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var s="\n@font-face {\n  font-family: 'glyphs';\n  src:url(data:font/opentype;base64,".concat(n.default,');\n  font-weight: normal;\n  font-style: normal;\n}\n[class^="sldp-icon-"], [class*=" sldp-icon-"] {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: \'glyphs\' !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n.sldp-icon-enlarge:before {\n  content: "\\e98b";\n}\n.sldp-icon-cog:before {\n  content: "\\e994";\n}\n.sldp-icon-play-o:before {\n  content: "\\ea15";\n}\n.sldp-icon-pause-o:before {\n  content: "\\ea16";\n}\n.sldp-icon-play:before {\n  content: "\\ea1c";\n}\n.sldp-icon-pause:before {\n  content: "\\ea1d";\n}\n.sldp-icon-volume-medium:before {\n  content: "\\ea27";\n}\n.sldp-icon-volume-mute:before {\n  content: "\\ea2a";\n}\n.sldp-icon-cc:before {\n  content: "\\e900";\n}\n.sldp_player_wrp {\n  background-color: #000;\n  position: relative;\n}\n.sldp_player_wrp_video {\n  display: inline-block;\n}\n.sldp_player_wrp_audio {\n  display: flex;\n  height: 42px;\n}\n.sldp_cbar {\n  display: block;\n  padding: 5px;\n  padding-left: 5px;\n  overflow: hidden;\n  z-index: 10;\n}\n.sldp_cbar_video {\n  position: absolute;\n  bottom: 0px;\n  left: 0;\n  right: 0;\n  transition: opacity 0.5s linear;\n  background-color: rgba(0,0,0,0.7);\n}\n.sldp_cbar_audio {\n  position: relative;\n  margin: auto 6px auto 12px;\n  background-color: rgba(0,0,0,0.4);\n}\n.sldp_mobile_ctrl {\n  position: absolute;\n  transition: opacity 0.5s linear;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  z-index: 5;\n  color: #008ee8;\n}\n.sldp_mobile_ctrl_icon {\n  margin: auto;\n  font-size: 5rem;\n  opacity: 0.7;\n}\n.sldp_message_wrp {\n  height: 100%;\n  color: white;\n  display: flex;\n  z-index: 1;\n}\n.sldp_message_wrp_video {\n  position: absolute;\n  left: 0px;\n  top: 0px;\n  width: 100%;\n}\n.sldp_message_wrp_audio_noctrl {\n  padding-left: 20px;\n}\n.sldp_message {\n  display: inline-block;\n  margin: auto;\n  background: #000;\n  font-family: Helvetica, Arial, sans-serif;\n  line-height: 22px;\n}\n.sldp_message_pad {\n  padding: 12px 20px;\n  align-self: center;\n}\n.ios_button {\n  text-align: center;\n  margin: 10px 0px;\n}\n.sldp_btn {\n  width: 20px;\n  height: 20px;\n  cursor: pointer;\n  margin-right: 10px;\n  color: #008ee8;\n  font-size: 18px;\n\n  -o-transition:.5s;\n  -ms-transition:.5s;\n  -moz-transition:.5s;\n  -webkit-transition:.5s;\n  transition:.5s;\n}\n.sldp_btn:hover {\n  color: #ff8814;\n}\n.sldp_play_pause_btn {\n  float: left;\n}\n.sldp_expand_btn {\n  float: right;\n  font-size: 16px;\n}\n.sldp_volume_btn {\n  float: left;\n}\n.sldp_config_btn {\n  float: right;\n}\n.sldp_captions_btn {\n  float: right;\n  font-size: 1.3rem;\n}\n.sldp_config_btn:hover {\n  transform: rotate(-30deg);\n}\n.sldp_cfg_dialog, .sldp_capt_dialog {\n  background: black;\n  position: absolute;\n  bottom: 30px;\n  padding: 0;\n  margin: 0;\n  font-family: Arial;\n  font-size: 14px;\n  color: white;\n  z-index: 10;\n}\n.sldp_cfg_dialog {\n  right: 25px;\n  width: 100px;\n}\n.sldp_capt_dialog {\n  right: 50px;\n}\n.sldp_cfg_dialog li, .sldp_capt_dialog li {\n  list-style: none;\n  text-align: center;\n  line-height: 24px;\n  cursor: pointer;\n}\n.sldp_capt_dialog li {\n  padding: 0 15px;\n}\n.sldp_cfg_dialog li:hover, .sldp_capt_dialog li:hover {\n  background-color: grey;\n}\n.sldp_volume_wrp {\n  overflow: hidden;\n}\n.sldp_volume_desktop {\n  width: 150px;\n}\n.sldp_volume_mobile {\n  width: 20px;\n}\n.sldp_volume_slider_wrp {\n  float: left;\n  height: 20px;\n  cursor: pointer;\n}\n.sldp_volume_slider {\n  border-radius: 1px;\n  background: #008ee8;\n  width: 112px;\n  height: 3px;\n  margin-top: 9px;\n}\n.sldp_volume_thumb {\n  background: #008ee8;\n  width: 12px;\n  height: 12px;\n  border-radius: 6px;\n  position: relative;\n  left: 100px;\n  top: -4px;\n  cursor: pointer;\n}\n.sldp_volume_thumb:hover {\n  background: #ff8814;\n}\n.sldp_indicator {\n  height: 4px;\n  background-color: #008ee8;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n@keyframes flasher {  \n  0% { opacity: 1.0; }\n  50% { opacity: 0.0; }\n  100% { opacity: 1.0; }\n}\n'),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),document.getElementById("sldp_player_stylesheet")||(this.style=document.createElement("style"),this.style.setAttribute("id","sldp_player_stylesheet"),this.style.styleSheet?this.style.styleSheet.cssText=s:this.style.appendChild(document.createTextNode(s)),document.getElementsByTagName("head")[0].appendChild(this.style))}var t,i;return t=e,(i=[{key:"destroy",value:function(){this.style&&this.style.parentNode.removeChild(this.style)}}])&&a(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=u},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="d09GRgABAAAAAAngAAsAAAAACZQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABCAAAAGAAAABgDxIHIWNtYXAAAAFoAAAAhAAAAITVOJDJZ2FzcAAAAewAAAAIAAAACAAAABBnbHlmAAAB9AAABXgAAAV4ltUZZGhlYWQAAAdsAAAANgAAADYhySHZaGhlYQAAB6QAAAAkAAAAJAfCA85obXR4AAAHyAAAADQAAAA0KgABqGxvY2EAAAf8AAAAHAAAABwGWgfsbWF4cAAACBgAAAAgAAAAIAATAGFuYW1lAAAIOAAAAYYAAAGGmUoJ+3Bvc3QAAAnAAAAAIAAAACAAAwAAAAMDzQGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAA6ioDwP/AAEADwABAAAAAAQAAAAAAAAAAAAAAIAAAAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEAGgAAAAWABAAAwAGAAEAIOkA6YvplOoW6h3qJ+oq//3//wAAAAAAIOkA6YvplOoV6hzqJ+oq//3//wAB/+MXBBZ6FnIV8hXtFeQV4gADAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAf//AA8AAQAAAAAAAAAAAAIAADc5AQAAAAABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAABQBWAFUDqgMBAAMABwALAA8AIwAAATUhFQU1IxUjNSEVERUzNQEyFxYVERQHBiMhIicmNRE0NzYzA1b+VAGsrFT+VKwCACIZGRkZIv1UIhkZGRkiAVVWVqpWVlZWAQBWVgFWGhoi/gAiGhoaGiICACIaGgACAAD/wAQAA8AABgANAAABEScHJzcnAwcXIREXNwQAoMBgwKCgwKD+YKDAA8D+YKDAYMCg/WDAoAGgoMAAAAAAAgAS/8AD7gPAAEIAXgAAASYnJjY3NjcnDgEjIicuAScmNSMUBgcGBw4BJyYnBx4BFxYXFgYHBgcXPgEzMhceARcWFTM0Njc2Nz4BFxYXNy4BJwUiJy4BJyY1NDc+ATc2MzIXHgEXFhUUBw4BBwYDphQFBBMYFyNlFTIbKCMkNQ8PyQ0NFR8fSCcmI2UWJQ0UBAUUFxcjZRUyGigkIzUPEMkNDRQfH0kmJiRkFSUN/lorJiU5EBAQEDklJisrJiU5EBAQEDklJgFeIyYmSR8fFK8NDg8QNSQjKRkyFyMXFxMEBRSuDSQXIyYmSCAfFK4MDg8QNSMkKBkxFyMXFxMEBRSvDCQXbRAQOSUmKysmJTkQEBAQOSUmKysmJTkQEAAAAwAA/8AEAAPAABsANwA6AAABIgcOAQcGFRQXHgEXFjMyNz4BNzY1NCcuAScmAyInLgEnJjU0Nz4BNzYzMhceARcWFRQHDgEHBgMNAQIAal1eiygoKCiLXl1qal1eiygoKCiLXl1qVkxMcSAhISBxTExWVkxMcSAhISBxTEzWAYD+gAPAKCiLXl1qal1eiygoKCiLXl1qal1eiygo/GAhIHFMTFZWTExxICEhIHFMTFZWTExxICECgODgAAAEAAD/wAQAA8AAGwA3ADsAPwAAASIHDgEHBhUUFx4BFxYzMjc+ATc2NTQnLgEnJgMiJy4BJyY1NDc+ATc2MzIXHgEXFhUUBw4BBwYBMxEjATMRIwIAal1eiygoKCiLXl1qal1eiygoKCiLXl1qVkxMcSAhISBxTExWVkxMcSAhISBxTEz+6oCAAQCAgAPAKCiLXl1qal1eiygoKCiLXl1qal1eiygo/GAhIHFMTFZWTExxICEhIHFMTFZWTExxICECYP6AAYD+gAAAAAABAMAAQANAA0AAAgAAEwkBwAKA/YADQP6A/oAAAgCAAEADgANAAAMABwAAEyERIQEhESGAAUD+wAHAAUD+wANA/QADAP0AAAADAAAAAANwA34AJQBCAF0AACUiJicmNDc2NzY0JyYnJjQ3NjIXFhceARcWFRQHDgEHBgcOASMxJyImJyY0NzY3NjQnJicmNDc2MhcWFxYUBwYHDgEHIiYvASMiJjURNDY7ATc+ARceARURFAYHDgEC0AoRBw4OMRgZGRgxDg4OJw4fGBcgCQgICSAXGB8HEQmrCRIHDg4eEA8PEB4ODg4oDiwXFhYXLAcSjgYMBfZzDRMTDXP2BxMJCQsLCQMGgAcIDicOMj0+gj0+Mg4nDg8PHiMkTSoqKysqKk0kIx4IB1sHBw4oDh4nJlAmJx4OKA4ODiw5OHQ4OSwHB9sFBPcTDQFADRP3BgQDBBAK/MAKEAQBAQACAAAAAAPAA34ADwAqAAABFSMnByM1Nyc1Mxc3MxUHASImLwEjIiY1ETQ2OwE3PgEXHgEVERQGBw4BA8BVa2tVa2tVa2tVa/5LBgwF9nMNExMNc/YHEwkJCwsJAwYBVVVra1Vra1Vra1Vr/kAFBPcTDQFADRP3BgQDBBAK/MAKEAQBAQABAAAAAQAAYWwe/V8PPPUACwQAAAAAAN9U7q4AAAAA31TurgAA/8AEAAPAAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAQAAAEAAAAAAAAAAAAAAAAAAAANBAAAAAAAAAAAAAAAAgAAAAQAAFYEAAAABAAAEgQAAAAEAAAABAAAwAQAAIAEAAAABAAAAAAAAAAACgAUAB4AWAB4AQgBZgHMAdoB8AJ6ArwAAQAAAA0AXwAFAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApGljb21vb24AaQBjAG8AbQBvAG8AblZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMGljb21vb24AaQBjAG8AbQBvAG8Abmljb21vb24AaQBjAG8AbQBvAG8AblJlZ3VsYXIAUgBlAGcAdQBsAGEAcmljb21vb24AaQBjAG8AbQBvAG8AbkZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(12),i(13),i(9),i(10),i(4),i(14);var r,n=(r=i(170))&&r.__esModule?r:{default:r};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===o(n=function(e,t){if("object"!==o(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var s=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i&&i.initialized&&"input"===i.type&&(this.vuInput=!0,this.curVolume=1,this.curMuted=!1),this.mediaService=n.default.getInstance(t)}var t,i;return t=e,(i=[{key:"destroy",value:function(){this.vuMeter=void 0}},{key:"setVUMeter",value:function(e){var t=this;this.vuInput?(this.vuMeter=e,this.vuMeter.isActivated()?this.onVUMeterActivated():this.vuMeter.onActivated=function(){return t.onVUMeterActivated()}):e.isActivated()||(this.suspendedMeter=e)}},{key:"activateVUMeter",value:function(){this.vuInput?this.vuMeter&&this.vuMeter.setVolume(this.curMuted?0:this.curVolume):this.suspendedMeter&&this.suspendedMeter.setup()&&(this.suspendedMeter=void 0)}},{key:"volume",get:function(){var e=0;return this.vuInput?this.curMuted||(e=this.curVolume):this.mediaService.isMuted()||(e=this.mediaService.getVolume()),e},set:function(e){this.vuInput?(this.curVolume=e,this.vuMeter?this.curMuted||this.vuMeter.setVolume(e):this.mediaService.setVolume(e)):(this.suspendedMeter&&this.suspendedMeter.setup()&&(this.suspendedMeter=void 0),this.mediaService.setVolume(e))}},{key:"muted",get:function(){return this.vuInput?this.curMuted:this.mediaService.isMuted()},set:function(e){this.vuInput?this.curMuted!==e&&(this.curMuted=e,this.vuMeter?this.vuMeter.setVolume(this.curMuted?0:this.curVolume):this.mediaService.setMuted(e)):(this.suspendedMeter&&!e&&this.suspendedMeter.setup()&&(this.suspendedMeter=void 0),this.mediaService.setMuted(e))}},{key:"onVUMeterActivated",value:function(){this.mediaService.setVolume(1),this.vuMeter.setVolume(this.curMuted?0:this.curVolume),this.mediaService.setMuted(!1)}}])&&a(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=s},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(41),i(12),i(13),i(9),i(10),i(4),i(14);var r=i(33),n=a(i(236)),o=a(i(239));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===s(n=function(e,t){if("object"!==s(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}a(i(242));var c=["CC1","CC2","CC3","CC4"],l={CC1:0,CC2:1,CC3:2,CC4:3,OFF:-1},f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._captions=[],this._captionProps=[],this._activeIdx=-1,this._captionPresenter=n.default.getInstance(t),this._captionPresenter.setCaptionReportInterface(this),this._captionManager=o.default.getInstance(t)}var t,i;return t=e,(i=[{key:"init",value:function(e,t){if("object"===s(t))for(var i in t){var r=l[i];r>=0&&(this._captionProps[r]=t[i],t[i].default&&(this._activeIdx=r))}this._captionManager.init(e),this._captionManager.setCaptionTrack(c[this._activeIdx]),this._captionPresenter.setRenderable(!!e),this._activeIdx>=0&&(this._captionPresenter.start(),this._captionPresenter.setActiveCaptionId(c[this._activeIdx]))}},{key:"setCaptionListInterface",value:function(e){this._captionList=e,this._captionList.setCaptions(this._captions),this._captionList.setUserActionReportInterface(this),this._activeIdx>=0&&this._captionList.setActiveIdx(this._activeIdx)}},{key:"deinit",value:function(){this._captionList&&(this._captionList.destroy(),this._captionList=void 0),this._captionPresenter.deinit()}},{key:"resume",value:function(){this._captionManager.clear(),this._captionPresenter.start()}},{key:"pause",value:function(){this._captionPresenter.stop()}},{key:"clear",value:function(){this._captionManager.clear()}},{key:"selectCaption",value:function(e){return!(!this._captions[e]&&-1!==e||this._activeIdx===e||(this._activeIdx=e,this._captionManager.setCaptionTrack(c[this._activeIdx]),this._captionPresenter.setActiveCaptionId(c[this._activeIdx]),this._captionList.setActiveIdx(e),0))}},{key:"captionArrived",value:function(e){var t=l[e];this._captions[t]||(this._captions[t]={},this._captionProps[t]&&this._captionProps[t].name&&(this._captions[t].name=this._captionProps[t].name),this._captionProps[t]&&this._captionProps[t].lang&&(this._captions[t].lang=this._captionProps[t].lang),this._captions[t].title=this._captionList.getCaptionTitle(t),this._captionList.refresh())}},{key:"setCaptionTrack",value:function(e){return this.selectCaption(l[e])}},{key:"getCurrentCaptionTrack",value:function(){var e={};return this._activeIdx>=0&&(e[c[this._activeIdx]]=this._captions[this._activeIdx]),e}},{key:"getCaptionTracks",value:function(){for(var e={},t=0;t<this._captions.length;t++)this._captions[t]&&(e[c[t]]=this._captions[t]);return e}}])&&u(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),h=(0,r.multiInstanceHolder)(f);t.default=h},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(78),i(26),i(40),i(12),i(13),i(9),i(10),i(4),i(14);var r=a(i(341)),n=i(240),o=a(i(18));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function c(e,t,i){return(t=l(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===s(t)?t:String(t)}t.default=function(e){var t=o.default.create(e,"ABR controller"),i=new r.default(e),a=function(){function e(r,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"_watchDog",function(){if(this.abrLadder.isRunning()){var e=this.abrLadder.calculateCurVideoStreamMetric("latestBufLevel");e<this.stepDownBufferLevel&&(t.debug("_watchDog interrupts abr ladder because current buffer level "+e+" < "+this.stepDownBufferLevel),this.abrLadder.finish(),this._increasePhases())}}.bind(this)),c(this,"_evalHandler",function(){if(!this.isSwitchInProgressCallback()&&!this.isSeekInProgressCallback()){var e=this.abrLadder.calculateCurStreamMetric("latestLowBufferCount"),i=this.abrLadder.calculateCurVideoStreamMetric("avg3secBufLevel");if(this.playbackStalled(i,e))t.debug("evalHandler: playback stalled! Switch to lowest rendition."),this.abrLadder.cancel(),this._switchRendition(0,n.TRANSITION_MODE.ABRUPT),this._increasePhases(),this.phaseCount=0;else{if(t.debug("phase ".concat(this.phaseCount," max ").concat(this.maxPhases)),this.phaseCount>=3){var r=this.abrLadder.calculateCurStreamMetric("latestBandwidth"),o=this.abrLadder.calculateCurStreamMetric("latestRate");if(r+=this.abrLadder.calculateProbeStreamMetric("latestBandwidth"),t.debug("eval: current buf: ".concat(i,", step down buf: ").concat(this.stepDownBufferLevel,", current bw: ").concat(r,", current rate: ").concat(o)),i<this.stepDownBufferLevel){if(this.abrLadder.cancel(),o>r){var a=this.abrLadder.findRelevantStream(r,o);a!==this.curStream.orderedIdx&&(t.debug("evalHandler: step down to ".concat(this.renditionProvider.getRenditionName(a))),this._switchRendition(a),this._increasePhases(),this.phaseCount=0)}}else{var s=!this._isCurRenditionTop()&&!this.abrLadder.isRunning();s&&this.phaseCount>=this.maxPhases&&r>0&&i>this.safeRunBufferLevel&&0==e?(this.abrLadder.run(),this.phaseCount=0):s&&t.debug("ABR ladder isn't run: phaseCount = ".concat(this.phaseCount,", curBandwidth = ").concat(r,", ")+"curLevel = ".concat(i,", safeLevel = ").concat(this.safeRunBufferLevel,", lowBufCount = ").concat(e))}}!this.abrLadder.isRunning()&&this.phaseCount<this.maxPhases&&this.phaseCount++}}}.bind(this)),c(this,"_trialComplete",function(){if(t.debug("trial complete for ".concat(this.curStream?this.curStream.rendition:"unknown")),this.curStream){var e=this.trials[this.curStream.orderedIdx];e.timer=null,e.required>1&&e.required--}}.bind(this)),c(this,"_onLadderResult",function(e){if(t.debug("ladder result: ".concat(this.renditionProvider.getRenditionName(e),", idx: ").concat(e,", cur stream: ").concat(this.curStream.rendition+"p",", idx: ").concat(this.curStream.orderedIdx)),this.curStream.orderedIdx!==e)this._switchRendition(e);else{for(var i in this.trials)this.trials[i].runs=0;this._increasePhases()}this.phaseCount=0}.bind(this)),this.trials={},this.maxPhases=3,this.trialsActive=!1,this.abrLadder=i.create(r,o,a),this.renditionProvider=r,this._setBufferingTime(a)}var r,o;return r=e,(o=[{key:"start",value:function(){this.curStream=this.getCurStreamCallback(),this.renditionProvider.getStreamsCount()>1&&(t.debug("start"),this._initTrials(),this.phaseCount=0,this.trials[this.curStream.orderedIdx].timer=setTimeout(this._trialComplete,6e4),this._clearEvalTimer(),this._clearWatchTimer(),this._clearRestartTimer(),this.evalTimer=setInterval(this._evalHandler,1e3),this.watchTimer=setInterval(this._watchDog,100),this.abrLadder.init(this.curStream),this.abrLadder.callbacks={onStartProbe:this.probeStartCallback,onCancelProbe:this.probeCancelCallback,onResult:this._onLadderResult})}},{key:"restart",value:function(e){if(e){this._clearEvalTimer(),this._clearWatchTimer();var t=this;this.restartTimer=setTimeout((function(){t.restartTimer=void 0,t.start()}),5e3)}else this.start()}},{key:"playbackStalled",value:function(e,i){return i>0&&t.debug("Low buffer count: ".concat(i,", current buffer level: ").concat(e)),i>=10||e<=.1}},{key:"scheduleInstantEvaluation",value:function(){this._clearEvalTimer(),this._clearWatchTimer(),this._evalHandler(),this.evalTimer=setInterval(this._evalHandler,1e3),this.watchTimer=setInterval(this._watchDog,100)}},{key:"setBuffering",value:function(e){this.abrLadder.setBuffering(e),this._setBufferingTime(e)}},{key:"_setBufferingTime",value:function(e){this.bufferingTime=e,this.stepDownBufferLevel=this.bufferingTime>700?.5*this.bufferingTime/1e3:.6*this.bufferingTime/1e3,this.safeRunBufferLevel=this.bufferingTime>700?.65*this.bufferingTime/1e3:.75*this.bufferingTime/1e3}},{key:"_increasePhases",value:function(){this.maxPhases<30&&(this.maxPhases++,t.debug("Increase maxPhases",this.maxPhases))}},{key:"_isCurRenditionTop",value:function(){return this.renditionProvider.isTopAvailable(this.curStream.orderedIdx)}},{key:"_initTrials",value:function(){var e=!1,t=this.renditionProvider.getAllRenditions();if(this.trialsActive)for(var i=0;i<t.length;i++){if(this.trials[i]){var r=this.trials[i].idx;r===t[i].idx&&this.trials[i].stream===this.renditionProvider.getStream(r).stream&&(e=!0)}if(!e)break}if(e)this._resetTrials();else{this.trials={},this.trialsActive=!0;for(var n=0;n<t.length;n++)this.trials[n]={idx:t[n].idx,stream:this.renditionProvider.getStream(t[n].idx).stream,runs:0,required:1,timer:null}}}},{key:"_switchRendition",value:function(e,i){if(e!==this.curStream.orderedIdx){var r=e>this.curStream.orderedIdx;if(r)this.trials[e].runs++;else{var n=this.trials[this.curStream.orderedIdx];n.timer&&(n.required+=2,n.required>15&&(n.required=15),this._clearTrialTimer(this.curStream.orderedIdx),t.debug("Increase trial for ".concat(this.curStream.rendition+"p",", idx ").concat(n.idx," to ").concat(n.required)))}(!r||this.trials[e].runs>=this.trials[e].required)&&this.switchRenditionCallback(this.renditionProvider.getRendition(e).idx,i)}}},{key:"stop",value:function(e){t.debug("stop!"),this.curStream=void 0,this.phaseCount=0,this._resetTrials(),e&&e.hard&&(this.trials={}),this._clearEvalTimer(),this._clearWatchTimer(),this.abrLadder.clear()}},{key:"_clearEvalTimer",value:function(){void 0!==this.evalTimer&&(clearInterval(this.evalTimer),this.evalTimer=void 0)}},{key:"_clearWatchTimer",value:function(){void 0!==this.watchTimer&&(clearInterval(this.watchTimer),this.watchTimer=void 0)}},{key:"_clearRestartTimer",value:function(){void 0!==this.restartTimer&&(clearTimeout(this.restartTimer),this.restartTimer=void 0)}},{key:"_resetTrials",value:function(){for(var e in this.trials)this.trials[e].runs=0,this._clearTrialTimer(e)}},{key:"_clearTrialTimer",value:function(e){null!==this.trials[e].timer&&(clearTimeout(this.trials[e].timer),this.trials[e].timer=null)}},{key:"isProbing",value:function(e){var t=!1,i=this.abrLadder.getProber();return i&&i.id()===e&&(t=i.isEnabled()),t}},{key:"onProbeInitReceived",value:function(){this.abrLadder.getProber().receiveInit()}},{key:"onProbeDataReceived",value:function(e,t,i){this.abrLadder.getProber().receiveFrame(e,t,i)}},{key:"callbacks",set:function(e){this.switchRenditionCallback=e.switchRendition,this.isSwitchInProgressCallback=e.isInProgress,this.isSeekInProgressCallback=e.isSeeking,this.getCurStreamCallback=e.getCurStream,this.probeStartCallback=e.probeStream,this.probeCancelCallback=e.cancelStream}}])&&u(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();return{create:function(e,t,i){return new a(e,t,i)}}}},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(78),i(26),i(12),i(13),i(9),i(10),i(4),i(14);var r=o(i(18)),n=o(i(342));function o(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function u(e,t,i){return(t=c(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e){var t=function(e,t){if("object"!==a(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===a(t)?t:String(t)}var l=3e3;t.default=function(e){var t=r.default.create(e,"ABR"),i=new n.default(e),o=function(){function e(i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"onProbeFinished",function(){this.runsCount++,this.calculateCurStreamMetric("stopCustom");var e=this.calculateCurStreamMetric("customRangeBandwidth");t.debug("finished probe: cur bandwidth ".concat(e));var i=this.metricsManager.getMetrics(this.prober.id()),r=Math.max(i.avgBandwidth(),i.latestBandwidth()),n=i.avgRate();e+=r,t.debug("finished probe: previous bw ".concat(this.curBandwidth,", current bw ").concat(e)),t.debug("finished probe: prober bw ".concat(r,", prober rate ").concat(n));var o=this.prober.period;this.destroyProber(),this.running=!1;var a=this.calculateCurVideoStreamMetric("latestBufLevel"),s=1e3*a>=this.enoughBufferToContinue,u=this.calculateCurStreamMetric("avgRate"),c=this.curStream.bandwidth>0?u/this.curStream.bandwidth:1;if(t.debug("finished probe: ".concat(s?"enough buffer":"NOT ENOUGH BUFFER",", period: ").concat(o,", buf level: ").concat(1e3*a,", min required buf: ").concat(this.enoughBufferToContinue,", bwCorrector: ").concat(c)),s&&o>=l){this.curBandwidth=e;for(var f=this.renditionProvider.getActualRenditions(),h=this.curStreamIdx+1;h<f.length;h++){var d=f[h].bandwidth*c;if(t.debug("finished probe: examine higher rendition ".concat(h,", req bandwidth: ").concat(d,", cur bandwidth: ").concat(this.curBandwidth),f[h]),this.curBandwidth<1.2*d){t.debug("finished probe: not enough bandwdith, stop! ".concat(this.curBandwidth," < ").concat(1.2*d));break}this.curStreamIdx++}this.doRun()}else s?(e<this.curBandwidth&&(e/=c),this.curBandwidth=Math.max(e,this.curBandwidth),t.debug("finished probe: recalculate bw ".concat(this.curBandwidth,", run again")),this.doRun()):(t.debug("finished probe: return result ".concat(this.renditionProvider.getRenditionName(this.curStreamIdx)),this.curStreamIdx),this.onResultCallback(this.curStreamIdx))}.bind(this)),u(this,"onInitReceived",function(){this.calculateCurStreamMetric("startCustom")}.bind(this)),this.running=!1,this.nextProberId=0,this.runsCount=0,this.metricsManager=r,this.renditionProvider=i,this.setBuffering(n)}var r,n;return r=e,(n=[{key:"init",value:function(e){this.curStream=e}},{key:"clear",value:function(){t.debug("clear"),this.cancel(),this.curStream=void 0}},{key:"cancel",value:function(){this.running&&(t.debug("cancel"),this.running=!1,this.prober.stop()),this.destroyProber()}},{key:"destroyProber",value:function(){this.prober&&(this.prober.destroy(),this.prober=void 0)}},{key:"run",value:function(){this.curBandwidth=this.calculateCurStreamMetric("avgBandwidth"),this.curStreamIdx=this.curStream.orderedIdx,this.runsCount=0,this.doRun()}},{key:"finish",value:function(){t.debug("finish current stream ".concat(this.curStreamIdx)),this.cancel(),this.onResultCallback(this.curStreamIdx)}},{key:"setBuffering",value:function(e){this.bufferingTime=e,this.minBufferingTime=e>1e3?600:e/2,this.enoughBufferToContinue=e>1e3?1e3:.8*e}},{key:"doRun",value:function(){var e=this.curStream?this.curStream.rendition+"p":"";if(t.debug("doRun: cur rendition: ".concat(e,", idx: ").concat(this.curStreamIdx,", bandwdith: ").concat(this.curBandwidth)),this.curBandwidth>0){var r=this.renditionProvider.getActualRenditions();if(this.nextStreamIdx=this.curStreamIdx+1,this.nextStreamIdx<r.length){var n=this.calculateCurStreamMetric("avgRate");this.bwCorrector=this.curStream.bandwidth>0?n/this.curStream.bandwidth:1,t.debug("doRun bw corrector: ".concat(this.bwCorrector,", bandwidth ").concat(this.curBandwidth,", rate ").concat(n));var o=r[this.nextStreamIdx],a=n+o.bandwidth*this.bwCorrector,s=0,u=1e3*this.calculateCurVideoStreamMetric("avg3secBufLevel");t.debug("doRun probe fullRate ".concat(a,", curVBufTime ").concat(u)),this.curBandwidth<a&&(s=this.curBandwidth*(u-this.minBufferingTime)/(a-this.curBandwidth),(s=Math.floor(s+.5))<100&&(s=100)),(0==s||s>l)&&(s=l),0===this.runsCount&&s>600&&(s=600),t.debug("doRun probe during ".concat(s));var c=this.renditionProvider.getStream(o.idx);this.prober=i.create(this.nextProberId++,c.stream,c.stream_info.vtimescale,s,this.metricsManager),this.prober.callbacks={onStartProbe:this.startProbeCallback,onCancelProbe:this.cancelProbeCallback,onInitReceived:this.onInitReceived,onProbeFinished:this.onProbeFinished},this.running=!0,this.prober.start()}else this.onResultCallback(this.curStreamIdx)}}},{key:"calculateCurVideoStreamMetric",value:function(e){return this.metricsManager.getMetrics(this.curStream.vid)[e]()}},{key:"calculateCurStreamMetric",value:function(e){var t=this.metricsManager.getMetrics(this.curStream.vid)[e]();if(!(t<0)&&t>=0||(t=0),void 0!==this.curStream.aid){var i=this.metricsManager.getMetrics(this.curStream.aid)[e]();i>0&&(t+=i)}return t}},{key:"calculateProbeStreamMetric",value:function(e){var t=0;return void 0!==this.prober&&(t=this.metricsManager.getMetrics(this.prober.id())[e]()),t}},{key:"findRelevantStream",value:function(e,i){for(var r=0,n=this.curStream.bandwidth>0?i/this.curStream.bandwidth:1,o=this.curStream.orderedIdx-1;o>=0;o--)if(this.renditionProvider.isRenditionActual(o)&&e>=1.1*this.renditionProvider.getRendition(o).bandwidth*n){r=o;break}return t.debug("findRelevantStream: found index ".concat(this.curStream.orderedIdx)),r}},{key:"getProber",value:function(){return this.prober}},{key:"isRunning",value:function(){return this.running}},{key:"callbacks",set:function(e){this.startProbeCallback=e.onStartProbe,this.cancelProbeCallback=e.onCancelProbe,this.onResultCallback=e.onResult}}])&&s(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();return{create:function(e,t,i){return new o(e,t,i)}}}},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(134),i(40),i(12),i(13),i(9),i(10),i(4),i(14);var r,n=(r=i(18))&&r.__esModule?r:{default:r};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===o(n=function(e,t){if("object"!==o(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}t.default=function(e){var t=n.default.create(e,"Prober"),i=function(){function e(i,r,n,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enabled=!1,this.period=o,this.stream=r,this.timescale=n,this.streamId=parseInt("F0",16)+i%16,this.metricsManager=a,this.metricsManager.add(this.streamId,"probe",n),t.debug("constructor: "+r+", timescale: "+n+", period: "+o)}var i,r;return i=e,(r=[{key:"destroy",value:function(){this.metricsManager.remove(this.streamId),this._clearBufCheckInterval()}},{key:"id",value:function(){return this.streamId}},{key:"streamName",value:function(){return this.stream}},{key:"start",value:function(){this.enabled=!0,this.durations=[],this.firstTimestamp=void 0,this.lastTimestamp=void 0,this.expectedEndTimestamp=void 0,this.startProbeCallback(this,this.period+1)}},{key:"isEnabled",value:function(){return this.enabled}},{key:"stop",value:function(){this.isEnabled()&&(this.enabled=!1,this.cancelProbeCallback(this),this.metricsManager.stop(this.streamId),this._clearBufCheckInterval())}},{key:"receiveInit",value:function(){if(!this.bufCheckInterval&&(this.initTime=performance.now(),this.initReceivedCallback(),this.period>=1e3)){var e=this;this.bufCheckInterval=setInterval((function(){e.firstTimestamp?(e.lastTimestamp-e.firstTimestamp)/e.timescale-(performance.now()-e.initTime)/1e3<=0&&e.metricsManager.reportLowBuffer(e.streamId):e.metricsManager.reportLowBuffer(e.streamId)}),500)}}},{key:"receiveFrame",value:function(e,i,r){void 0===this.firstTimestamp?(t.debug("receiveFrame: firstTimestamp "+r),this.firstTimestamp=r,this.expectedEndTimestamp=this.period*this.timescale/1e3+r):this.durations.push(r-this.lastTimestamp),this.lastTimestamp=r;var n=this._findDuration();this.metricsManager.setRateAdditive(this.streamId,n),r+n>this.expectedEndTimestamp&&(t.debug("receiveFrame: lastTimestamp "+r),(r-this.firstTimestamp)/this.timescale-(performance.now()-this.initTime)/1e3<=0&&this.metricsManager.reportLowBuffer(this.streamId),this.stop(),this.probeFinishedCallback())}},{key:"_findDuration",value:function(){var e=0,t=0,i={};for(t=0;t<this.durations.length;t++){var r=this.durations[t];i[r]=i[r]>0?i[r]+1:1}var n=0;for(t in i)if(i[t]>n){var o=parseInt(t);o>0&&(e=o,n=i[t])}return e}},{key:"_clearBufCheckInterval",value:function(){this.bufCheckInterval&&(clearInterval(this.bufCheckInterval),this.bufCheckInterval=void 0)}},{key:"callbacks",set:function(e){this.startProbeCallback=e.onStartProbe,this.cancelProbeCallback=e.onCancelProbe,this.initReceivedCallback=e.onInitReceived,this.probeFinishedCallback=e.onProbeFinished}}])&&a(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),e}();return{create:function(e,t,r,n,o){return new i(e,t,r,n,o)}}}},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(12),i(13),i(9),i(10),i(4),i(14);var r=o(i(18)),n=o(i(344));function o(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===a(n=function(e,t){if("object"!==a(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}t.default=function(e){var t=r.default.create(e,"MetricsManager"),i=new n.default(e),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metricsList={}}var r,n;return r=e,(n=[{key:"add",value:function(e,r,n){void 0!==this.metricsList[e]&&t.error("metric for track ID "+e+" already exists");var o=i.create(e,r,n);return this.mediaElement&&o.setMediaElement(this.mediaElement),this.metricsList[e]=o,o}},{key:"remove",value:function(e){var i=this.metricsList[e];return i?i.destroy():t.error("remove: "+e+" not found"),this.metricsList[e]=void 0,i}},{key:"isReadyToStart",value:function(e){return this.metricsList[e]&&this.metricsList[e].isReady()}},{key:"run",value:function(e){this.metricsList[e]?this.metricsList[e].start():t.warn("run: "+e+" not found")}},{key:"stop",value:function(e){this.metricsList[e]?this.metricsList[e].stop():t.error("stop: no metric found for "+e+" track")}},{key:"reportBandwidth",value:function(e,t,i){this.metricsList[e]&&this.metricsList[e].reportBandwidth(t,i)}},{key:"reportLowBuffer",value:function(e){this.metricsList[e]?this.metricsList[e].reportLowBuffer():t.error("report low buffer: No metric found for "+e+" track")}},{key:"reportBufLevel",value:function(e,i,r){this.metricsList[e]?this.metricsList[e].reportBufLevel(i,r):t.error("report buffer level: No metric found for "+e+" track")}},{key:"setRateAdditive",value:function(e,i){this.metricsList[e]?this.metricsList[e].setRateAdditive(i):t.error("setRateAdditive: No metrics found for "+e+" track")}},{key:"getMetrics",value:function(e){if(this.metricsList[e])return this.metricsList[e];t.error("get metric: No metric found for "+e+" track")}},{key:"setMediaElement",value:function(e){for(var t in this.mediaElement=e,this.metricsList)this.metricsList[t]&&this.metricsList[t].setMediaElement(e)}}])&&s(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();return{create:function(){return new o}}}},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(78),i(40),i(12),i(13),i(9),i(10),i(4),i(14);var r=o(i(232)),n=o(i(18));function o(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!==a(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===a(t)?t:String(t)}t.default=function(e){var t=n.default.create(e,"Metrics"),i=new r.default(e),o=function(){function e(t,r,n){var o,a,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,a="_interval500msecHandler",s=function(){if(this.isStarted()){this.timerCounter++;var e,t=performance.now();this._updateRate500msec(t),this.buf500msCnt>0&&(e=this.buf500msSum/this.buf500msCnt,this.buf500msSum=this.buf500msCnt=0,this.buf500msec.push(e)),2===this.timerCounter&&(this._updateBwRate1sec(t),this.buf1secCnt>0&&(e=this.buf1secSum/this.buf1secCnt,this.buf1secSum=this.buf1secCnt=0,this.buf1sec.push(e)),this.lb1sec.push(this.lowBuf1sec),this.lowBuf1sec=0,this.timerCounter=0)}}.bind(this),(a=u(a))in o?Object.defineProperty(o,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[a]=s,this.id=t,this.type=r,this.timescale=n,this.pickCustom=!1,this.bytesCustom=0,this.framesCount=0,this.bytesTotal=0,this.bytes1sec=0,this.lastBytes=0,this.bytes500msec=0,this.rate500msec=0,this.lowBufTotal=0,this.lowBuf1sec=0,this.bufferLevel=0,this.bufferEnd=0,this.bw1sec=i.create(6),this.rate1sec=i.create(6),this.lb1sec=i.create(6),this.buf1sec=i.create(6),this.buf500msec=i.create(6),this.buf1secSum=0,this.buf1secCnt=0,this.buf500msSum=0,this.buf500msCnt=0,this.timerCounter=0,this.rateAdditive=0}var r,n;return r=e,(n=[{key:"clearCounters",value:function(){this.bytesCustom=0,this.customStart=void 0,this.customEnd=void 0,this.rateCustomTs1=void 0,this.rateCustomTs2=void 0,this.stopTime=void 0,this.bwTime1=void 0,this.bwTime2=void 0,this.effBwTime1=void 0,this.lastRepTime=void 0,this.latencySubt=void 0,this.framesCount=0,this.bytesTotal=0,this.bytes1sec=0,this.lastBytes=0,this.bytes500msec=0,this.rate500msec=0,this.rate500msecTs1=void 0,this.rate500msecTs2=void 0,this.rate1secTs1=void 0,this.rate1secTs2=void 0,this.rateTotalTs1=void 0,this.rateTotalTs2=void 0,this.lowBufTotal=0,this.lowBuf1sec=0,this.bufferLevel=0,this.bufferEnd=0,this.buf1secSum=0,this.buf1secCnt=0,this.buf500msSum=0,this.buf500msCnt=0,this.timerCounter=0,this.rateAdditive=0}},{key:"destroy",value:function(){this._clear500msecInterval(),this.mediaElement=void 0,this.bw1sec.clear(),this.rate1sec.clear(),this.lb1sec.clear(),this.buf1sec.clear(),this.buf500msec.clear()}},{key:"stop",value:function(){this.enabled=!1,this.stopTime=this.lastRepTime,this._clear500msecInterval()}},{key:"start",value:function(){this.enabled||(this.enabled=!0,this.clearCounters(),this.startTime=void 0,this.interval500msec=setInterval(this._interval500msecHandler,500))}},{key:"isStarted",value:function(){return this.enabled}},{key:"isReady",value:function(){return void 0===this.enabled}},{key:"startCustom",value:function(){this.pickCustom||(this.pickCustom=!0,this.customStart=void 0,this.customStop=void 0,this.bytesCustom=0,this.rateCustomTs1=void 0,this.rateCustomTs2=void 0)}},{key:"stopCustom",value:function(){this.pickCustom&&(this.pickCustom=!1,this.customStop=this.lastRepTime)}},{key:"customRangeBandwidth",value:function(){var e=0;if(this.customStart){this.customStart===this.customStop&&(this.customStop=performance.now());var t=this.customStop-this.customStart;t>0&&(e=1e3*this.bytesCustom/(128*t))}return e}},{key:"customRangeRate",value:function(){var e=0,t=this.rateCustomTs2-this.rateCustomTs1+this.rateAdditive;return t>0&&(e=this.timescale*this.bytesCustom/(128*t)),e}},{key:"reportBandwidth",value:function(e,t){if(this.isStarted()){var i=performance.now();if(void 0!==t){var r=i/1e3-t/this.timescale;(null==this.latencySubt||r<this.latencySubt)&&(this.latencySubt=r),this.framesCount++,void 0===this.rate500msecTs1&&(this.rate500msecTs1=t),this.rate500msecTs2=t,void 0===this.rate1secTs1&&(this.rate1secTs1=t),this.rate1secTs2=t,void 0===this.rateTotalTs1&&(this.rateTotalTs1=t),this.rateTotalTs2=t,void 0===this.startTime&&(this.startTime=i),void 0===this.bwTime1&&(this.bwTime1=i,this.effBwTime1=i),this.bwTime2=i}this.lastRepTime=i,this.lastBytes=e,this.bytes500msec+=e,this.bytes1sec+=e,this.bytesTotal+=e,this.pickCustom&&(void 0===this.customStart&&(this.customStart=i),this.bytesCustom+=e,void 0!==t&&(void 0===this.rateCustomTs1&&(this.rateCustomTs1=t),this.rateCustomTs2=t))}}},{key:"reportLowBuffer",value:function(){this.isStarted()&&(this.lowBufTotal++,this.lowBuf1sec++)}},{key:"reportBufLevel",value:function(e,t){this.isStarted()&&(e<0&&(e=0),this.bufferLevel=e,this.bufferEnd=t,this.buf500msSum+=e,this.buf500msCnt+=1,this.buf1secSum+=e,this.buf1secCnt+=1)}},{key:"setRateAdditive",value:function(e){this.rateAdditive=e}},{key:"setMediaElement",value:function(e){this.mediaElement=e}},{key:"avgBandwidth",value:function(e){var t,i=0;(e||(t=void 0!==this.stopTime?this.stopTime:this.lastRepTime)===this.startTime)&&(t=performance.now());var r=t-this.startTime;return r>0&&(i=1e3*this.bytesTotal/(128*r)),i}},{key:"avgRate",value:function(){var e=0,t=this.rateTotalTs2-this.rateTotalTs1+this.rateAdditive;return t>0&&(e=this.timescale*this.bytesTotal/(128*t)),e}},{key:"curRate1sec",value:function(){var e=0,t=this.rate1secTs2-this.rate1secTs1+this.rateAdditive;return t>0&&(e=this.timescale*this.bytes1sec/(128*t)),e}},{key:"curRate500msec",value:function(){var e=0,t=this.rate500msecTs2-this.rate500msecTs1+this.rateAdditive;return t>0&&(e=this.timescale*this.bytes500msec/(128*t)),e}},{key:"curBw1sec",value:function(){var e=0;if(this.bwTime1){var t=void 0!==this.stopTime?this.stopTime:this.bwTime2;t===this.bwTime1&&(t=performance.now());var i=t-this.effBwTime1;i>0&&(e=1e3*this.bytes1sec/(128*i))}return e}},{key:"latestBandwidth",value:function(){var e=this.curBw1sec();if(this.bw1sec.length()>0){var t=this.bw1sec.get(-1);e=0===e?t:(e+t)/2}return e}},{key:"latestRate",value:function(){var e=this.curRate1sec();if(this.rate1sec.length()>0){var t=this.rate1sec.get(-1);e=0==e?t:(e+t)/2}return e}},{key:"hasLatest500msecBytesArrived",value:function(){return this.bytes500msec>0||this.rate500msec>0}},{key:"latestLowBufferCount",value:function(){for(var e=this.lowBuf1sec,t=0;t<2;t++)this.lb1sec.length()>t&&(e+=this.lb1sec.get(-1*(t+1)));return e}},{key:"currentBufLevel",value:function(){if(this.mediaElement){var e=this.bufferEnd-this.mediaElement.currentTime;return e<0&&(e=0),e}return t.error("currentBufLevel: video element is not set"),this.bufferLevel||0}},{key:"latestBufLevel",value:function(){var e=this.bufferLevel||0;return this.buf1secCnt>0&&(e=this.buf1secSum/this.buf1secCnt),e}},{key:"avgBufLevel",value:function(){return this.buf1sec.mean()||this.bufferLevel}},{key:"avg3secBufLevel",value:function(){return this.buf500msec.mean()||this.bufferLevel}},{key:"_updateRate500msec",value:function(e){this.rate500msec=this.curRate500msec(),void 0!==this.bwTime2&&e-this.bwTime2<=500?(this.rate500msecTs1=this.rate500msecTs2,this.bytes500msec=this.lastBytes):(this.rate500msecTs1=void 0,this.bytes500msec=0),this.rate500msecTs2=this.rate500msecTs1}},{key:"_updateBwRate1sec",value:function(e){var t=this.curBw1sec();this.bw1sec.push(t),this.rate1sec.push(this.curRate1sec()),void 0!==this.bwTime2&&e-this.bwTime2<=1e3?(this.rate1secTs1=this.rate1secTs2,this.bwTime1=this.bwTime2,this.effBwTime1=this.bwTime2-7.8125*this.lastBytes/t,this.bytes1sec=this.lastBytes):(this.rate1secTs1=void 0,this.bwTime1=void 0,this.effBwTime1=void 0,this.bytes1sec=0),this.rate1secTs2=this.rate1secTs1,this.bwTime2=this.bwTime1}},{key:"_clear500msecInterval",value:function(){this.interval500msec&&(clearInterval(this.interval500msec),this.interval500msec=void 0),this.timerCounter=0}}])&&s(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();return{create:function(e,t,i){return new o(e,t,i)}}}},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(14),i(12),i(13),i(9),i(10),i(4);var r,n=(r=i(18))&&r.__esModule?r:{default:r};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===o(n=function(e,t){if("object"!==o(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instanceId=t,this.logger=n.default.create(t,"Rendition Provider")}var t,i;return t=e,(i=[{key:"init",value:function(e,t,i,r){this.streams=e,this.renditions=t,this.maxHeight=i.max_height||Number.MAX_VALUE,this.constrained=!!i.size_constrained,this._filterRenditions(r)}},{key:"getStream",value:function(e){return this.streams[e]}},{key:"getStreamsCount",value:function(){return this.streams.length}},{key:"getRendition",value:function(e){return e>=this.actualRenditions.length&&this.logger.error("Irrelevant rendition = {idx} is requested"),this.renditions[e]}},{key:"getRenditionName",value:function(e){return this.getRendition(e).rendition+"p"}},{key:"getAllRenditions",value:function(){return this.renditions}},{key:"getActualRenditions",value:function(){return this.actualRenditions}},{key:"isTopAvailable",value:function(e){return e>=this.actualRenditions.length-1}},{key:"isRenditionActual",value:function(e){return e<this.actualRenditions.length}},{key:"onSizeUpdate",value:function(e){this.constrained&&this._filterRenditions(e)}},{key:"_filterRenditions",value:function(e){this.actualRenditions=[];for(var t=0;t<this.renditions.length;t++){var i=this.streams[this.renditions[t].idx];if(i.stream_info&&i.stream_info.height<=this.maxHeight){if(this.constrained&&(i.stream_info.width>=1.05*e[0]||i.stream_info.height>=1.05*e[1]))break;this.actualRenditions.push(this.renditions[t])}}}}])&&a(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=s},function(e,t,i){"use strict";i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(12),i(13),i(9),i(10),i(4),i(14);var r=i(33),n=o(i(347));function o(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,"symbol"===a(n=function(e,t){if("object"!==a(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"))?n:String(n),r)}var n}o(i(18));var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i;return t=e,(i=[{key:"setMediaElement",value:function(e){this._mediaElement=e}},{key:"setRate",value:function(e){e>=0?(this._rate=e,e>0&&(this._ival=1e3/e,this._maxi=Math.max(1e3,2*this._ival),this._strt=void 0)):this._rate=-1}},{key:"onScreenshotReady",value:function(e){this._onScreenshotReadyCallback=e}},{key:"_onScreenshotReady",value:function(e,t){this._onScreenshotReadyCallback&&this._onScreenshotReadyCallback(e,Math.round(1e3*t))}},{key:"start",value:function(){this._enabled||(this._enabled=!0,this._init(),this._requestNextFrame())}},{key:"stop",value:function(){this._enabled&&(this._enabled=!1,this._strt=void 0,this._deinit())}},{key:"_deinit",value:function(){this._handleBitmap&&(this._handleBitmap=void 0,this._worker?(this._worker.onmessage=void 0,this._worker=void 0):(this._canvas=void 0,this._canvasCtx=void 0))}},{key:"_init",value:function(){if(!this._handleBitmap)if("OffscreenCanvas"in window){var e=this;this._worker=new n.default,this._worker.onmessage=function(t){e._onScreenshotReady(t.data.data,t.data.pts)},this._handleBitmap=this._handleBitmapWithWorker}else this._handleBitmap=this._handleBitmapWithCanvas,this._canvas=document.createElement("canvas"),this._canvasCtx=this._canvas.getContext("2d",{willReadFrequently:!0})}},{key:"_handleFrame",value:function(e){if(!(0===this._rate||e.presentedFrames<=1)){var t=this._rate<0;if(!t){var i=performance.now();if(void 0===this._strt)this._strt=i,t=!0;else{var r=i-this._strt;r>this._maxi?(this._strt=i-this._ival,t=!0):r>=this._ival&&(this._strt+=this._ival,t=!0)}}if(t){var n=this,o=e.mediaTime;createImageBitmap(this._mediaElement).then((function(e){n._handleBitmap&&n._handleBitmap(e,o)}))}}}},{key:"_handleBitmapWithWorker",value:function(e,t){this._worker.postMessage({bmp:e,pts:t},[e])}},{key:"_handleBitmapWithCanvas",value:function(e,t){this._canvas.width=e.width,this._canvas.height=e.height,this._canvasCtx.drawImage(e,0,0),this._onScreenshotReady(this._canvasCtx.getImageData(0,0,e.width,e.height),t),e.close()}},{key:"_requestNextFrame",value:function(){if(this._enabled&&this._mediaElement){var e=this;this._mediaElement.requestVideoFrameCallback((function(t,i){e._handleFrame(i),e._requestNextFrame()}))}}}])&&s(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),c=(0,r.multiInstanceHolder)(u);t.default=c},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,n.default)('!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){let n=null,r=null;addEventListener("message",e=>{const t=e.data.bmp;null===n?(n=new OffscreenCanvas(t.width,t.height),r=n.getContext("2d",{willReadFrequently:!0})):(n.width=t.width,n.height=t.height),r.drawImage(t,0,0),postMessage({data:r.getImageData(0,0,t.width,t.height),pts:e.data.pts}),t.close()})}]);',"Worker",void 0,void 0)};var r,n=(r=i(348))&&r.__esModule?r:{default:r}},function(e,t,i){"use strict";e.exports=function(e,t,i,r){var n=self||window;try{try{var o;try{o=new n.Blob([e])}catch(t){(o=new(n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder)).append(e),o=o.getBlob()}var a=n.URL||n.webkitURL,s=a.createObjectURL(o),u=new n[t](s,i);return a.revokeObjectURL(s),u}catch(r){return new n[t]("data:application/javascript,".concat(encodeURIComponent(e)),i)}}catch(e){if(!r)throw Error("Inline worker is not supported");return new n[t](r,i)}}},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(i(350)),n=o(i(354));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return{create:function(t){var i;switch(t.mode){case"peak":case"rms":case"avg":var o=!1;window.isSecureContext&&(o=void 0!==window.AudioWorkletNode&&"audioworklet"===t.api.toLowerCase()),i=o?new n.default(t,e):new r.default(t,e)}return i}}}},function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(4),i(243),i(110),i(0),i(12),i(13),i(9),i(10),i(14),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(112),i(78),i(111);var n,o=(n=i(244))&&n.__esModule?n:{default:n};function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,"symbol"===r(o=function(e,t){if("object"!==r(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t);if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key,"string"))?o:String(o),n)}var o}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=c(e);if(t){var o=c(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,i)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(n,o.default);var t,i,r=u(n);function n(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(i=r.call(this,e.db_range,e.rate,t)).mode=e.mode,i.type=e.type,i.calcChannelValueFor={peak:i._calcChannelValuePeak,avg:i._calcChannelValueAvg,rms:i._calcChannelValueRms}[i.mode],i.channelData=[],i.logger.debug("ScriptProcessor VU meter constructor: ",i.mode,i.type,i.dbRange,i.rate),i}return t=n,(i=[{key:"setVolume",value:function(e){if(this.gainer){var t=this.context.currentTime;this.gainer.gain.setValueAtTime(e,t)}else this.suspended&&(this.logger.debug("Setup suspended VU meter"),this._setupMeter(),this.onActivated&&this.isActivated()&&(this.onActivated(),this.onActivated=void 0))}},{key:"_createMeter",value:function(){var e=this;void 0===this.meter&&(this.logger.debug("Create ScriptProcessor meter, channels =",this.channels),this._initValues(),this.meter=this.context.createScriptProcessor(this.bufSize,this.channels,this.channels),"input"===this.type?(this.gainer=this.context.createGain(),this.gainer.gain.value=1,this.meter.connect(this.gainer),this.audGraphCtrl.addVumeterChain([this.meter,this.gainer],[this.gainer])):this.audGraphCtrl.addVumeterChain([this.meter,"dest"],[this.meter]),this.meter.onaudioprocess=function(t){return e._updateMeter(t)})}},{key:"_removeMeter",value:function(){if(this.meter){this.logger.debug("Remove meter");try{this.audGraphCtrl.removeVumeterChain(),"input"===this.type&&(this.meter.disconnect(this.gainer),this.gainer=void 0),this.meter.onaudioprocess=void 0,this.meter=void 0}catch(e){this.gainer=void 0,this.meter=void 0,this.logger.warn("Exception caught: ",e)}}}},{key:"_gcd",value:function(e,t){return t?this._gcd(t,e%t):e}},{key:"_setupRateControl",value:function(){if(!this.rateControl){var e={},t=this._gcd(this.samplingRate,this.bufSize);if(this.rate<t/this.bufSize){t=this.rate*this.bufSize;for(var i=0;t>>=1;)i++;t=Math.pow(2,i)}var r=this.bufSize/t;e.max=this.samplingRate/t,e.exp=r*this.rate+.5>>>0,e.exp>=e.max?e=!1:(e.add=e.max/e.exp,e.tgt=e.cur=0,e.cnt=-2),this.rateControl=e}}},{key:"_calcChannelValueAvg",value:function(e){for(var t=this.channelData[e].length,i=0;i<t;i++)this.channelValues[e]+=Math.abs(this.channelData[e][i]);this.channelValues[e]/=t}},{key:"_calcChannelValueRms",value:function(e){for(var t=this.channelData[e].length,i=0;i<t;i++)this.channelValues[e]+=this.channelData[e][i]*this.channelData[e][i];this.channelValues[e]=Math.sqrt(this.channelValues[e]/t)}},{key:"_calcChannelValuePeak",value:function(e){for(var t=this.channelData[e].length,i=0;i<t;i++){var r=Math.abs(this.channelData[e][i]);r>this.channelValues[e]&&(this.channelValues[e]=r)}}},{key:"_updateMeter",value:function(e){if(this.rateControl){var t=this.rateControl;if(t.cnt++,t.tgt!==t.cnt)return;t.cur+.1>=t.max?(t.cur=t.add,t.tgt=t.add>>>0,t.cnt=0):(t.cur+=t.add,t.tgt=t.cur>>>0)}var i=e.inputBuffer;this.channelData.length=0;for(var r=0;r<this.channels;r++)this.channelData[r]=i.getChannelData(r),this.channelValues[r]=0,this.calcChannelValueFor(r),this.channelDecibels[r]=this._dbFromVal(this.channelValues[r]);this.ui&&this.ui.update(this.channelDecibels),this.callback&&this.callback(this.channelValues,this.channelDecibels)}}])&&a(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),n}();t.default=l},function(e,t,i){i(1)({target:"Math",stat:!0},{log10:i(352)})},function(e,t){var i=Math.log,r=Math.LOG10E;e.exports=Math.log10||function(e){return i(e)*r}},function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,"symbol"===r(o=function(e,t){if("object"!==r(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t);if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key,"string"))?o:String(o),n)}var o}i(0),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(79),i(12),i(13),i(9),i(10),i(4),i(14);var o=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.vertical=!0,this.borderSize=2,this.fontSize=10,this.backgroundColor="black",this.tickColor="#ddd",this.gradient=["red 1%","#ff0 16%","lime 45%","#080 100%"],this.dbRange=i,this.dbTickSize=10,this.levelTransition="0.1s",this._createBasicView()}var t,i;return t=e,(i=[{key:"create",value:function(e){if(!this.fullValue){void 0===this.meter&&this._createBasicView(),this.channels=e,this._createGradient();var t=this.meterWidth/this.channels;this.vertical||(t=this.meterHeight/this.channels);var i=this.tickWidth;this.vertical||(i=this.meterTop);for(var r=0;r<this.channels;r++)this._createChannelLevel(2*this.borderSize,this.meterTop,i,!1),this.channelLevels[r]=this._createChannelLevel(t,this.meterTop,i,this.levelTransition),i+=t,this.levelValues[r]=this._calcLevel(-this.dbRange);this.fullValue=!0,this._drawMeter()}}},{key:"refresh",value:function(e){if(this.container.clientWidth!==this.elementWidth||this.container.clientHeight!==this.elementHeight){var t=this.fullValue;this.destroy(!0),t?this.create(e):this._createBasicView()}}},{key:"destroy",value:function(e){if(this.meter){if(this.fullValue){for(var t=0;t<this.fullValueItems.length;t++)this.meter.removeChild(this.fullValueItems[t]);this.fullValueItems=[],this.channelLevels=[],this.fullValue=!1}e&&(this.container.removeChild(this.meter),this.meter=void 0)}}},{key:"update",value:function(e){if(this.meter)for(var t=0;t<this.channels;t++)this.levelValues[t]=this._calcLevel(e[t])}},{key:"_calcLevel",value:function(e){var t=this.vertical?this.meterHeight:this.meterWidth,i=Math.floor(e*t/-this.dbRange);return i<0?i=0:i>t&&(i=t),i}},{key:"_setParams",value:function(){this.tickWidth=2*this.fontSize,this.elementWidth=this.container.clientWidth,this.elementHeight=this.container.clientHeight,this.elementWidth>this.elementHeight&&(this.vertical=!1),this.meterTop=this.vertical?this.borderSize:1.5*this.fontSize+this.borderSize,this.meterHeight=this.elementHeight-this.meterTop-this.borderSize,this.meterWidth=this.elementWidth-this.tickWidth-this.borderSize,this.fullValueItems=[],this.channelLevels=[],this.levelValues=[]}},{key:"_createBasicView",value:function(){this._setParams(),this._createMeterDiv(),this._createTicks(),this.fullValue=!1}},{key:"_removePlaceholder",value:function(){this.placeholder&&(this.container.removeChild(this.meter),this.meter=void 0,this.placeholder=!1)}},{key:"_createMeterDiv",value:function(){this.meter=document.createElement("div"),this.meter.style.position="relative",this.meter.style.width=this.elementWidth+"px",this.meter.style.height=this.elementHeight+"px",this.meter.style.backgroundColor=this.backgroundColor,this.container.appendChild(this.meter)}},{key:"_createTicks",value:function(){var e=this.dbRange/this.dbTickSize>>>0,t=0;if(this.vertical)for(var i=this.fontSize+this.borderSize,r=0;r<e;r++){var n=document.createElement("div");this.meter.appendChild(n),n.style.width=this.tickWidth+"px",n.style.textAlign="right",n.style.color=this.tickColor,n.style.fontSize=this.fontSize+"px",n.style.position="absolute",n.style.top=i+"px",n.textContent=t+"",t-=this.dbTickSize,i+=this.meterHeight/e}else{this.tickWidth=this.meterWidth/e;for(var o=2*this.fontSize,a=0;a<e;a++){var s=document.createElement("div");this.meter.appendChild(s),s.style.width=this.tickWidth+"px",s.style.textAlign="right",s.style.color=this.tickColor,s.style.fontSize=this.fontSize+"px",s.style.position="absolute",s.style.top="5px",s.style.right=o+"px",s.textContent=t+"",t-=this.dbTickSize,o+=this.tickWidth}}}},{key:"_createGradient",value:function(){var e,t=document.createElement("div");this.meter.appendChild(t),t.style.width=this.meterWidth+"px",t.style.height=this.meterHeight+"px",t.style.position="absolute",t.style.top=this.meterTop+"px",this.vertical?(t.style.left=this.tickWidth+"px",e="linear-gradient(to bottom, "+this.gradient.join(", ")+")"):(t.style.left=this.borderSize+"px",e="linear-gradient(to left, "+this.gradient.join(", ")+")"),t.style.backgroundImage=e,this.fullValueItems.push(t)}},{key:"_createChannelLevel",value:function(e,t,i,r){var n=document.createElement("div");return this.meter.appendChild(n),n.style.position="absolute",this.vertical?(n.style.width=e+"px",n.style.height=this.meterHeight+"px",n.style.top=t+"px",n.style.left=i+"px"):(n.style.width=this.meterWidth+"px",n.style.height=e+"px",n.style.top=i+"px",n.style.right=2*this.fontSize+"px"),n.style.backgroundColor=this.backgroundColor,r&&(this.vertical?n.style.transition="height "+this.levelTransition:n.style.transition="width "+this.levelTransition),this.fullValueItems.push(n),n}},{key:"_drawMeter",value:function(){var e=this;if(this.fullValue){for(var t=0;t<this.channels;t++)this.vertical?this.channelLevels[t].style.height=this.levelValues[t]+"px":this.channelLevels[t].style.width=this.levelValues[t]+"px";window.requestAnimationFrame((function(){return e._drawMeter()}))}}}])&&n(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=o},function(e,t,i){"use strict";i(0),i(112),i(78),i(111),i(243),i(110),i(11),i(2),i(7),i(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i(12),i(13),i(9),i(10),i(4),i(14);var r=a(i(116)),n=a(i(244)),o=a(i(355));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}(this,i)}}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t,i){return(t=p(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===s(t)?t:String(t)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(s,n.default);var t,i,a=l(s);function s(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),d(f(i=a.call(this,e.db_range,e.rate,t)),"_onWorkletModuleAdded",(function(){i.logger.debug("AudioWorklet module loaded",i.procUrl),i.meter=new AudioWorkletNode(i.context,"vu-audio-processor",{processorOptions:{channels:i.channels,dbRange:i.dbRange,dbMult:i.dbMult,mode:i.mode}}),i.meter.port.postMessage({cmd:"init"}),"input"===i.type?(i.gainer=i.context.createGain(),i.gainer.gain.value=void 0!==i.curVolume?i.curVolume:1,i.meter.connect(i.gainer),i.audGraphCtrl.addVumeterChain([i.meter],[i.gainer])):i.audGraphCtrl.addVumeterChain([i.meter],[i.meter]),i._setupRateControl(),i.meter.port.onmessage=function(e){return i._updateMeter(e)}})),d(f(i),"_onWorkletModuleNotFound",(function(e){i.procUrl===o.default?i._onWorkletModuleError(e):i.context.audioWorklet.addModule(o.default).then(i._onWorkletModuleAdded).catch(i._onWorkletModuleError)})),d(f(i),"_onWorkletModuleError",(function(e){i.logger.error(i._spProvider.notAvailableError("AudioWorkletProcessor",o.default)),i.stop(!0),i.context=void 0,i.fatalErrorCallback&&i.fatalErrorCallback()})),i.mode=e.mode,i.type=e.type,i._spProvider=r.default.getInstance(t),i.logger.debug("AudioWorklet VU meter constructor: ",i.mode,i.type,i.dbRange,i.rate),i}return t=s,(i=[{key:"setVolume",value:function(e){this.curVolume=e,this.gainer?this.gainer.gain.setValueAtTime(e,this.context.currentTime):this.suspended&&(this.logger.debug("Setup suspended VU meter"),this._setupMeter(),this.onActivated&&this.isActivated()&&(this.onActivated(),this.onActivated=void 0))}},{key:"_createMeter",value:function(){void 0===this.meter&&(this.logger.debug("Create AudioWorklet meter"),this._initValues(),this.procUrl=this._spProvider.translateToScriptPath(o.default),this.context.audioWorklet.addModule(this.procUrl).then(this._onWorkletModuleAdded).catch(this._onWorkletModuleNotFound))}},{key:"_removeMeter",value:function(){if(this.meter){this.logger.debug("Remove meter");try{this.meter.port.postMessage({cmd:"stop"}),this.audGraphCtrl.removeVumeterChain(),"input"===this.type&&(this.meter.disconnect(this.gainer),this.gainer=void 0),this.meter=void 0,this.curVolume=void 0}catch(e){this.curVolume=void 0,this.gainer=void 0,this.meter=void 0,this.logger.warn("Exception caught: ",e)}}}},{key:"_setupRateControl",value:function(){this.meter&&this.meter.port.postMessage({cmd:"rate",rate:this.rate,sRate:this.samplingRate})}},{key:"_updateMeter",value:function(e){for(var t=0;t<this.channels;t++)this.channelValues[t]=e.data[0][t],this.channelDecibels[t]=e.data[1][t];this.ui&&this.ui.update(this.channelDecibels),this.callback&&this.callback(this.channelValues,this.channelDecibels)}}])&&u(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),s}();t.default=v},function(e,t,i){"use strict";e.exports=i.p+"vumeter-v2.25.0.worklet.min.js"},function(e,t,i){"use strict";i(228),i(94),!("requestVideoFrameCallback"in HTMLVideoElement.prototype)&&"getVideoPlaybackQuality"in HTMLVideoElement.prototype&&(HTMLVideoElement.prototype._rvfcpolyfillmap={},HTMLVideoElement.prototype.requestVideoFrameCallback=function(e){var t=this,i=this.getVideoPlaybackQuality(),r=this.mozPresentedFrames||this.mozPaintedFrames||i.totalVideoFrames-i.droppedVideoFrames,n=Date.now(),o=performance.now();return this._rvfcpolyfillmap[n]=requestAnimationFrame((function(i){return function i(o,a){var s=t.getVideoPlaybackQuality(),u=t.mozPresentedFrames||t.mozPaintedFrames||s.totalVideoFrames-s.droppedVideoFrames;if(u>r){var c=a-o;e(a,{mediaTime:Math.max(0,t.currentTime||0)+c/1e3,presentedFrames:u}),delete t._rvfcpolyfillmap[n]}else t._rvfcpolyfillmap[n]=requestAnimationFrame((function(e){return i(a,e)}))}(o,i)})),n},HTMLVideoElement.prototype.cancelVideoFrameCallback=function(e){cancelAnimationFrame(this._rvfcpolyfillmap[e]),delete this._rvfcpolyfillmap[e]})},function(e,t,i){"use strict";i(0),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(i(234)),n=o(i(241));function o(e){return e&&e.__esModule?e:{default:e}}var a={name:"SLDP Player",composer:new r.default("test").create({}),WSUtils:new n.default("test").create()};t.default=a}])}));